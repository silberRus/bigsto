
#Область ПрограммныйИнтерфейс

// Процедура возвращает надпись "Валюты" для формы документа.
//
// Параметры:
//	ПараметрыДокумента - Структура - Структура параметров вызывающей формы, конструктор ВзаиморасчетыКлиентСервер.ПараметрыНадписиВалюты
// 
Функция СформироватьНадписьВалюты(ПараметрыДокумента) Экспорт

	Если ПараметрыДокумента.СуммаДокумента = 0 Тогда
		ТекстСуммаДокумента = "";
	Иначе
		ТекстСуммаДокумента = " " + Формат(ПараметрыДокумента.СуммаДокумента, "ЧДЦ=2");
	КонецЕсли;
	
	Если ПараметрыДокумента.ВалютаДокумента = ПараметрыДокумента.ВалютаВзаиморасчетов ИЛИ ПараметрыДокумента.НеПоказыватьРасчеты Тогда
		
		НадписьВалюты = СтроковыеФункцииКлиентСервер.ПодставитьПараметрыВСтроку(
				НСтр("ru='Документ и расчеты:%1 %2'"),
				ТекстСуммаДокумента,
				ПараметрыДокумента.ВалютаДокумента);
		
	Иначе
		
		ТекстДокумент = СтроковыеФункцииКлиентСервер.ПодставитьПараметрыВСтроку(
				НСтр("ru='Документ%1 %2'"),
				ТекстСуммаДокумента,
				ПараметрыДокумента.ВалютаДокумента);
		
		Если ПараметрыДокумента.СуммаВзаиморасчетов = 0 Тогда
			ТекстСуммаВзаиморасчетов = "";
		Иначе
			ТекстСуммаВзаиморасчетов = " " + Формат(ПараметрыДокумента.СуммаВзаиморасчетов, "ЧДЦ=2");
		КонецЕсли;
		
		Если ЗначениеЗаполнено(ПараметрыДокумента.ВалютаВзаиморасчетов) Тогда
			ТекстВалютаВзаиморасчетов = ПараметрыДокумента.ВалютаВзаиморасчетов;
		Иначе
			ТекстВалютаВзаиморасчетов = НСтр("ru='<Не выбрана>'")
		КонецЕсли;
		
		ТекстРасчеты = СтроковыеФункцииКлиентСервер.ПодставитьПараметрыВСтроку(
				НСтр("ru=', Расчеты%1 %2'"),
				ТекстСуммаВзаиморасчетов,
				ТекстВалютаВзаиморасчетов);
		
		Если НЕ ЗначениеЗаполнено(ПараметрыДокумента.ВалютаВзаиморасчетов) Тогда
			
			ТекстРасшифровка = "";
			
		ИначеЕсли ПараметрыДокумента.ВалютаДокумента = ПараметрыДокумента.ВалютаРеглУчета
			ИЛИ ПараметрыДокумента.ВалютаВзаиморасчетов = ПараметрыДокумента.ВалютаРеглУчета Тогда
			
			ВалютаНадписи = ?(ПараметрыДокумента.ВалютаРеглУчета = ПараметрыДокумента.ВалютаДокумента,
							ПараметрыДокумента.ВалютаВзаиморасчетов,
							ПараметрыДокумента.ВалютаДокумента);
			
			Если ПараметрыДокумента.Кратность = 1 Тогда
				
					ТекстРасшифровка = СтроковыеФункцииКлиентСервер.ПодставитьПараметрыВСтроку(
						"(%1=%2 %3)",
						ВалютаНадписи,
						ПараметрыДокумента.Курс,
						ПараметрыДокумента.ВалютаРеглУчета);
				
				Иначе
					
					ТекстРасшифровка = СтроковыеФункцииКлиентСервер.ПодставитьПараметрыВСтроку(
						НСтр("ru='(%1 %2 за %3 %4)'"),
						ПараметрыДокумента.Курс,
						ПараметрыДокумента.ВалютаРеглУчета,
						ПараметрыДокумента.Кратность,
						ВалютаНадписи);
					
			КонецЕсли;
			
		Иначе
			
			Если ПараметрыДокумента.Кратность = 1 Тогда
				
				ТекстРасшифровка = СтроковыеФункцииКлиентСервер.ПодставитьПараметрыВСтроку(
					"(%1=%2 %3)",
					ПараметрыДокумента.ВалютаДокумента,
					ПараметрыДокумента.Курс,
					ПараметрыДокумента.ВалютаВзаиморасчетов);
			Иначе
				
				ТекстКурс = Строка(ПараметрыДокумента.Курс) + " " + ПараметрыДокумента.ВалютаВзаиморасчетов;
				
				ТекстКратность= Строка(ПараметрыДокумента.Кратность);
				
				ТекстРасшифровка = СтроковыеФункцииКлиентСервер.ПодставитьПараметрыВСтроку(
					"(%1=%2 %3)",
					ТекстКурс,
					ТекстКратность,
					ПараметрыДокумента.ВалютаДокумента);
					
			КонецЕсли;
			
		КонецЕсли;
		
		НадписьВалюты = ТекстДокумент + " " + ТекстРасчеты + " " + ТекстРасшифровка;
		
	КонецЕсли;
	
	Возврат НадписьВалюты;
	
КонецФункции

//Возвращает пустую структуру параметров формирования надписи Валюты и курсы документа
//
// Возвращаемое значение:
//  Структура - параметры для заполнения в форме.
//
Функция ПараметрыНадписиВалюты() Экспорт
	
	Возврат Новый Структура("НеПоказыватьРасчеты,
							|ВалютаДокумента,
							|ВалютаВзаиморасчетов,
							|ВалютаРеглУчета,
							|СуммаДокумента,
							|СуммаВзаиморасчетов,
							|Курс,
							|Кратность", ЛОЖЬ);
	
КонецФункции

#КонецОбласти