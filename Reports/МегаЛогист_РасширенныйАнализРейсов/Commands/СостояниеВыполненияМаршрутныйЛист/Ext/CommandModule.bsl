
&НаКлиенте
Процедура ОбработкаКоманды(ПараметрКоманды, ПараметрыВыполненияКоманды)
	
	Если ТипЗнч(ПараметрКоманды) = Тип("Массив") И ПараметрКоманды.Количество() > 1 Тогда
		КонтекстныйВариантОтчета = "СостояниеВыполненияМаршрутныхЛистов";
	Иначе
		КонтекстныйВариантОтчета = "СостояниеВыполненияМаршрутногоЛиста";
	КонецЕсли;
	
	Отбор = СформироватьОтбор(ПараметрКоманды);
	ПараметрыФормы = Новый Структура("КлючВарианта, Отбор, СформироватьПриОткрытии, ВидимостьКомандВариантовОтчетов", 
		КонтекстныйВариантОтчета,
		Отбор,
		Истина, 
		Ложь);
	
	ОткрытьФорму("Отчет.МегаЛогист_РасширенныйАнализРейсов.Форма",
			ПараметрыФормы, ,
			Истина,
			ПараметрыВыполненияКоманды.Окно);
			
КонецПроцедуры

&НаСервере
Функция СформироватьОтбор(Параметр)
		
	Отбор = Новый Структура("МаршрутныйЛист");
	Отбор.МаршрутныйЛист = Параметр;
	Отбор.Вставить("Период", Новый СтандартныйПериод(НачалоДня(Параметр[0].Дата), КонецДня(Параметр[0].Дата)));
	
	Возврат Отбор;
	
КонецФункции
