#Если Сервер Или ТолстыйКлиентОбычноеПриложение Или ВнешнееСоединение Тогда

#Область СлужебныйПрограммныйИнтерфейс

// Настройки общей формы отчета подсистемы "Варианты отчетов".
//
// Параметры:
//   Форма - УправляемаяФорма - Форма отчета.
//   КлючВарианта - Строка - Имя предопределенного варианта отчета или уникальный идентификатор пользовательского.
//   Настройки - Структура - см. возвращаемое значение ОтчетыКлиентСервер.ПолучитьНастройкиОтчетаПоУмолчанию().
//
Процедура ОпределитьНастройкиФормы(Форма, КлючВарианта, Настройки) Экспорт
	
	Настройки.События.ПередЗагрузкойНастроекВКомпоновщик = Истина;
	
КонецПроцедуры

Процедура ПередЗагрузкойНастроекВКомпоновщик(Контекст, КлючСхемы, КлючВарианта, НовыеНастройкиКД, НовыеПользовательскиеНастройкиКД) Экспорт
	
	Если ТипЗнч(Контекст) = Тип("УправляемаяФорма") Тогда
		НастроитьПараметрыОтчетаПоВариантуОтчета(Контекст.НастройкиОтчета, НовыеНастройкиКД, НовыеПользовательскиеНастройкиКД);
		ОтчетыСервер.ПодключитьСхему(ЭтотОбъект, Контекст, СхемаКомпоновкиДанных, КлючСхемы);
	КонецЕсли;
	
КонецПроцедуры

#КонецОбласти

#Область ОбработчикиСобытий

Процедура ПриКомпоновкеРезультата(ДокументРезультат, ДанныеРасшифровки, СтандартнаяОбработка)
	СтандартнаяОбработка = Ложь;
	ПользовательскиеНастройкиМодифицированы = Ложь;
	
	КонтрольИспользованияАналитикиОборотов(КомпоновщикНастроек);
	
	СхемаКомпоновкиДанных.НаборыДанных.ОсновнаяАналитика.Запрос = ИсполняемыйЗапросОсновнаяАналитика();
	СхемаКомпоновкиДанных.НаборыДанных.ОборотнаяАналитика.Запрос = ИсполняемыйЗапросОборотнаяАналитика();
	СхемаКомпоновкиДанных.НаборыДанных.Документы.Запрос = ИсполняемыйЗапросДокументы();
	
	УстановитьОбязательныеНастройки(ПользовательскиеНастройкиМодифицированы);
	
	УдалитьПоказателиИзОтборовРасшифровки(КомпоновщикНастроек);
	
	НастройкиОтчета = КомпоновщикНастроек.ПолучитьНастройки();
	
	КомпоновщикМакета = Новый КомпоновщикМакетаКомпоновкиДанных;
	МакетКомпоновки = КомпоновщикМакета.Выполнить(СхемаКомпоновкиДанных, НастройкиОтчета, ДанныеРасшифровки);
	
	// Проверим, используются ли оборотные аналитики
	КомпоновкаДанныхСервер.ОптимизацияИспользованияОборотнойАналитики(МакетКомпоновки, СхемаКомпоновкиДанных, НастройкиОтчета, ДанныеРасшифровки);
	
	КомпоновкаДанныхСервер.УстановитьЗаголовкиМакетаКомпоновки(СтруктураЗаголовковПолей(), МакетКомпоновки);
	
	ПроцессорКомпоновки = Новый ПроцессорКомпоновкиДанных;
	ПроцессорКомпоновки.Инициализировать(МакетКомпоновки, , ДанныеРасшифровки, Истина);
	
	ПроцессорВывода = Новый ПроцессорВыводаРезультатаКомпоновкиДанныхВТабличныйДокумент;
	ПроцессорВывода.УстановитьДокумент(ДокументРезультат);
	
	ПроверяемыеПоля = Новый Массив;
	ПроверяемыеПоля.Добавить("Партнер");
	ПроверяемыеПоля.Добавить("Менеджер");
	ПроверяемыеПоля.Добавить("Подразделение");
	ПроверяемыеПоля.Добавить("Сделка");
	УниверсальныеМеханизмыПартийИСебестоимости.ДобавитьПредупреждениеОбОсобенностяхФормированияОтчета(
		ДокументРезультат,
		КомпоновщикНастроек,
		ПроверяемыеПоля,
		Ложь); // Актуализировать партии
	УниверсальныеМеханизмыПартийИСебестоимости.АктуализироватьПартииДляОтчетов(ДокументРезультат, КомпоновщикНастроек, "СтруктураПредприятия.Организация");
	
	ПроцессорВывода.Вывести(ПроцессорКомпоновки);
	
	КомпоновкаДанныхСервер.ОформитьДиаграммыОтчета(КомпоновщикНастроек, ДокументРезультат);
	
	ВспомогательныеПараметры = Новый Массив;
	КомпоновкаДанныхСервер.ДобавитьВспомогательныеПараметрыОтчетаПоФункциональнымОпциям(ВспомогательныеПараметры);
	КомпоновкаДанныхСервер.СкрытьВспомогательныеПараметрыОтчета(
		СхемаКомпоновкиДанных, КомпоновщикНастроек, ДокументРезультат, ВспомогательныеПараметры);
	КомпоновкаДанныхСервер.СкрытьВспомогательныеПараметрыОтчета(
		СхемаКомпоновкиДанных, КомпоновщикНастроек, ДокументРезультат, ВспомогательныеПараметрыОтчета());
	
	// Сообщим форме отчета, что настройки модифицированы
	Если ПользовательскиеНастройкиМодифицированы Тогда
		КомпоновщикНастроек.ПользовательскиеНастройки.ДополнительныеСвойства.Вставить("ПользовательскиеНастройкиМодифицированы", Истина);
	КонецЕсли;
КонецПроцедуры

#КонецОбласти

#Область СлужебныеПроцедурыИФункции

Процедура КонтрольИспользованияАналитикиОборотов(КомпоновщикНастроек)
	Группировки = КомпоновкаДанныхКлиентСервер.ПолучитьГруппировки(КомпоновщикНастроек);
	
	Для Каждого Группировка Из Группировки Цикл 
		ПоляГруппировки = Группировка.Значение.ПоляГруппировки.Элементы;
		КоличествоПолейАналитикиОборотов = 0;
		Для Каждого ПолеГруппировки Из ПоляГруппировки Цикл 
			Если Найти(Строка(ПолеГруппировки.Поле), "АналитикаОборотов") >0 Тогда
				КоличествоПолейАналитикиОборотов = КоличествоПолейАналитикиОборотов + 1; 
			КонецЕсли;
			Если КоличествоПолейАналитикиОборотов > 1 Тогда
				ВызватьИсключение НСтр("ru= 'Множественное использование полей аналитики оборотов в группировках не поддерживается.'") ;
			КонецЕсли;
		КонецЦикла;
		Если КоличествоПолейАналитикиОборотов >= 1 И ПоляГруппировки.Количество() > 1 Тогда
			ВызватьИсключение НСтр("ru= 'Совместное использование в группировках полей аналитики оборотов и других полей не поддерживается.'") ;
		КонецЕсли;
	КонецЦикла;
КонецПроцедуры

Процедура НастроитьПараметрыОтчетаПоВариантуОтчета(НастройкиОтчета, НовыеНастройкиКД, НовыеПользовательскиеНастройкиКД)
	
	ПредопределенныйВариант = ПолучитьПредопределенныйВариант(НастройкиОтчета.ВариантСсылка);
	
	ПараметрДанныеОтчета = СхемаКомпоновкиДанных.Параметры.Найти("ДанныеОтчета");
	ПараметрПоПредприятию = СхемаКомпоновкиДанных.Параметры.Найти("ПоПредприятию");
	
	СписокВыбора = Новый СписокЗначений;
	
	Если ПредопределенныйВариант.КлючВарианта = "СебестоимостьТоваровПоПредприятию"
	 ИЛИ ПредопределенныйВариант.КлючВарианта = "СебестоимостьТоваровПоОперациямПоПредприятию"
	 ИЛИ ПредопределенныйВариант.КлючВарианта = "ДинамикаЗакупокПредприятия" Тогда
		
		СписокВыбора.Добавить(1, НСтр("ru = 'В валюте упр. учета с НДС'"));
		СписокВыбора.Добавить(2, НСтр("ru = 'В валюте упр. учета без НДС'"));
		ПараметрПоПредприятию.Значение = Истина;
		
	Иначе
		
		Если ПолучитьФункциональнуюОпцию("ВестиУправленческийУчетОрганизаций") Тогда
			СписокВыбора.Добавить(3, НСтр("ru = 'В валюте упр. учета'"));
		КонецЕсли;
		СписокВыбора.Добавить(4, НСтр("ru = 'В валюте регл. учета'"));
		ПараметрПоПредприятию.Значение = Ложь;
		
	КонецЕсли;
	
	ПараметрДанныеОтчета.УстановитьДоступныеЗначения(СписокВыбора);
	
	Если НовыеНастройкиКД = Неопределено
		Или НовыеПользовательскиеНастройкиКД = Неопределено Тогда
		Возврат;
	КонецЕсли;
	
	ЗначениеПараметраДанныеОтчета = НовыеНастройкиКД.ПараметрыДанных.НайтиЗначениеПараметра(Новый ПараметрКомпоновкиДанных("ДанныеОтчета"));
	НастройкаДанныеОтчета = НовыеПользовательскиеНастройкиКД.Элементы.Найти(ЗначениеПараметраДанныеОтчета.ИдентификаторПользовательскойНастройки);
	Если Не НастройкаДанныеОтчета = Неопределено
		И СписокВыбора.НайтиПоЗначению(НастройкаДанныеОтчета.Значение) = Неопределено Тогда
		НастройкаДанныеОтчета.Значение = СписокВыбора[0].Значение;
	КонецЕсли;
	
КонецПроцедуры

Функция ПолучитьПредопределенныйВариант(Знач Вариант)
	
	КлючиВариантов = Новый Массив;
	КлючиВариантов.Добавить("СебестоимостьТоваровБазовая");
	КлючиВариантов.Добавить("СебестоимостьТоваровПоОперациямБазовая");
	КлючиВариантов.Добавить("ДинамикаЗакупокПредприятия");
	КлючиВариантов.Добавить("ДинамикаЗакупокОрганизаций");
	КлючиВариантов.Добавить("СебестоимостьТоваровПоОрганизациям");
	КлючиВариантов.Добавить("СебестоимостьТоваровПоОперациямПоОрганизациям");
	КлючиВариантов.Добавить("СебестоимостьТоваровПоПредприятию");
	КлючиВариантов.Добавить("СебестоимостьТоваровПоОперациямПоПредприятию");
	
	Пока КлючиВариантов.Найти(Вариант.КлючВарианта) = Неопределено
		И ЗначениеЗаполнено(Вариант.Родитель) Цикл
		Вариант = Вариант.Родитель;
	КонецЦикла;
	
	Возврат Вариант;
	
КонецФункции

#Область НастройкаПараметровОтчета

Процедура УстановитьОбязательныеНастройки(ПользовательскиеНастройкиМодифицированы)
	
	СегментыСервер.ВключитьОтборПоСегментуНоменклатурыВСКД(КомпоновщикНастроек);
	
	ВидыЗапасовПоГФУ = Константы.ФормироватьВидыЗапасовПоГруппамФинансовогоУчета.Получить();
	КомпоновкаДанныхКлиентСервер.УстановитьПараметр(
	КомпоновщикНастроек, 
	"ФормироватьВидыЗапасовПоГруппамФинансовогоУчета", 
	ВидыЗапасовПоГФУ);
	
	КомпоновкаДанныхСервер.УстановитьПараметрыВалютыОтчета(КомпоновщикНастроек, ПользовательскиеНастройкиМодифицированы);
КонецПроцедуры

Функция ВспомогательныеПараметрыОтчета()
	ВспомогательныеПараметры = Новый Массив;
	
	КлючТекущегоВарианта = "";
	Если КомпоновщикНастроек.Настройки.ДополнительныеСвойства.Свойство("КлючТекущегоВарианта", КлючТекущегоВарианта) Тогда
		Если Не КлючТекущегоВарианта = "ДинамикаЗакупок" Тогда
			ВспомогательныеПараметры.Добавить("Периодичность");
		КонецЕсли;
	КонецЕсли;
	
	ВспомогательныеПараметры.Добавить("КоличественныеИтогиПоЕдИзм");
	
	ВспомогательныеПараметры.Добавить("МаксимумСерийКоличество");
	ВспомогательныеПараметры.Добавить("ВыделениеСерийДиаграмм");
	ВспомогательныеПараметры.Добавить("ОтслеживаемыеАналитики");
	ВспомогательныеПараметры.Добавить("ГрадиентСерийДиаграмм");
	ВспомогательныеПараметры.Добавить("ОтображениеМаркеровТочекДиаграмм");
	
	КомпоновкаДанныхСервер.ДобавитьВспомогательныеПараметрыОтчетаПоФункциональнымОпциям(ВспомогательныеПараметры);
	
	Возврат ВспомогательныеПараметры;
КонецФункции

Функция СтруктураЗаголовковПолей()
	СтруктураЗаголовковПолей = Новый Структура;
	
	СтруктураЗаголовковВалют = КомпоновкаДанныхСервер.СтруктураЗаголовковВалютСквознаяСебестоимость(КомпоновщикНастроек);
	ОбщегоНазначенияКлиентСервер.ДополнитьСтруктуру(СтруктураЗаголовковПолей, СтруктураЗаголовковВалют, Ложь);
	
	СтруктуруЗаголовковПолейЕдиницИзмерений = КомпоновкаДанныхСервер.СтруктураЗаголовковПолейЕдиницИзмерений(КомпоновщикНастроек);
	ОбщегоНазначенияКлиентСервер.ДополнитьСтруктуру(СтруктураЗаголовковПолей, СтруктуруЗаголовковПолейЕдиницИзмерений, Ложь);
	
	Возврат СтруктураЗаголовковПолей;
КонецФункции

Процедура УдалитьПоказателиИзОтборовРасшифровки(КомпоновщикНастроек)
	Если КомпоновщикНастроек.ФиксированныеНастройки.ДополнительныеСвойства.Свойство("РежимРасшифровки")
		И КомпоновщикНастроек.ФиксированныеНастройки.ДополнительныеСвойства.РежимРасшифровки Тогда
		Показатели = Новый Массив;
		Показатели.Добавить("Показатели.Количество.КоличествоНачальныйОстаток");
		Показатели.Добавить("Показатели.Количество.КоличествоПриход");
		Показатели.Добавить("Показатели.Количество.КоличествоРасход");
		Показатели.Добавить("Показатели.Количество.КоличествоКонечныйОстаток");
		Показатели.Добавить("Показатели.Вес.ВесНачальныйОстаток");
		Показатели.Добавить("Показатели.Вес.ВесПриход");
		Показатели.Добавить("Показатели.Вес.ВесРасход");
		Показатели.Добавить("Показатели.Вес.ВесКонечныйОстаток");
		Показатели.Добавить("Показатели.Объем.ОбъемНачальныйОстаток");
		Показатели.Добавить("Показатели.Объем.ОбъемПриход");
		Показатели.Добавить("Показатели.Объем.ОбъемРасход");
		Показатели.Добавить("Показатели.Объем.ОбъемКонечныйОстаток");
		Показатели.Добавить("Показатели.СтоимостьПоступления.СтоимостьПоступленияНачальныйОстаток");
		Показатели.Добавить("Показатели.СтоимостьПоступления.СтоимостьПоступленияПриход");
		Показатели.Добавить("Показатели.СтоимостьПоступления.СтоимостьПоступленияРасход");
		Показатели.Добавить("Показатели.СтоимостьПоступления.СтоимостьПоступленияКонечныйОстаток");
		Показатели.Добавить("Показатели.ДопРасходы.ДопРасходыНачальныйОстаток");
		Показатели.Добавить("Показатели.ДопРасходы.ДопРасходыПриход");
		Показатели.Добавить("Показатели.ДопРасходы.ДопРасходыРасход");
		Показатели.Добавить("Показатели.ДопРасходы.ДопРасходыКонечныйОстаток");
		Показатели.Добавить("Показатели.Трудозатраты.ТрудозатратыНачальныйОстаток");
		Показатели.Добавить("Показатели.Трудозатраты.ТрудозатратыПриход");
		Показатели.Добавить("Показатели.Трудозатраты.ТрудозатратыРасход");
		Показатели.Добавить("Показатели.Трудозатраты.ТрудозатратыКонечныйОстаток");
		Показатели.Добавить("Показатели.ПостатейныеПостоянные.ПостатейныеПостоянныеНачальныйОстаток");
		Показатели.Добавить("Показатели.ПостатейныеПостоянные.ПостатейныеПостоянныеПриход");
		Показатели.Добавить("Показатели.ПостатейныеПостоянные.ПостатейныеПостоянныеРасход");
		Показатели.Добавить("Показатели.ПостатейныеПостоянные.ПостатейныеПостоянныеКонечныйОстаток");
		Показатели.Добавить("Показатели.ПостатейныеПеременные.ПостатейныеПеременныеНачальныйОстаток");
		Показатели.Добавить("Показатели.ПостатейныеПеременные.ПостатейныеПеременныеПриход");
		Показатели.Добавить("Показатели.ПостатейныеПеременные.ПостатейныеПеременныеРасход");
		Показатели.Добавить("Показатели.ПостатейныеПеременные.ПостатейныеПеременныеКонечныйОстаток");
		Показатели.Добавить("Показатели.Себестоимость.СебестоимостьНачальныйОстаток");
		Показатели.Добавить("Показатели.Себестоимость.СебестоимостьПриход");
		Показатели.Добавить("Показатели.Себестоимость.СебестоимостьРасход");
		Показатели.Добавить("Показатели.Себестоимость.СебестоимостьКонечныйОстаток");
		Показатели.Добавить("Показатели.НалоговыйУчет.НалоговыйУчетНачальныйОстаток");
		Показатели.Добавить("Показатели.НалоговыйУчет.НалоговыйУчетПриход");
		Показатели.Добавить("Показатели.НалоговыйУчет.НалоговыйУчетРасход");
		Показатели.Добавить("Показатели.НалоговыйУчет.НалоговыйУчетКонечныйОстаток");
		Показатели.Добавить("Показатели.ПостояннаяРазница.ПостояннаяРазницаНачальныйОстаток");
		Показатели.Добавить("Показатели.ПостояннаяРазница.ПостояннаяРазницаПриход");
		Показатели.Добавить("Показатели.ПостояннаяРазница.ПостояннаяРазницаРасход");
		Показатели.Добавить("Показатели.ПостояннаяРазница.ПостояннаяРазницаКонечныйОстаток");
		Показатели.Добавить("Показатели.ВременнаяРазница.ВременнаяРазницаНачальныйОстаток");
		Показатели.Добавить("Показатели.ВременнаяРазница.ВременнаяРазницаПриход");
		Показатели.Добавить("Показатели.ВременнаяРазница.ВременнаяРазницаРасход");
		Показатели.Добавить("Показатели.ВременнаяРазница.ВременнаяРазницаКонечныйОстаток");
		
		Для Каждого Показатель Из Показатели Цикл 
			КомпоновкаДанныхСервер.УдалитьЭлементОтбораИзВсехНастроекОтчета(КомпоновщикНастроек, Показатель);
		КонецЦикла;
	КонецЕсли;
КонецПроцедуры

#КонецОбласти 

#Область ОбщиеФрагментыЗапросов

Функция ТекстЗапросаОтборыПоСегментам()
	ТекстЗапроса = "ВЫБРАТЬ РАЗРЕШЕННЫЕ РАЗЛИЧНЫЕ
	|	Сегменты.Номенклатура КАК Номенклатура,
	|	Сегменты.Характеристика КАК Характеристика,
	|	ИСТИНА КАК ИспользуетсяОтборПоСегментуНоменклатуры
	|ПОМЕСТИТЬ ОтборПоСегментуНоменклатуры
	|ИЗ
	|	РегистрСведений.НоменклатураСегмента КАК Сегменты
	|{ГДЕ
	|	Сегменты.Сегмент.* КАК СегментНоменклатуры,
	|	Сегменты.Номенклатура.* КАК Номенклатура,
	|	Сегменты.Характеристика.* КАК Характеристика}
	|
	|ИНДЕКСИРОВАТЬ ПО
	|	Номенклатура,
	|	Характеристика,
	|	ИспользуетсяОтборПоСегментуНоменклатуры
	|;
	|
	|////////////////////////////////////////////////////////////////////////////////
	|ВЫБРАТЬ РАЗРЕШЕННЫЕ РАЗЛИЧНЫЕ
	|	Сегменты.Партнер КАК Партнер,
	|	ИСТИНА КАК ИспользуетсяОтборПоСегментуПартнеров
	|ПОМЕСТИТЬ ОтборПоСегментуПартнеров
	|ИЗ
	|	РегистрСведений.ПартнерыСегмента КАК Сегменты
	|{ГДЕ
	|	Сегменты.Сегмент.* КАК СегментПартнеров,
	|	Сегменты.Партнер.* КАК Партнер}
	|
	|ИНДЕКСИРОВАТЬ ПО
	|	Партнер,
	|	ИспользуетсяОтборПоСегментуПартнеров
	|;";
	
	Возврат ТекстЗапроса;
КонецФункции

Функция ТекстЗапросаЗарегистрированныеВводыОстатков()
	ТекстЗапроса = "
	|////////////////////////////////////////////////////////////////////////////////
	|ВЫБРАТЬ РАЗРЕШЕННЫЕ
	|	ВводОстатков.Ссылка
	|ПОМЕСТИТЬ ЗарегистрированныеВводыОстатков
	|ИЗ
	|	Документ.ВводОстатков КАК ВводОстатков
	|ГДЕ
	|	ВводОстатков.ТипОперации В (
	|		ЗНАЧЕНИЕ(Перечисление.ТипыОперацийВводаОстатков.ОстаткиСобственныхТоваров),
	|		ЗНАЧЕНИЕ(Перечисление.ТипыОперацийВводаОстатков.ОстаткиТоваровПереданныхНаКомиссию),
	|		ЗНАЧЕНИЕ(Перечисление.ТипыОперацийВводаОстатков.ОстаткиВозвратнойТарыПринятойОтПоставщиков),
	|		ЗНАЧЕНИЕ(Перечисление.ТипыОперацийВводаОстатков.ОстаткиМатериаловПереданныхВПроизводство),
	|		ЗНАЧЕНИЕ(Перечисление.ТипыОперацийВводаОстатков.ОстаткиТоваровПолученныхНаКомиссию),
	|		ЗНАЧЕНИЕ(Перечисление.ТипыОперацийВводаОстатков.ОстаткиМатериаловПереданныхПереработчикам)
	|		)
	|	И ВводОстатков.Дата МЕЖДУ &НачалоПериода И &КонецПериода
	|	И ВводОстатков.Проведен
	|;";
	
	Возврат ТекстЗапроса;
КонецФункции

#КонецОбласти

#Область ОсновнаяАналитика

Функция ТекстЗапросаСебестоимостьТоваровОстаткиИОбороты()
	ТекстЗапроса = "
	|///////////////////////////////////////////////////////////////////////////////
	|ВЫБРАТЬ РАЗРЕШЕННЫЕ
	|
	|	// Аналитика периодов
	|	НАЧАЛОПЕРИОДА(СебестоимостьТоваровОстатки.ПериодДень,      ДЕНЬ)      КАК ПериодДень,
	|	НАЧАЛОПЕРИОДА(СебестоимостьТоваровОстатки.ПериодНеделя,    НЕДЕЛЯ)    КАК ПериодНеделя,
	|	НАЧАЛОПЕРИОДА(СебестоимостьТоваровОстатки.ПериодДекада,    ДЕКАДА)    КАК ПериодДекада,
	|	НАЧАЛОПЕРИОДА(СебестоимостьТоваровОстатки.ПериодМесяц,     МЕСЯЦ)     КАК ПериодМесяц,
	|	НАЧАЛОПЕРИОДА(СебестоимостьТоваровОстатки.ПериодКвартал,   КВАРТАЛ)   КАК ПериодКвартал,
	|	НАЧАЛОПЕРИОДА(СебестоимостьТоваровОстатки.ПериодПолугодие, ПОЛУГОДИЕ) КАК ПериодПолугодие,
	|	НАЧАЛОПЕРИОДА(СебестоимостьТоваровОстатки.ПериодГод,       ГОД)       КАК ПериодГод,
	|	
	|	// Общая аналитика
	|	СебестоимостьТоваровОстатки.АналитикаУчетаНоменклатуры КАК АналитикаУчетаНоменклатуры,
	|	АналитикаНоменклатуры.Номенклатура                     КАК Номенклатура,
	|	АналитикаНоменклатуры.Номенклатура.ЕдиницаИзмерения    КАК ЕдиницаХранения,
	|	АналитикаНоменклатуры.Номенклатура.ЕдиницаДляОтчетов   КАК ЕдиницаДляОтчетов,
	|	АналитикаНоменклатуры.Номенклатура.КоэффициентЕдиницыДляОтчетов КАК КоэффициентЕдиницыДляОтчетов,
	|	АналитикаНоменклатуры.Характеристика                   КАК Характеристика,
	|	АналитикаНоменклатуры.Серия                            КАК Серия,
	|	АналитикаНоменклатуры.Склад                            КАК Склад,
	|	АналитикаНоменклатуры.Назначение                       КАК Назначение,
	|	АналитикаНоменклатуры.Назначение.НаправлениеДеятельности КАК НаправлениеДеятельности,
	|	
	|	СебестоимостьТоваровОстатки.ВидЗапасов               КАК ВидЗапасов,
	|	
	|	ВЫБОР 
	|		КОГДА &ФормироватьВидыЗапасовПоГруппамФинансовогоУчета 
	|			ТОГДА СебестоимостьТоваровОстатки.ВидЗапасов.ГруппаФинансовогоУчета
	|			ИНАЧЕ АналитикаНоменклатуры.Номенклатура.ГруппаФинансовогоУчета
	|	КОНЕЦ КАК ГруппаФинансовогоУчета,
	|
	|	СебестоимостьТоваровОстатки.Организация КАК Организация,
	|	
	|	// Аналитика остатков и оборотов без детализации
	|	СебестоимостьТоваровОстатки.РазделУчета КАК РазделУчета,
	|	
	|	// Показатель ""Количество""
	|	ВЫБОР 
	|		КОГДА &ЕдиницыКоличества = 0 
	|			ТОГДА 1
	|		КОГДА &ЕдиницыКоличества = 1 
	|			ТОГДА
	|				ВЫБОР 
	|					КОГДА АналитикаНоменклатуры.Номенклатура.КоэффициентЕдиницыДляОтчетов <> 0 
	|						ТОГДА 1 / АналитикаНоменклатуры.Номенклатура.КоэффициентЕдиницыДляОтчетов
	|						ИНАЧЕ 0
	|				КОНЕЦ
	|	КОНЕЦ * СебестоимостьТоваровОстатки.КоличествоНачальныйОстаток КАК КоличествоНачальныйОстаток,
	|	ВЫБОР 
	|		КОГДА &ЕдиницыКоличества = 0 
	|			ТОГДА 1
	|		КОГДА &ЕдиницыКоличества = 1 
	|			ТОГДА
	|				ВЫБОР 
	|					КОГДА АналитикаНоменклатуры.Номенклатура.КоэффициентЕдиницыДляОтчетов <> 0 
	|						ТОГДА 1 / АналитикаНоменклатуры.Номенклатура.КоэффициентЕдиницыДляОтчетов
	|						ИНАЧЕ 0
	|				КОНЕЦ
	|	КОНЕЦ * СебестоимостьТоваровОстатки.КоличествоПриход КАК КоличествоПриход,
	|	ВЫБОР 
	|		КОГДА &ЕдиницыКоличества = 0 
	|			ТОГДА 1
	|		КОГДА &ЕдиницыКоличества = 1 
	|			ТОГДА
	|				ВЫБОР 
	|					КОГДА АналитикаНоменклатуры.Номенклатура.КоэффициентЕдиницыДляОтчетов <> 0 
	|						ТОГДА 1 / АналитикаНоменклатуры.Номенклатура.КоэффициентЕдиницыДляОтчетов
	|						ИНАЧЕ 0
	|				КОНЕЦ
	|	КОНЕЦ * СебестоимостьТоваровОстатки.КоличествоРасход КАК КоличествоРасход,
	|	ВЫБОР 
	|		КОГДА &ЕдиницыКоличества = 0 
	|			ТОГДА 1
	|		КОГДА &ЕдиницыКоличества = 1 
	|			ТОГДА
	|				ВЫБОР 
	|					КОГДА АналитикаНоменклатуры.Номенклатура.КоэффициентЕдиницыДляОтчетов <> 0 
	|						ТОГДА 1 / АналитикаНоменклатуры.Номенклатура.КоэффициентЕдиницыДляОтчетов
	|						ИНАЧЕ 0
	|				КОНЕЦ
	|	КОНЕЦ * СебестоимостьТоваровОстатки.КоличествоКонечныйОстаток КАК КоличествоКонечныйОстаток,
	|	
	|	// Показатель ""Вес""
	|	СебестоимостьТоваровОстатки.КоличествоНачальныйОстаток * &ТекстЗапросаВесУпаковки   КАК ВесНачальныйОстаток,
	|	СебестоимостьТоваровОстатки.КоличествоПриход * &ТекстЗапросаВесУпаковки    КАК ВесПриход,
	|	СебестоимостьТоваровОстатки.КоличествоРасход * &ТекстЗапросаВесУпаковки    КАК ВесРасход,
	|	СебестоимостьТоваровОстатки.КоличествоКонечныйОстаток * &ТекстЗапросаВесУпаковки    КАК ВесКонечныйОстаток,
	|	
	|	// Показатель ""Объем""
	|	СебестоимостьТоваровОстатки.КоличествоНачальныйОстаток * &ТекстЗапросаОбъемУпаковки КАК ОбъемНачальныйОстаток,
	|	СебестоимостьТоваровОстатки.КоличествоПриход * &ТекстЗапросаОбъемУпаковки  КАК ОбъемПриход,
	|	СебестоимостьТоваровОстатки.КоличествоРасход * &ТекстЗапросаОбъемУпаковки  КАК ОбъемРасход,
	|	СебестоимостьТоваровОстатки.КоличествоКонечныйОстаток * &ТекстЗапросаОбъемУпаковки  КАК ОбъемКонечныйОстаток,
	|	
	|	// Показатель ""СтоимостьПоступления""
	|	ВЫБОР 
	|		КОГДА &ДанныеОтчета = 1 
	|			ТОГДА СебестоимостьТоваровОстатки.СтоимостьНачальныйОстаток
	|				+ СебестоимостьТоваровОстатки.СтоимостьЗабалансоваяНачальныйОстаток
	|		КОГДА &ДанныеОтчета = 2 
	|			ТОГДА СебестоимостьТоваровОстатки.СтоимостьБезНДСНачальныйОстаток
	|				+ СебестоимостьТоваровОстатки.СтоимостьЗабалансоваяНачальныйОстаток
	|		КОГДА &ДанныеОтчета = 3 
	|			ТОГДА СебестоимостьТоваровОстатки.СтоимостьУпрНачальныйОстаток
	|				+ СебестоимостьТоваровОстатки.СтоимостьЗабалансоваяНачальныйОстаток
	|		КОГДА &ДанныеОтчета = 4 
	|			ТОГДА СебестоимостьТоваровОстатки.СтоимостьРеглНачальныйОстаток 
	|				+ СебестоимостьТоваровОстатки.СтоимостьЗабалансоваяРеглНачальныйОстаток
	|		ИНАЧЕ
	|			ВЫБОР КОГДА &ПоПредприятию ТОГДА
	|				СебестоимостьТоваровОстатки.СтоимостьБезНДСНачальныйОстаток
	|				+ СебестоимостьТоваровОстатки.СтоимостьЗабалансоваяНачальныйОстаток
	|			ИНАЧЕ
	|				СебестоимостьТоваровОстатки.СтоимостьУпрНачальныйОстаток
	|				+ СебестоимостьТоваровОстатки.СтоимостьЗабалансоваяНачальныйОстаток
	|			КОНЕЦ	
	|	КОНЕЦ КАК СтоимостьПоступленияНачальныйОстаток,
	|	ВЫБОР 
	|		КОГДА &ДанныеОтчета = 1 
	|			ТОГДА СебестоимостьТоваровОстатки.СтоимостьПриход
	|				+ СебестоимостьТоваровОстатки.СтоимостьЗабалансоваяПриход
	|		КОГДА &ДанныеОтчета = 2 
	|			ТОГДА СебестоимостьТоваровОстатки.СтоимостьБезНДСПриход
	|				+ СебестоимостьТоваровОстатки.СтоимостьЗабалансоваяПриход
	|		КОГДА &ДанныеОтчета = 3 
	|			ТОГДА СебестоимостьТоваровОстатки.СтоимостьУпрПриход
	|				+ СебестоимостьТоваровОстатки.СтоимостьЗабалансоваяПриход
	|		КОГДА &ДанныеОтчета = 4 
	|			ТОГДА СебестоимостьТоваровОстатки.СтоимостьРеглПриход
	|				+ СебестоимостьТоваровОстатки.СтоимостьЗабалансоваяРеглПриход
	|		ИНАЧЕ
	|			ВЫБОР КОГДА &ПоПредприятию ТОГДА
	|				СебестоимостьТоваровОстатки.СтоимостьБезНДСПриход
	|				+ СебестоимостьТоваровОстатки.СтоимостьЗабалансоваяПриход
	|			ИНАЧЕ
	|				СебестоимостьТоваровОстатки.СтоимостьУпрПриход
	|				+ СебестоимостьТоваровОстатки.СтоимостьЗабалансоваяПриход
	|			КОНЕЦ	
	|	КОНЕЦ КАК СтоимостьПоступленияПриход,
	|	ВЫБОР 
	|		КОГДА &ДанныеОтчета = 1 
	|			ТОГДА СебестоимостьТоваровОстатки.СтоимостьРасход
	|				+ СебестоимостьТоваровОстатки.СтоимостьЗабалансоваяРасход
	|		КОГДА &ДанныеОтчета = 2 
	|			ТОГДА СебестоимостьТоваровОстатки.СтоимостьБезНДСРасход
	|				+ СебестоимостьТоваровОстатки.СтоимостьЗабалансоваяРасход
	|		КОГДА &ДанныеОтчета = 3 
	|			ТОГДА СебестоимостьТоваровОстатки.СтоимостьУпрРасход
	|				+ СебестоимостьТоваровОстатки.СтоимостьЗабалансоваяРасход
	|		КОГДА &ДанныеОтчета = 4 
	|			ТОГДА СебестоимостьТоваровОстатки.СтоимостьРеглРасход
	|				+ СебестоимостьТоваровОстатки.СтоимостьЗабалансоваяРеглРасход
	|		ИНАЧЕ
	|			ВЫБОР КОГДА &ПоПредприятию ТОГДА
	|				СебестоимостьТоваровОстатки.СтоимостьБезНДСРасход
	|				+ СебестоимостьТоваровОстатки.СтоимостьЗабалансоваяРасход
	|			ИНАЧЕ
	|				СебестоимостьТоваровОстатки.СтоимостьУпрРасход
	|				+ СебестоимостьТоваровОстатки.СтоимостьЗабалансоваяРасход
	|			КОНЕЦ	
	|	КОНЕЦ КАК СтоимостьПоступленияРасход,
	|	ВЫБОР 
	|		КОГДА &ДанныеОтчета = 1 
	|			ТОГДА СебестоимостьТоваровОстатки.СтоимостьКонечныйОстаток
	|				+ СебестоимостьТоваровОстатки.СтоимостьЗабалансоваяКонечныйОстаток
	|		КОГДА &ДанныеОтчета = 2 
	|			ТОГДА СебестоимостьТоваровОстатки.СтоимостьБезНДСКонечныйОстаток
	|				+ СебестоимостьТоваровОстатки.СтоимостьЗабалансоваяКонечныйОстаток
	|		КОГДА &ДанныеОтчета = 3 
	|			ТОГДА СебестоимостьТоваровОстатки.СтоимостьУпрКонечныйОстаток
	|				+ СебестоимостьТоваровОстатки.СтоимостьЗабалансоваяКонечныйОстаток
	|		КОГДА &ДанныеОтчета = 4 
	|			ТОГДА СебестоимостьТоваровОстатки.СтоимостьРеглКонечныйОстаток
	|				+ СебестоимостьТоваровОстатки.СтоимостьЗабалансоваяРеглКонечныйОстаток
	|		ИНАЧЕ
	|			ВЫБОР КОГДА &ПоПредприятию ТОГДА
	|				СебестоимостьТоваровОстатки.СтоимостьБезНДСКонечныйОстаток
	|				+ СебестоимостьТоваровОстатки.СтоимостьЗабалансоваяКонечныйОстаток
	|			ИНАЧЕ
	|				СебестоимостьТоваровОстатки.СтоимостьУпрКонечныйОстаток
	|				+ СебестоимостьТоваровОстатки.СтоимостьЗабалансоваяКонечныйОстаток
	|			КОНЕЦ	
	|	КОНЕЦ	КАК СтоимостьПоступленияКонечныйОстаток,
	|	
	|	// Показатель ""Доп. расходы""
	|	ВЫБОР 
	|		КОГДА &ДанныеОтчета = 1 
	|			ТОГДА СебестоимостьТоваровОстатки.ДопРасходыНачальныйОстаток
	|		КОГДА &ДанныеОтчета = 2 
	|			ТОГДА СебестоимостьТоваровОстатки.ДопРасходыБезНДСНачальныйОстаток
	|		КОГДА &ДанныеОтчета = 3 
	|			ТОГДА СебестоимостьТоваровОстатки.ДопРасходыУпрНачальныйОстаток
	|		КОГДА &ДанныеОтчета = 4 
	|			ТОГДА СебестоимостьТоваровОстатки.ДопРасходыРеглНачальныйОстаток
	|		ИНАЧЕ
	|			ВЫБОР КОГДА &ПоПредприятию ТОГДА
	|				СебестоимостьТоваровОстатки.ДопРасходыБезНДСНачальныйОстаток
	|			ИНАЧЕ
	|				СебестоимостьТоваровОстатки.ДопРасходыУпрНачальныйОстаток
	|			КОНЕЦ	
	|	КОНЕЦ КАК ДопРасходыНачальныйОстаток,
	|	ВЫБОР 
	|		КОГДА &ДанныеОтчета = 1 
	|			ТОГДА СебестоимостьТоваровОстатки.ДопРасходыПриход
	|		КОГДА &ДанныеОтчета = 2 
	|			ТОГДА СебестоимостьТоваровОстатки.ДопРасходыБезНДСПриход
	|		КОГДА &ДанныеОтчета = 3 
	|			ТОГДА СебестоимостьТоваровОстатки.ДопРасходыУпрПриход
	|		КОГДА &ДанныеОтчета = 4 
	|			ТОГДА СебестоимостьТоваровОстатки.ДопРасходыРеглПриход
	|		ИНАЧЕ
	|			ВЫБОР КОГДА &ПоПредприятию ТОГДА
	|				СебестоимостьТоваровОстатки.ДопРасходыБезНДСПриход
	|			ИНАЧЕ
	|				СебестоимостьТоваровОстатки.ДопРасходыУпрПриход
	|			КОНЕЦ	
	|	КОНЕЦ КАК ДопРасходыПриход,
	|	ВЫБОР 
	|		КОГДА &ДанныеОтчета = 1 
	|			ТОГДА СебестоимостьТоваровОстатки.ДопРасходыРасход
	|		КОГДА &ДанныеОтчета = 2 
	|			ТОГДА СебестоимостьТоваровОстатки.ДопРасходыБезНДСРасход
	|		КОГДА &ДанныеОтчета = 3 
	|			ТОГДА СебестоимостьТоваровОстатки.ДопРасходыУпрРасход
	|		КОГДА &ДанныеОтчета = 4 
	|			ТОГДА СебестоимостьТоваровОстатки.ДопРасходыРеглРасход
	|		ИНАЧЕ
	|			ВЫБОР КОГДА &ПоПредприятию ТОГДА
	|				СебестоимостьТоваровОстатки.ДопРасходыБезНДСРасход
	|			ИНАЧЕ
	|				СебестоимостьТоваровОстатки.ДопРасходыУпрРасход
	|			КОНЕЦ	
	|	КОНЕЦ КАК ДопРасходыРасход,
	|	ВЫБОР 
	|		КОГДА &ДанныеОтчета = 1 
	|			ТОГДА СебестоимостьТоваровОстатки.ДопРасходыКонечныйОстаток
	|		КОГДА &ДанныеОтчета = 2 
	|			ТОГДА СебестоимостьТоваровОстатки.ДопРасходыБезНДСКонечныйОстаток
	|		КОГДА &ДанныеОтчета = 3 
	|			ТОГДА СебестоимостьТоваровОстатки.ДопРасходыУпрКонечныйОстаток
	|		КОГДА &ДанныеОтчета = 4 
	|			ТОГДА СебестоимостьТоваровОстатки.ДопРасходыРеглКонечныйОстаток
	|		ИНАЧЕ
	|			ВЫБОР КОГДА &ПоПредприятию ТОГДА
	|				СебестоимостьТоваровОстатки.ДопРасходыБезНДСКонечныйОстаток
	|			ИНАЧЕ
	|				СебестоимостьТоваровОстатки.ДопРасходыУпрКонечныйОстаток
	|			КОНЕЦ	
	|	КОНЕЦ КАК ДопРасходыКонечныйОстаток,
	|
	|	// Показатель ""Трудозатраты""
	|	ВЫБОР 
	|		КОГДА &ДанныеОтчета = 1 
	|			ТОГДА СебестоимостьТоваровОстатки.ТрудозатратыНачальныйОстаток
	|		КОГДА &ДанныеОтчета = 2 
	|			ТОГДА СебестоимостьТоваровОстатки.ТрудозатратыНачальныйОстаток
	|		КОГДА &ДанныеОтчета = 3 
	|			ТОГДА СебестоимостьТоваровОстатки.ТрудозатратыУпрНачальныйОстаток
	|		КОГДА &ДанныеОтчета = 4 
	|			ТОГДА СебестоимостьТоваровОстатки.ТрудозатратыРеглНачальныйОстаток
	|		ИНАЧЕ
	|			ВЫБОР КОГДА &ПоПредприятию ТОГДА
	|				СебестоимостьТоваровОстатки.ТрудозатратыНачальныйОстаток
	|			ИНАЧЕ
	|				СебестоимостьТоваровОстатки.ТрудозатратыУпрНачальныйОстаток
	|			КОНЕЦ	
	|	КОНЕЦ КАК ТрудозатратыНачальныйОстаток,
	|	ВЫБОР 
	|		КОГДА &ДанныеОтчета = 1 
	|			ТОГДА СебестоимостьТоваровОстатки.ТрудозатратыПриход
	|		КОГДА &ДанныеОтчета = 2 
	|			ТОГДА СебестоимостьТоваровОстатки.ТрудозатратыПриход
	|		КОГДА &ДанныеОтчета = 3 
	|			ТОГДА СебестоимостьТоваровОстатки.ТрудозатратыУпрПриход
	|		КОГДА &ДанныеОтчета = 4 
	|			ТОГДА СебестоимостьТоваровОстатки.ТрудозатратыРеглПриход
	|		ИНАЧЕ
	|			ВЫБОР КОГДА &ПоПредприятию ТОГДА
	|				СебестоимостьТоваровОстатки.ТрудозатратыПриход
	|			ИНАЧЕ
	|				СебестоимостьТоваровОстатки.ТрудозатратыУпрПриход
	|			КОНЕЦ	
	|	КОНЕЦ КАК ТрудозатратыПриход,
	|	ВЫБОР 
	|		КОГДА &ДанныеОтчета = 1 
	|			ТОГДА СебестоимостьТоваровОстатки.ТрудозатратыРасход
	|		КОГДА &ДанныеОтчета = 2 
	|			ТОГДА СебестоимостьТоваровОстатки.ТрудозатратыРасход
	|		КОГДА &ДанныеОтчета = 3 
	|			ТОГДА СебестоимостьТоваровОстатки.ТрудозатратыУпрРасход
	|		КОГДА &ДанныеОтчета = 4 
	|			ТОГДА СебестоимостьТоваровОстатки.ТрудозатратыРеглРасход
	|		ИНАЧЕ
	|			ВЫБОР КОГДА &ПоПредприятию ТОГДА
	|				СебестоимостьТоваровОстатки.ТрудозатратыРасход
	|			ИНАЧЕ
	|				СебестоимостьТоваровОстатки.ТрудозатратыУпрРасход
	|			КОНЕЦ	
	|	КОНЕЦ КАК ТрудозатратыРасход,
	|	ВЫБОР 
	|		КОГДА &ДанныеОтчета = 1 
	|			ТОГДА СебестоимостьТоваровОстатки.ТрудозатратыКонечныйОстаток
	|		КОГДА &ДанныеОтчета = 2 
	|			ТОГДА СебестоимостьТоваровОстатки.ТрудозатратыКонечныйОстаток
	|		КОГДА &ДанныеОтчета = 3 
	|			ТОГДА СебестоимостьТоваровОстатки.ТрудозатратыУпрКонечныйОстаток
	|		КОГДА &ДанныеОтчета = 4 
	|			ТОГДА СебестоимостьТоваровОстатки.ТрудозатратыРеглКонечныйОстаток
	|		ИНАЧЕ
	|			ВЫБОР КОГДА &ПоПредприятию ТОГДА
	|				СебестоимостьТоваровОстатки.ТрудозатратыКонечныйОстаток
	|			ИНАЧЕ
	|				СебестоимостьТоваровОстатки.ТрудозатратыУпрКонечныйОстаток
	|			КОНЕЦ	
	|	КОНЕЦ	КАК ТрудозатратыКонечныйОстаток,
	|
	|	// Показатель ""ПостатейныеПостоянные""
	|	ВЫБОР 
	|		КОГДА &ДанныеОтчета = 1 
	|			ТОГДА СебестоимостьТоваровОстатки.ПостатейныеПостоянныеСНДСНачальныйОстаток
	|		КОГДА &ДанныеОтчета = 2 
	|			ТОГДА СебестоимостьТоваровОстатки.ПостатейныеПостоянныеБезНДСНачальныйОстаток
	|		КОГДА &ДанныеОтчета = 3 
	|			ТОГДА СебестоимостьТоваровОстатки.ПостатейныеПостоянныеУпрНачальныйОстаток
	|		КОГДА &ДанныеОтчета = 4 
	|			ТОГДА СебестоимостьТоваровОстатки.ПостатейныеПостоянныеРеглНачальныйОстаток
	|		ИНАЧЕ
	|			ВЫБОР КОГДА &ПоПредприятию ТОГДА
	|				СебестоимостьТоваровОстатки.ПостатейныеПостоянныеБезНДСНачальныйОстаток
	|			ИНАЧЕ
	|				СебестоимостьТоваровОстатки.ПостатейныеПостоянныеУпрНачальныйОстаток
	|			КОНЕЦ	
	|	КОНЕЦ КАК ПостатейныеПостоянныеНачальныйОстаток,
	|	ВЫБОР 
	|		КОГДА &ДанныеОтчета = 1 
	|			ТОГДА СебестоимостьТоваровОстатки.ПостатейныеПостоянныеСНДСПриход
	|		КОГДА &ДанныеОтчета = 2 
	|			ТОГДА СебестоимостьТоваровОстатки.ПостатейныеПостоянныеБезНДСПриход
	|		КОГДА &ДанныеОтчета = 3 
	|			ТОГДА СебестоимостьТоваровОстатки.ПостатейныеПостоянныеУпрПриход
	|		КОГДА &ДанныеОтчета = 4 
	|			ТОГДА СебестоимостьТоваровОстатки.ПостатейныеПостоянныеРеглПриход
	|		ИНАЧЕ
	|			ВЫБОР КОГДА &ПоПредприятию ТОГДА
	|				СебестоимостьТоваровОстатки.ПостатейныеПостоянныеБезНДСПриход
	|			ИНАЧЕ
	|				СебестоимостьТоваровОстатки.ПостатейныеПостоянныеУпрПриход
	|			КОНЕЦ	
	|	КОНЕЦ КАК ПостатейныеПостоянныеПриход,
	|	ВЫБОР 
	|		КОГДА &ДанныеОтчета = 1 
	|			ТОГДА СебестоимостьТоваровОстатки.ПостатейныеПостоянныеСНДСРасход
	|		КОГДА &ДанныеОтчета = 2 
	|			ТОГДА СебестоимостьТоваровОстатки.ПостатейныеПостоянныеБезНДСРасход
	|		КОГДА &ДанныеОтчета = 3 
	|			ТОГДА СебестоимостьТоваровОстатки.ПостатейныеПостоянныеУпрРасход
	|		КОГДА &ДанныеОтчета = 4 
	|			ТОГДА СебестоимостьТоваровОстатки.ПостатейныеПостоянныеРеглРасход
	|		ИНАЧЕ
	|			ВЫБОР КОГДА &ПоПредприятию ТОГДА
	|				СебестоимостьТоваровОстатки.ПостатейныеПостоянныеБезНДСРасход
	|			ИНАЧЕ
	|				СебестоимостьТоваровОстатки.ПостатейныеПостоянныеУпрРасход
	|			КОНЕЦ	
	|	КОНЕЦ КАК ПостатейныеПостоянныеРасход,
	|	ВЫБОР 
	|		КОГДА &ДанныеОтчета = 1 
	|			ТОГДА СебестоимостьТоваровОстатки.ПостатейныеПостоянныеСНДСКонечныйОстаток
	|		КОГДА &ДанныеОтчета = 2 
	|			ТОГДА СебестоимостьТоваровОстатки.ПостатейныеПостоянныеБезНДСКонечныйОстаток
	|		КОГДА &ДанныеОтчета = 3 
	|			ТОГДА СебестоимостьТоваровОстатки.ПостатейныеПостоянныеУпрКонечныйОстаток
	|		КОГДА &ДанныеОтчета = 4 
	|			ТОГДА СебестоимостьТоваровОстатки.ПостатейныеПостоянныеРеглКонечныйОстаток
	|		ИНАЧЕ
	|			ВЫБОР КОГДА &ПоПредприятию ТОГДА
	|				СебестоимостьТоваровОстатки.ПостатейныеПостоянныеБезНДСКонечныйОстаток
	|			ИНАЧЕ
	|				СебестоимостьТоваровОстатки.ПостатейныеПостоянныеУпрКонечныйОстаток
	|			КОНЕЦ	
	|	КОНЕЦ КАК ПостатейныеПостоянныеКонечныйОстаток,
	|
	|	// Показатель ""ПостатейныеПеременные""
	|	ВЫБОР 
	|		КОГДА &ДанныеОтчета = 1 
	|			ТОГДА СебестоимостьТоваровОстатки.ПостатейныеПеременныеСНДСНачальныйОстаток
	|		КОГДА &ДанныеОтчета = 2 
	|			ТОГДА СебестоимостьТоваровОстатки.ПостатейныеПеременныеБезНДСНачальныйОстаток
	|		КОГДА &ДанныеОтчета = 3 
	|			ТОГДА СебестоимостьТоваровОстатки.ПостатейныеПеременныеУпрНачальныйОстаток
	|		КОГДА &ДанныеОтчета = 4 
	|			ТОГДА СебестоимостьТоваровОстатки.ПостатейныеПеременныеРеглНачальныйОстаток
	|		ИНАЧЕ
	|			ВЫБОР КОГДА &ПоПредприятию ТОГДА
	|				СебестоимостьТоваровОстатки.ПостатейныеПеременныеБезНДСНачальныйОстаток
	|			ИНАЧЕ
	|				СебестоимостьТоваровОстатки.ПостатейныеПеременныеУпрНачальныйОстаток
	|			КОНЕЦ	
	|	КОНЕЦ КАК ПостатейныеПеременныеНачальныйОстаток,
	|	ВЫБОР 
	|		КОГДА &ДанныеОтчета = 1 
	|			ТОГДА СебестоимостьТоваровОстатки.ПостатейныеПеременныеСНДСПриход
	|		КОГДА &ДанныеОтчета = 2 
	|			ТОГДА СебестоимостьТоваровОстатки.ПостатейныеПеременныеБезНДСПриход
	|		КОГДА &ДанныеОтчета = 3 
	|			ТОГДА СебестоимостьТоваровОстатки.ПостатейныеПеременныеУпрПриход
	|		КОГДА &ДанныеОтчета = 4 
	|			ТОГДА СебестоимостьТоваровОстатки.ПостатейныеПеременныеРеглПриход
	|		ИНАЧЕ
	|			ВЫБОР КОГДА &ПоПредприятию ТОГДА
	|				СебестоимостьТоваровОстатки.ПостатейныеПеременныеБезНДСПриход
	|			ИНАЧЕ
	|				СебестоимостьТоваровОстатки.ПостатейныеПеременныеУпрПриход
	|			КОНЕЦ	
	|	КОНЕЦ КАК ПостатейныеПеременныеПриход,
	|	ВЫБОР 
	|		КОГДА &ДанныеОтчета = 1 
	|			ТОГДА СебестоимостьТоваровОстатки.ПостатейныеПеременныеСНДСРасход
	|		КОГДА &ДанныеОтчета = 2 
	|			ТОГДА СебестоимостьТоваровОстатки.ПостатейныеПеременныеБезНДСРасход
	|		КОГДА &ДанныеОтчета = 3 
	|			ТОГДА СебестоимостьТоваровОстатки.ПостатейныеПеременныеУпрРасход
	|		КОГДА &ДанныеОтчета = 4 
	|			ТОГДА СебестоимостьТоваровОстатки.ПостатейныеПеременныеРеглРасход
	|		ИНАЧЕ
	|			ВЫБОР КОГДА &ПоПредприятию ТОГДА
	|				СебестоимостьТоваровОстатки.ПостатейныеПеременныеБезНДСРасход
	|			ИНАЧЕ
	|				СебестоимостьТоваровОстатки.ПостатейныеПеременныеУпрРасход
	|			КОНЕЦ	
	|	КОНЕЦ КАК ПостатейныеПеременныеРасход,
	|	ВЫБОР 
	|		КОГДА &ДанныеОтчета = 1 
	|			ТОГДА СебестоимостьТоваровОстатки.ПостатейныеПеременныеСНДСКонечныйОстаток
	|		КОГДА &ДанныеОтчета = 2 
	|			ТОГДА СебестоимостьТоваровОстатки.ПостатейныеПеременныеБезНДСКонечныйОстаток
	|		КОГДА &ДанныеОтчета = 3 
	|			ТОГДА СебестоимостьТоваровОстатки.ПостатейныеПеременныеУпрКонечныйОстаток
	|		КОГДА &ДанныеОтчета = 4 
	|			ТОГДА СебестоимостьТоваровОстатки.ПостатейныеПеременныеРеглКонечныйОстаток
	|		ИНАЧЕ
	|			ВЫБОР КОГДА &ПоПредприятию ТОГДА
	|				СебестоимостьТоваровОстатки.ПостатейныеПеременныеБезНДСКонечныйОстаток
	|			ИНАЧЕ
	|				СебестоимостьТоваровОстатки.ПостатейныеПеременныеУпрКонечныйОстаток
	|			КОНЕЦ	
	|	КОНЕЦ КАК ПостатейныеПеременныеКонечныйОстаток,
	|
	|	// Показатель ""Себестоимость""
	|	ВЫБОР 
	|		КОГДА &ДанныеОтчета = 1 
	|			ТОГДА СебестоимостьТоваровОстатки.СтоимостьНачальныйОстаток 
	|				+ СебестоимостьТоваровОстатки.ДопРасходыНачальныйОстаток
	|				+ СебестоимостьТоваровОстатки.СтоимостьЗабалансоваяНачальныйОстаток
	|				+ СебестоимостьТоваровОстатки.ТрудозатратыНачальныйОстаток
	|				+ СебестоимостьТоваровОстатки.ПостатейныеПостоянныеСНДСНачальныйОстаток
	|				+ СебестоимостьТоваровОстатки.ПостатейныеПеременныеСНДСНачальныйОстаток
	|		КОГДА &ДанныеОтчета = 2 
	|			ТОГДА СебестоимостьТоваровОстатки.СтоимостьБезНДСНачальныйОстаток
	|				+ СебестоимостьТоваровОстатки.ДопРасходыБезНДСНачальныйОстаток
	|				+ СебестоимостьТоваровОстатки.СтоимостьЗабалансоваяНачальныйОстаток
	|				+ СебестоимостьТоваровОстатки.ТрудозатратыНачальныйОстаток
	|				+ СебестоимостьТоваровОстатки.ПостатейныеПостоянныеБезНДСНачальныйОстаток
	|				+ СебестоимостьТоваровОстатки.ПостатейныеПеременныеБезНДСНачальныйОстаток
	|		КОГДА &ДанныеОтчета = 3 
	|			ТОГДА СебестоимостьТоваровОстатки.СтоимостьУпрНачальныйОстаток
	|				+ СебестоимостьТоваровОстатки.ДопРасходыУпрНачальныйОстаток
	|				+ СебестоимостьТоваровОстатки.СтоимостьЗабалансоваяНачальныйОстаток
	|				+ СебестоимостьТоваровОстатки.ТрудозатратыУпрНачальныйОстаток
	|				+ СебестоимостьТоваровОстатки.ПостатейныеПостоянныеУпрНачальныйОстаток
	|				+ СебестоимостьТоваровОстатки.ПостатейныеПеременныеУпрНачальныйОстаток
	|		КОГДА &ДанныеОтчета = 4 
	|			ТОГДА СебестоимостьТоваровОстатки.СтоимостьРеглНачальныйОстаток 
	|				+ СебестоимостьТоваровОстатки.ДопРасходыРеглНачальныйОстаток
	|				+ СебестоимостьТоваровОстатки.СтоимостьЗабалансоваяРеглНачальныйОстаток
	|				+ СебестоимостьТоваровОстатки.ТрудозатратыРеглНачальныйОстаток
	|				+ СебестоимостьТоваровОстатки.ПостатейныеПостоянныеРеглНачальныйОстаток
	|				+ СебестоимостьТоваровОстатки.ПостатейныеПеременныеРеглНачальныйОстаток
	|		ИНАЧЕ
	|			ВЫБОР КОГДА &ПоПредприятию ТОГДА
	|				СебестоимостьТоваровОстатки.СтоимостьБезНДСНачальныйОстаток
	|				+ СебестоимостьТоваровОстатки.ДопРасходыБезНДСНачальныйОстаток
	|				+ СебестоимостьТоваровОстатки.СтоимостьЗабалансоваяНачальныйОстаток
	|				+ СебестоимостьТоваровОстатки.ТрудозатратыНачальныйОстаток
	|				+ СебестоимостьТоваровОстатки.ПостатейныеПостоянныеБезНДСНачальныйОстаток
	|				+ СебестоимостьТоваровОстатки.ПостатейныеПеременныеБезНДСНачальныйОстаток
	|			ИНАЧЕ
	|				СебестоимостьТоваровОстатки.СтоимостьУпрНачальныйОстаток
	|				+ СебестоимостьТоваровОстатки.ДопРасходыУпрНачальныйОстаток
	|				+ СебестоимостьТоваровОстатки.СтоимостьЗабалансоваяНачальныйОстаток
	|				+ СебестоимостьТоваровОстатки.ТрудозатратыУпрНачальныйОстаток
	|				+ СебестоимостьТоваровОстатки.ПостатейныеПостоянныеУпрНачальныйОстаток
	|				+ СебестоимостьТоваровОстатки.ПостатейныеПеременныеУпрНачальныйОстаток
	|			КОНЕЦ	
	|	КОНЕЦ КАК СебестоимостьНачальныйОстаток,
	|	ВЫБОР 
	|		КОГДА &ДанныеОтчета = 1 
	|			ТОГДА СебестоимостьТоваровОстатки.СтоимостьПриход 
	|				+ СебестоимостьТоваровОстатки.ДопРасходыПриход
	|				+ СебестоимостьТоваровОстатки.СтоимостьЗабалансоваяПриход
	|				+ СебестоимостьТоваровОстатки.ТрудозатратыПриход
	|				+ СебестоимостьТоваровОстатки.ПостатейныеПостоянныеСНДСПриход
	|				+ СебестоимостьТоваровОстатки.ПостатейныеПеременныеСНДСПриход
	|		КОГДА &ДанныеОтчета = 2 
	|			ТОГДА СебестоимостьТоваровОстатки.СтоимостьБезНДСПриход
	|				+ СебестоимостьТоваровОстатки.ДопРасходыБезНДСПриход
	|				+ СебестоимостьТоваровОстатки.СтоимостьЗабалансоваяПриход
	|				+ СебестоимостьТоваровОстатки.ТрудозатратыПриход
	|				+ СебестоимостьТоваровОстатки.ПостатейныеПостоянныеБезНДСПриход
	|				+ СебестоимостьТоваровОстатки.ПостатейныеПеременныеБезНДСПриход
	|		КОГДА &ДанныеОтчета = 3 
	|			ТОГДА СебестоимостьТоваровОстатки.СтоимостьУпрПриход
	|				+ СебестоимостьТоваровОстатки.ДопРасходыУпрПриход
	|				+ СебестоимостьТоваровОстатки.СтоимостьЗабалансоваяПриход
	|				+ СебестоимостьТоваровОстатки.ТрудозатратыУпрПриход
	|				+ СебестоимостьТоваровОстатки.ПостатейныеПостоянныеУпрПриход
	|				+ СебестоимостьТоваровОстатки.ПостатейныеПеременныеУпрПриход
	|		КОГДА &ДанныеОтчета = 4 
	|			ТОГДА СебестоимостьТоваровОстатки.СтоимостьРеглПриход 
	|				+ СебестоимостьТоваровОстатки.ДопРасходыРеглПриход
	|				+ СебестоимостьТоваровОстатки.СтоимостьЗабалансоваяРеглПриход
	|				+ СебестоимостьТоваровОстатки.ТрудозатратыРеглПриход
	|				+ СебестоимостьТоваровОстатки.ПостатейныеПостоянныеРеглПриход
	|				+ СебестоимостьТоваровОстатки.ПостатейныеПеременныеРеглПриход
	|		ИНАЧЕ
	|			ВЫБОР КОГДА &ПоПредприятию ТОГДА
	|				СебестоимостьТоваровОстатки.СтоимостьБезНДСПриход
	|				+ СебестоимостьТоваровОстатки.ДопРасходыБезНДСПриход
	|				+ СебестоимостьТоваровОстатки.СтоимостьЗабалансоваяПриход
	|				+ СебестоимостьТоваровОстатки.ТрудозатратыПриход
	|				+ СебестоимостьТоваровОстатки.ПостатейныеПостоянныеБезНДСПриход
	|				+ СебестоимостьТоваровОстатки.ПостатейныеПеременныеБезНДСПриход
	|			ИНАЧЕ
	|				СебестоимостьТоваровОстатки.СтоимостьУпрПриход
	|				+ СебестоимостьТоваровОстатки.ДопРасходыУпрПриход
	|				+ СебестоимостьТоваровОстатки.СтоимостьЗабалансоваяПриход
	|				+ СебестоимостьТоваровОстатки.ТрудозатратыУпрПриход
	|				+ СебестоимостьТоваровОстатки.ПостатейныеПостоянныеУпрПриход
	|				+ СебестоимостьТоваровОстатки.ПостатейныеПеременныеУпрПриход
	|			КОНЕЦ	
	|	КОНЕЦ КАК СебестоимостьПриход,
	|	ВЫБОР 
	|		КОГДА &ДанныеОтчета = 1 
	|			ТОГДА СебестоимостьТоваровОстатки.СтоимостьРасход 
	|				+ СебестоимостьТоваровОстатки.ДопРасходыРасход
	|				+ СебестоимостьТоваровОстатки.СтоимостьЗабалансоваяРасход
	|				+ СебестоимостьТоваровОстатки.ТрудозатратыРасход
	|				+ СебестоимостьТоваровОстатки.ПостатейныеПостоянныеСНДСРасход
	|				+ СебестоимостьТоваровОстатки.ПостатейныеПеременныеСНДСРасход
	|		КОГДА &ДанныеОтчета = 2 
	|			ТОГДА СебестоимостьТоваровОстатки.СтоимостьБезНДСРасход
	|				+ СебестоимостьТоваровОстатки.ДопРасходыБезНДСРасход
	|				+ СебестоимостьТоваровОстатки.СтоимостьЗабалансоваяРасход
	|				+ СебестоимостьТоваровОстатки.ТрудозатратыРасход
	|				+ СебестоимостьТоваровОстатки.ПостатейныеПостоянныеБезНДСРасход
	|				+ СебестоимостьТоваровОстатки.ПостатейныеПеременныеБезНДСРасход
	|		КОГДА &ДанныеОтчета = 3 
	|			ТОГДА СебестоимостьТоваровОстатки.СтоимостьУпрРасход
	|				+ СебестоимостьТоваровОстатки.ДопРасходыУпрРасход
	|				+ СебестоимостьТоваровОстатки.СтоимостьЗабалансоваяРасход
	|				+ СебестоимостьТоваровОстатки.ТрудозатратыУпрРасход
	|				+ СебестоимостьТоваровОстатки.ПостатейныеПостоянныеУпрРасход
	|				+ СебестоимостьТоваровОстатки.ПостатейныеПеременныеУпрРасход
	|		КОГДА &ДанныеОтчета = 4 
	|			ТОГДА СебестоимостьТоваровОстатки.СтоимостьРеглРасход 
	|				+ СебестоимостьТоваровОстатки.ДопРасходыРеглРасход
	|				+ СебестоимостьТоваровОстатки.СтоимостьЗабалансоваяРеглРасход
	|				+ СебестоимостьТоваровОстатки.ТрудозатратыРеглРасход
	|				+ СебестоимостьТоваровОстатки.ПостатейныеПостоянныеРеглРасход
	|				+ СебестоимостьТоваровОстатки.ПостатейныеПеременныеРеглРасход
	|		ИНАЧЕ
	|			ВЫБОР КОГДА &ПоПредприятию ТОГДА
	|				СебестоимостьТоваровОстатки.СтоимостьБезНДСРасход
	|				+ СебестоимостьТоваровОстатки.ДопРасходыБезНДСРасход
	|				+ СебестоимостьТоваровОстатки.СтоимостьЗабалансоваяРасход
	|				+ СебестоимостьТоваровОстатки.ТрудозатратыРасход
	|				+ СебестоимостьТоваровОстатки.ПостатейныеПостоянныеБезНДСРасход
	|				+ СебестоимостьТоваровОстатки.ПостатейныеПеременныеБезНДСРасход
	|			ИНАЧЕ
	|				СебестоимостьТоваровОстатки.СтоимостьУпрРасход
	|				+ СебестоимостьТоваровОстатки.ДопРасходыУпрРасход
	|				+ СебестоимостьТоваровОстатки.СтоимостьЗабалансоваяРасход
	|				+ СебестоимостьТоваровОстатки.ТрудозатратыУпрРасход
	|				+ СебестоимостьТоваровОстатки.ПостатейныеПостоянныеУпрРасход
	|				+ СебестоимостьТоваровОстатки.ПостатейныеПеременныеУпрРасход
	|			КОНЕЦ	
	|	КОНЕЦ КАК СебестоимостьРасход,
	|	ВЫБОР 
	|		КОГДА &ДанныеОтчета = 1 
	|			ТОГДА СебестоимостьТоваровОстатки.СтоимостьКонечныйОстаток 
	|				+ СебестоимостьТоваровОстатки.ДопРасходыКонечныйОстаток
	|				+ СебестоимостьТоваровОстатки.СтоимостьЗабалансоваяКонечныйОстаток
	|				+ СебестоимостьТоваровОстатки.ТрудозатратыКонечныйОстаток
	|				+ СебестоимостьТоваровОстатки.ПостатейныеПостоянныеСНДСКонечныйОстаток
	|				+ СебестоимостьТоваровОстатки.ПостатейныеПеременныеСНДСКонечныйОстаток
	|		КОГДА &ДанныеОтчета = 2 
	|			ТОГДА СебестоимостьТоваровОстатки.СтоимостьБезНДСКонечныйОстаток
	|				+ СебестоимостьТоваровОстатки.ДопРасходыБезНДСКонечныйОстаток
	|				+ СебестоимостьТоваровОстатки.СтоимостьЗабалансоваяКонечныйОстаток
	|				+ СебестоимостьТоваровОстатки.ТрудозатратыКонечныйОстаток
	|				+ СебестоимостьТоваровОстатки.ПостатейныеПостоянныеБезНДСКонечныйОстаток
	|				+ СебестоимостьТоваровОстатки.ПостатейныеПеременныеБезНДСКонечныйОстаток
	|		КОГДА &ДанныеОтчета = 3 
	|			ТОГДА СебестоимостьТоваровОстатки.СтоимостьУпрКонечныйОстаток
	|				+ СебестоимостьТоваровОстатки.ДопРасходыУпрКонечныйОстаток
	|				+ СебестоимостьТоваровОстатки.СтоимостьЗабалансоваяКонечныйОстаток
	|				+ СебестоимостьТоваровОстатки.ТрудозатратыУпрКонечныйОстаток
	|				+ СебестоимостьТоваровОстатки.ПостатейныеПостоянныеУпрКонечныйОстаток
	|				+ СебестоимостьТоваровОстатки.ПостатейныеПеременныеУпрКонечныйОстаток
	|		КОГДА &ДанныеОтчета = 4 
	|			ТОГДА СебестоимостьТоваровОстатки.СтоимостьРеглКонечныйОстаток 
	|				+ СебестоимостьТоваровОстатки.ДопРасходыРеглКонечныйОстаток
	|				+ СебестоимостьТоваровОстатки.СтоимостьЗабалансоваяРеглКонечныйОстаток
	|				+ СебестоимостьТоваровОстатки.ТрудозатратыРеглКонечныйОстаток
	|				+ СебестоимостьТоваровОстатки.ПостатейныеПостоянныеРеглКонечныйОстаток
	|				+ СебестоимостьТоваровОстатки.ПостатейныеПеременныеРеглКонечныйОстаток
	|		ИНАЧЕ
	|			ВЫБОР КОГДА &ПоПредприятию ТОГДА
	|				СебестоимостьТоваровОстатки.СтоимостьБезНДСКонечныйОстаток
	|				+ СебестоимостьТоваровОстатки.ДопРасходыБезНДСКонечныйОстаток
	|				+ СебестоимостьТоваровОстатки.СтоимостьЗабалансоваяКонечныйОстаток
	|				+ СебестоимостьТоваровОстатки.ТрудозатратыКонечныйОстаток
	|				+ СебестоимостьТоваровОстатки.ПостатейныеПостоянныеБезНДСКонечныйОстаток
	|				+ СебестоимостьТоваровОстатки.ПостатейныеПеременныеБезНДСКонечныйОстаток
	|			ИНАЧЕ
	|				СебестоимостьТоваровОстатки.СтоимостьУпрКонечныйОстаток
	|				+ СебестоимостьТоваровОстатки.ДопРасходыУпрКонечныйОстаток
	|				+ СебестоимостьТоваровОстатки.СтоимостьЗабалансоваяКонечныйОстаток
	|				+ СебестоимостьТоваровОстатки.ТрудозатратыУпрКонечныйОстаток
	|				+ СебестоимостьТоваровОстатки.ПостатейныеПостоянныеУпрКонечныйОстаток
	|				+ СебестоимостьТоваровОстатки.ПостатейныеПеременныеУпрКонечныйОстаток
	|			КОНЕЦ	
	|	КОНЕЦ КАК СебестоимостьКонечныйОстаток,
	|
	|	// Показатель ""Налоговый учет""
	|	ВЫБОР 
	|		КОГДА &ДанныеОтчета = 1 ИЛИ &ДанныеОтчета = 2 ИЛИ &ДанныеОтчета = 3
	|			ТОГДА 0
	|		КОГДА &ДанныеОтчета = 4 
	|			ТОГДА СебестоимостьТоваровОстатки.СтоимостьРеглНачальныйОстаток 
	|				+ СебестоимостьТоваровОстатки.ДопРасходыРеглНачальныйОстаток
	|				+ СебестоимостьТоваровОстатки.СтоимостьЗабалансоваяРеглНачальныйОстаток
	|				+ СебестоимостьТоваровОстатки.ТрудозатратыРеглНачальныйОстаток
	|				+ СебестоимостьТоваровОстатки.ПостатейныеПостоянныеРеглНачальныйОстаток
	|				+ СебестоимостьТоваровОстатки.ПостатейныеПеременныеРеглНачальныйОстаток
	|				- СебестоимостьТоваровОстатки.ПостояннаяРазницаНачальныйОстаток
	|				- СебестоимостьТоваровОстатки.ВременнаяРазницаНачальныйОстаток
	|		ИНАЧЕ
	|			0
	|	КОНЕЦ КАК НалоговыйУчетНачальныйОстаток,
	|	ВЫБОР 
	|		КОГДА &ДанныеОтчета = 1 ИЛИ &ДанныеОтчета = 2 ИЛИ &ДанныеОтчета = 3
	|			ТОГДА 0
	|		КОГДА &ДанныеОтчета = 4 
	|			ТОГДА СебестоимостьТоваровОстатки.СтоимостьРеглПриход 
	|				+ СебестоимостьТоваровОстатки.ДопРасходыРеглПриход
	|				+ СебестоимостьТоваровОстатки.СтоимостьЗабалансоваяРеглПриход
	|				+ СебестоимостьТоваровОстатки.ТрудозатратыРеглПриход
	|				+ СебестоимостьТоваровОстатки.ПостатейныеПостоянныеРеглПриход
	|				+ СебестоимостьТоваровОстатки.ПостатейныеПеременныеРеглПриход
	|				- СебестоимостьТоваровОстатки.ПостояннаяРазницаПриход
	|				- СебестоимостьТоваровОстатки.ВременнаяРазницаПриход
	|		ИНАЧЕ
	|			0
	|	КОНЕЦ КАК НалоговыйУчетПриход,
	|	ВЫБОР 
	|		КОГДА &ДанныеОтчета = 1 ИЛИ &ДанныеОтчета = 2 ИЛИ &ДанныеОтчета = 3
	|			ТОГДА 0
	|		КОГДА &ДанныеОтчета = 4 
	|			ТОГДА СебестоимостьТоваровОстатки.СтоимостьРеглРасход 
	|				+ СебестоимостьТоваровОстатки.ДопРасходыРеглРасход
	|				+ СебестоимостьТоваровОстатки.СтоимостьЗабалансоваяРеглРасход
	|				+ СебестоимостьТоваровОстатки.ТрудозатратыРеглРасход
	|				+ СебестоимостьТоваровОстатки.ПостатейныеПостоянныеРеглРасход
	|				+ СебестоимостьТоваровОстатки.ПостатейныеПеременныеРеглРасход
	|				- СебестоимостьТоваровОстатки.ПостояннаяРазницаРасход
	|				- СебестоимостьТоваровОстатки.ВременнаяРазницаРасход
	|		ИНАЧЕ
	|			0
	|	КОНЕЦ КАК НалоговыйУчетРасход,
	|	ВЫБОР 
	|		КОГДА &ДанныеОтчета = 1 ИЛИ &ДанныеОтчета = 2 ИЛИ &ДанныеОтчета = 3
	|			ТОГДА 0
	|		КОГДА &ДанныеОтчета = 4 
	|			ТОГДА СебестоимостьТоваровОстатки.СтоимостьРеглКонечныйОстаток 
	|				+ СебестоимостьТоваровОстатки.ДопРасходыРеглКонечныйОстаток
	|				+ СебестоимостьТоваровОстатки.СтоимостьЗабалансоваяРеглКонечныйОстаток
	|				+ СебестоимостьТоваровОстатки.ТрудозатратыРеглКонечныйОстаток
	|				+ СебестоимостьТоваровОстатки.ПостатейныеПостоянныеРеглКонечныйОстаток
	|				+ СебестоимостьТоваровОстатки.ПостатейныеПеременныеРеглКонечныйОстаток
	|				- СебестоимостьТоваровОстатки.ПостояннаяРазницаКонечныйОстаток
	|				- СебестоимостьТоваровОстатки.ВременнаяРазницаКонечныйОстаток
	|		ИНАЧЕ
	|			0
	|	КОНЕЦ КАК НалоговыйУчетКонечныйОстаток,
	|
	|	// Показатель ""Постоянная разница""
	|	ВЫБОР 
	|		КОГДА &ДанныеОтчета = 1 ИЛИ &ДанныеОтчета = 2 ИЛИ &ДанныеОтчета = 3
	|			ТОГДА 0
	|		КОГДА &ДанныеОтчета = 4 
	|			ТОГДА СебестоимостьТоваровОстатки.ПостояннаяРазницаНачальныйОстаток
	|		ИНАЧЕ
	|			0
	|	КОНЕЦ КАК ПостояннаяРазницаНачальныйОстаток,
	|	ВЫБОР 
	|		КОГДА &ДанныеОтчета = 1 ИЛИ &ДанныеОтчета = 2 ИЛИ &ДанныеОтчета = 3
	|			ТОГДА 0
	|		КОГДА &ДанныеОтчета = 4 
	|			ТОГДА СебестоимостьТоваровОстатки.ПостояннаяРазницаПриход
	|		ИНАЧЕ
	|			0
	|	КОНЕЦ КАК ПостояннаяРазницаПриход,
	|	ВЫБОР 
	|		КОГДА &ДанныеОтчета = 1 ИЛИ &ДанныеОтчета = 2 ИЛИ &ДанныеОтчета = 3
	|			ТОГДА 0
	|		КОГДА &ДанныеОтчета = 4 
	|			ТОГДА СебестоимостьТоваровОстатки.ПостояннаяРазницаРасход
	|		ИНАЧЕ
	|			0
	|	КОНЕЦ КАК ПостояннаяРазницаРасход,
	|	ВЫБОР 
	|		КОГДА &ДанныеОтчета = 1 ИЛИ &ДанныеОтчета = 2 ИЛИ &ДанныеОтчета = 3
	|			ТОГДА 0
	|		КОГДА &ДанныеОтчета = 4 
	|			ТОГДА СебестоимостьТоваровОстатки.ПостояннаяРазницаКонечныйОстаток
	|		ИНАЧЕ
	|			0
	|	КОНЕЦ	КАК ПостояннаяРазницаКонечныйОстаток,
	|
	|	// Показатель ""Временная разница""
	|	ВЫБОР 
	|		КОГДА &ДанныеОтчета = 1 ИЛИ &ДанныеОтчета = 2 ИЛИ &ДанныеОтчета = 3
	|			ТОГДА 0
	|		КОГДА &ДанныеОтчета = 4 
	|			ТОГДА СебестоимостьТоваровОстатки.ВременнаяРазницаНачальныйОстаток
	|		ИНАЧЕ
	|			0
	|	КОНЕЦ КАК ВременнаяРазницаНачальныйОстаток,
	|	ВЫБОР 
	|		КОГДА &ДанныеОтчета = 1 ИЛИ &ДанныеОтчета = 2 ИЛИ &ДанныеОтчета = 3
	|			ТОГДА 0
	|		КОГДА &ДанныеОтчета = 4 
	|			ТОГДА СебестоимостьТоваровОстатки.ВременнаяРазницаПриход
	|		ИНАЧЕ
	|			0
	|	КОНЕЦ КАК ВременнаяРазницаПриход,
	|	ВЫБОР 
	|		КОГДА &ДанныеОтчета = 1 ИЛИ &ДанныеОтчета = 2 ИЛИ &ДанныеОтчета = 3
	|			ТОГДА 0
	|		КОГДА &ДанныеОтчета = 4 
	|			ТОГДА СебестоимостьТоваровОстатки.ВременнаяРазницаРасход
	|		ИНАЧЕ
	|			0
	|	КОНЕЦ КАК ВременнаяРазницаРасход,
	|	ВЫБОР 
	|		КОГДА &ДанныеОтчета = 1 ИЛИ &ДанныеОтчета = 2 ИЛИ &ДанныеОтчета = 3
	|			ТОГДА 0
	|		КОГДА &ДанныеОтчета = 4 
	|			ТОГДА СебестоимостьТоваровОстатки.ВременнаяРазницаКонечныйОстаток
	|		ИНАЧЕ
	|			0
	|	КОНЕЦ	КАК ВременнаяРазницаКонечныйОстаток
	|	
	|{ВЫБРАТЬ
	|	ПериодДень,
	|	ПериодНеделя,
	|	ПериодДекада,
	|	ПериодМесяц,
	|	ПериодКвартал,
	|	ПериодПолугодие,
	|	ПериодГод,
	|	АналитикаУчетаНоменклатуры.*,
	|	Номенклатура.*,
	|	ЕдиницаХранения.*,
	|	ЕдиницаДляОтчетов.*,
	|	КоэффициентЕдиницыДляОтчетов,
	|	Характеристика.*,
	|	Серия.*,
	|	Склад.*,
	|	Назначение.*,
	|	НаправлениеДеятельности.*,
	|	ВидЗапасов.*,
	|	ГруппаФинансовогоУчета.*,
	|	Организация.*,
	|	РазделУчета.*,
	|	КоличествоНачальныйОстаток,
	|	КоличествоПриход,
	|	КоличествоРасход,
	|	КоличествоКонечныйОстаток,
	|	ВесНачальныйОстаток,
	|	ВесПриход,
	|	ВесРасход,
	|	ВесКонечныйОстаток,
	|	ОбъемНачальныйОстаток,
	|	ОбъемПриход,
	|	ОбъемРасход,
	|	ОбъемКонечныйОстаток,
	|	СтоимостьПоступленияНачальныйОстаток,
	|	СтоимостьПоступленияПриход,
	|	СтоимостьПоступленияРасход,
	|	СтоимостьПоступленияКонечныйОстаток,
	|	ДопРасходыНачальныйОстаток,
	|	ДопРасходыПриход,
	|	ДопРасходыРасход,
	|	ДопРасходыКонечныйОстаток,
	|	ТрудозатратыНачальныйОстаток,
	|	ТрудозатратыПриход,
	|	ТрудозатратыРасход,
	|	ТрудозатратыКонечныйОстаток,
	|	ПостатейныеПостоянныеНачальныйОстаток,
	|	ПостатейныеПостоянныеПриход,
	|	ПостатейныеПостоянныеРасход,
	|	ПостатейныеПостоянныеКонечныйОстаток,
	|	ПостатейныеПеременныеНачальныйОстаток,
	|	ПостатейныеПеременныеПриход,
	|	ПостатейныеПеременныеРасход,
	|	ПостатейныеПеременныеКонечныйОстаток,
	|	СебестоимостьНачальныйОстаток,
	|	СебестоимостьПриход,
	|	СебестоимостьРасход,
	|	СебестоимостьКонечныйОстаток,
	|	НалоговыйУчетНачальныйОстаток,
	|	НалоговыйУчетПриход,
	|	НалоговыйУчетРасход,
	|	НалоговыйУчетКонечныйОстаток,
	|	ПостояннаяРазницаНачальныйОстаток,
	|	ПостояннаяРазницаПриход,
	|	ПостояннаяРазницаРасход,
	|	ПостояннаяРазницаКонечныйОстаток,
	|	ВременнаяРазницаНачальныйОстаток,
	|	ВременнаяРазницаПриход,
	|	ВременнаяРазницаРасход,
	|	ВременнаяРазницаКонечныйОстаток
	|	}
	|ИЗ
	|	РегистрНакопления.СебестоимостьТоваров.ОстаткиИОбороты(
	|		{&НачалоПериода}, 
	|		{&КонецПериода}, 
	|		Авто, , 
	|		{(АналитикаУчетаНоменклатуры.Номенклатура).* КАК Номенклатура, 
	|		 (АналитикаУчетаНоменклатуры.Номенклатура.ЕдиницаИзмерения).* КАК ЕдиницаИзмерения,
	|		 (АналитикаУчетаНоменклатуры.Номенклатура.ЕдиницаДляОтчетов).* КАК ЕдиницаДляОтчетов,
	|		 (АналитикаУчетаНоменклатуры.Характеристика).* КАК Характеристика, 
	|		 (АналитикаУчетаНоменклатуры.Серия).* КАК Серия, 
	|		 (АналитикаУчетаНоменклатуры.Склад).* КАК Склад,
	|		 (АналитикаУчетаНоменклатуры.Назначение).* КАК Назначение,
	|		 (АналитикаУчетаНоменклатуры.Назначение.НаправлениеДеятельности).* КАК НаправлениеДеятельности,
	|		 (Организация).* КАК Организация,
	|		 (ВидЗапасов).* КАК ВидЗапасов
	|		}
	|	) КАК СебестоимостьТоваровОстатки
	|	{ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.АналитикаУчетаНоменклатуры КАК АналитикаНоменклатуры
	|		ПО СебестоимостьТоваровОстатки.АналитикаУчетаНоменклатуры = АналитикаНоменклатуры.КлючАналитики
	|	}
	|	{ЛЕВОЕ СОЕДИНЕНИЕ Справочник.КлючиАналитикиУчетаПартий КАК АналитикаПартий
	|		ПО АналитикаПартий.Ссылка = СебестоимостьТоваровОстатки.АналитикаУчетаПартий
	|	}
	|
	|{ГДЕ
	|	((АналитикаНоменклатуры.Номенклатура, АналитикаНоменклатуры.Характеристика) В
	|			(ВЫБРАТЬ
	|				ОтборПоСегментуНоменклатуры.Номенклатура,
	|				ОтборПоСегментуНоменклатуры.Характеристика
	|			ИЗ
	|				ОтборПоСегментуНоменклатуры
	|			ГДЕ
	|				ОтборПоСегментуНоменклатуры.ИспользуетсяОтборПоСегментуНоменклатуры = &ИспользуетсяОтборПоСегментуНоменклатуры)),
	|	НАЧАЛОПЕРИОДА(СебестоимостьТоваровОстатки.ПериодДень,      ДЕНЬ)      КАК ПериодДень,
	|	НАЧАЛОПЕРИОДА(СебестоимостьТоваровОстатки.ПериодНеделя,    НЕДЕЛЯ)    КАК ПериодНеделя,
	|	НАЧАЛОПЕРИОДА(СебестоимостьТоваровОстатки.ПериодДекада,    ДЕКАДА)    КАК ПериодДекада,
	|	НАЧАЛОПЕРИОДА(СебестоимостьТоваровОстатки.ПериодМесяц,     МЕСЯЦ)     КАК ПериодМесяц,
	|	НАЧАЛОПЕРИОДА(СебестоимостьТоваровОстатки.ПериодКвартал,   КВАРТАЛ)   КАК ПериодКвартал,
	|	НАЧАЛОПЕРИОДА(СебестоимостьТоваровОстатки.ПериодПолугодие, ПОЛУГОДИЕ) КАК ПериодПолугодие,
	|	НАЧАЛОПЕРИОДА(СебестоимостьТоваровОстатки.ПериодГод,       ГОД)       КАК ПериодГод,
	|	(ВЫБОР
	|			КОГДА &ФормироватьВидыЗапасовПоГруппамФинансовогоУчета
	|				ТОГДА СебестоимостьТоваровОстатки.ВидЗапасов.ГруппаФинансовогоУчета
	|			ИНАЧЕ АналитикаНоменклатуры.Номенклатура.ГруппаФинансовогоУчета
	|		КОНЕЦ).* КАК ГруппаФинансовогоУчета}";
	
	ТекстЗапроса = СтрЗаменить(
		ТекстЗапроса, 
		"&ТекстЗапросаВесУпаковки", 
		Справочники.УпаковкиЕдиницыИзмерения.ТекстЗапросаВесУпаковки("АналитикаНоменклатуры.Номенклатура.ЕдиницаИзмерения","АналитикаНоменклатуры.Номенклатура"));
		
	ТекстЗапроса = СтрЗаменить(
		ТекстЗапроса, 
		"&ТекстЗапросаОбъемУпаковки", 
		Справочники.УпаковкиЕдиницыИзмерения.ТекстЗапросаОбъемУпаковки("АналитикаНоменклатуры.Номенклатура.ЕдиницаИзмерения","АналитикаНоменклатуры.Номенклатура"));
	
	Возврат ТекстЗапроса;
КонецФункции

#КонецОбласти

#Область ОборотнаяАналитика

Функция ТекстЗапросаЗакупкиОбороты()
	ТекстЗапроса = "
	|////////////////////////////////////////////////////////////////////////////////
	|ВЫБРАТЬ РАЗРЕШЕННЫЕ
	|	""ЗакупкиОбороты"" КАК НаборДанных,
	|
	|	// Аналитика периодов
	|	НАЧАЛОПЕРИОДА(ЗакупкиОбороты.ПериодДень,      ДЕНЬ)      КАК ПериодДень,
	|	НАЧАЛОПЕРИОДА(ЗакупкиОбороты.ПериодНеделя,    НЕДЕЛЯ)    КАК ПериодНеделя,
	|	НАЧАЛОПЕРИОДА(ЗакупкиОбороты.ПериодДекада,    ДЕКАДА)    КАК ПериодДекада,
	|	НАЧАЛОПЕРИОДА(ЗакупкиОбороты.ПериодМесяц,     МЕСЯЦ)     КАК ПериодМесяц,
	|	НАЧАЛОПЕРИОДА(ЗакупкиОбороты.ПериодКвартал,   КВАРТАЛ)   КАК ПериодКвартал,
	|	НАЧАЛОПЕРИОДА(ЗакупкиОбороты.ПериодПолугодие, ПОЛУГОДИЕ) КАК ПериодПолугодие,
	|	НАЧАЛОПЕРИОДА(ЗакупкиОбороты.ПериодГод,       ГОД)       КАК ПериодГод,
	|	
	|	// Общая аналитика
	|	ЗакупкиОбороты.АналитикаУчетаНоменклатуры            КАК АналитикаУчетаНоменклатуры,
	|	АналитикаНоменклатуры.Номенклатура                   КАК Номенклатура,
	|	АналитикаНоменклатуры.Номенклатура.ЕдиницаИзмерения  КАК ЕдиницаХранения,
	|	АналитикаНоменклатуры.Номенклатура.ЕдиницаДляОтчетов КАК ЕдиницаДляОтчетов,
	|	АналитикаНоменклатуры.Номенклатура.КоэффициентЕдиницыДляОтчетов КАК КоэффициентЕдиницыДляОтчетов,
	|	АналитикаНоменклатуры.Характеристика                 КАК Характеристика,
	|	АналитикаНоменклатуры.Серия                          КАК Серия,
	|	АналитикаНоменклатуры.Склад                          КАК Склад,
	|	АналитикаНоменклатуры.Назначение                     КАК Назначение,
	|	АналитикаНоменклатуры.Назначение.НаправлениеДеятельности КАК НаправлениеДеятельности,
	|	
	|	ЗакупкиОбороты.ВидЗапасов               КАК ВидЗапасов,
	|	ЗакупкиОбороты.Партнер                  КАК Партнер,
	|	ЗакупкиОбороты.Менеджер                 КАК Менеджер,
	|	ЗакупкиОбороты.Подразделение            КАК Подразделение,
	|	НЕОПРЕДЕЛЕНО                            КАК Сделка,
	|	
	|	ВЫБОР 
	|		КОГДА &ФормироватьВидыЗапасовПоГруппамФинансовогоУчета 
	|			ТОГДА ЗакупкиОбороты.ВидЗапасов.ГруппаФинансовогоУчета
	|			ИНАЧЕ АналитикаНоменклатуры.Номенклатура.ГруппаФинансовогоУчета
	|	КОНЕЦ КАК ГруппаФинансовогоУчета,
	|	
	|	ЗакупкиОбороты.Организация КАК Организация,
	|	
	|	// Аналитика оборотов
	|	NULL                                                                 КАК СтатьяДоходов,
	|	ЗНАЧЕНИЕ(ПланВидовХарактеристик.СтатьиРасходов.СебестоимостьПродаж)  КАК СтатьяРасходов,
	|	ЗНАЧЕНИЕ(ПланВидовХарактеристик.СтатьиРасходов.СебестоимостьПродаж)  КАК СтатьяДоходовРасходов,
	|	NULL                                                                 КАК АналитикаДоходов,
	|	NULL                                                                 КАК АналитикаРасходов,
	|	NULL                                                                 КАК АналитикаДоходовРасходов,
	|	ЗакупкиОбороты.Договор                                               КАК Договор,
	|	ЗакупкиОбороты.Заказ                                                 КАК Заказ,
	|	ЗакупкиОбороты.Контрагент                                            КАК Контрагент,
	|	ЗакупкиОбороты.Соглашение                                            КАК Соглашение,
	|	ЗакупкиОбороты.ТипЗапасов                                            КАК ТипЗапасов,
	|	ВЫБОР 
	|		КОГДА НастройкиХозопераций.Ссылка = ЗНАЧЕНИЕ(Справочник.НастройкиХозяйственныхОпераций.ЗакупкаУДругойОрганизации)
	|			ТОГДА ЗНАЧЕНИЕ(Справочник.НастройкиХозяйственныхОпераций.РеализацияТоваровВДругуюОрганизацию)
	|		ИНАЧЕ НастройкиХозопераций.Ссылка
	|	КОНЕЦ КАК ХозяйственнаяОперацияСправочник,
	|	ВЫБОР 
	|		КОГДА НастройкиХозопераций.Приход = ЗНАЧЕНИЕ(Перечисление.ТипыДанныхУчета.Номенклатура)
	|			ТОГДА ИСТИНА
	|			ИНАЧЕ ЛОЖЬ
	|	КОНЕЦ                                                                КАК ХозяйственнаяОперацияПрихода,
	|	ВЫБОР 
	|		КОГДА НастройкиХозопераций.Расход = ЗНАЧЕНИЕ(Перечисление.ТипыДанныхУчета.Номенклатура)
	|			ТОГДА ИСТИНА
	|			ИНАЧЕ ЛОЖЬ
	|	КОНЕЦ                                                                КАК ХозяйственнаяОперацияРасхода,
	|	
	|	// Показатель ""Количество""
	|	0 КАК Об_КоличествоНачальныйОстаток,
	|	ВЫБОР 
	|		КОГДА &ЕдиницыКоличества = 0 
	|			ТОГДА 1
	|		КОГДА &ЕдиницыКоличества = 1 
	|			ТОГДА
	|				ВЫБОР 
	|					КОГДА АналитикаНоменклатуры.Номенклатура.КоэффициентЕдиницыДляОтчетов <> 0 
	|						ТОГДА 1 / АналитикаНоменклатуры.Номенклатура.КоэффициентЕдиницыДляОтчетов
	|						ИНАЧЕ 0
	|				КОНЕЦ
	|	КОНЕЦ * ВЫБОР 
	|		КОГДА НастройкиХозопераций.Приход = ЗНАЧЕНИЕ(Перечисление.ТипыДанныхУчета.Номенклатура)
	|			ТОГДА 1
	|			ИНАЧЕ 0
	|	КОНЕЦ * ЗакупкиОбороты.КоличествоОборот КАК Об_КоличествоПриход,
	|	ВЫБОР 
	|		КОГДА &ЕдиницыКоличества = 0 
	|			ТОГДА 1
	|		КОГДА &ЕдиницыКоличества = 1 
	|			ТОГДА
	|				ВЫБОР 
	|					КОГДА АналитикаНоменклатуры.Номенклатура.КоэффициентЕдиницыДляОтчетов <> 0 
	|						ТОГДА 1 / АналитикаНоменклатуры.Номенклатура.КоэффициентЕдиницыДляОтчетов
	|						ИНАЧЕ 0
	|				КОНЕЦ
	|	КОНЕЦ * ВЫБОР 
	|		КОГДА НастройкиХозопераций.Расход = ЗНАЧЕНИЕ(Перечисление.ТипыДанныхУчета.Номенклатура)
	|			ТОГДА 1
	|			ИНАЧЕ 0
	|	КОНЕЦ * ЗакупкиОбороты.КоличествоОборот КАК Об_КоличествоРасход,
	|	0 КАК Об_КоличествоКонечныйОстаток,
	|	
	|	// Показатели ""Вес""
	|	0 КАК Об_ВесНачальныйОстаток,
	|	ВЫБОР 
	|		КОГДА НастройкиХозопераций.Приход = ЗНАЧЕНИЕ(Перечисление.ТипыДанныхУчета.Номенклатура)
	|			ТОГДА 1
	|			ИНАЧЕ 0
	|	КОНЕЦ * ЗакупкиОбороты.КоличествоОборот * &ТекстЗапросаВесУпаковки КАК Об_ВесПриход,
	|	ВЫБОР 
	|		КОГДА НастройкиХозопераций.Расход = ЗНАЧЕНИЕ(Перечисление.ТипыДанныхУчета.Номенклатура)
	|			ТОГДА 1
	|			ИНАЧЕ 0
	|	КОНЕЦ * ЗакупкиОбороты.КоличествоОборот * &ТекстЗапросаВесУпаковки КАК Об_ВесРасход,
	|	0 КАК Об_ВесКонечныйОстаток,
	|	
	|	// Показатель ""Объем""
	|	0 КАК Об_ОбъемНачальныйОстаток,
	|	ВЫБОР 
	|		КОГДА НастройкиХозопераций.Приход = ЗНАЧЕНИЕ(Перечисление.ТипыДанныхУчета.Номенклатура)
	|			ТОГДА 1
	|			ИНАЧЕ 0
	|	КОНЕЦ * ЗакупкиОбороты.КоличествоОборот * &ТекстЗапросаОбъемУпаковки КАК Об_ОбъемПриход,
	|	ВЫБОР 
	|		КОГДА НастройкиХозопераций.Расход = ЗНАЧЕНИЕ(Перечисление.ТипыДанныхУчета.Номенклатура)
	|			ТОГДА 1
	|			ИНАЧЕ 0
	|	КОНЕЦ * ЗакупкиОбороты.КоличествоОборот * &ТекстЗапросаОбъемУпаковки КАК Об_ОбъемРасход,
	|	0 КАК Об_ОбъемКонечныйОстаток,
	|	
	|	// Показатель ""Стоимость""
	|	0 КАК Об_СтоимостьПоступленияНачальныйОстаток,
	|	ВЫБОР 
	|		КОГДА ЗакупкиОбороты.ХозяйственнаяОперация = ЗНАЧЕНИЕ(Перечисление.ХозяйственныеОперации.ПриемНаКомиссию)
	|				И ЗакупкиОбороты.Партнер = ЗНАЧЕНИЕ(Справочник.Партнеры.НашеПредприятие)
	|		ТОГДА 0
	|		ИНАЧЕ 1
	|	КОНЕЦ * ВЫБОР 
	|		КОГДА НастройкиХозопераций.Приход = ЗНАЧЕНИЕ(Перечисление.ТипыДанныхУчета.Номенклатура)
	|			ТОГДА 1
	|			ИНАЧЕ 0
	|	КОНЕЦ * ВЫБОР 
	|		КОГДА &ДанныеОтчета = 1 
	|			ТОГДА ЗакупкиОбороты.СтоимостьОборот
	|		КОГДА &ДанныеОтчета = 2 ИЛИ &ДанныеОтчета = 3
	|			ТОГДА ЗакупкиОбороты.СтоимостьБезНДСОборот
	|		КОГДА &ДанныеОтчета = 4 
	|			ТОГДА ЗакупкиОбороты.СтоимостьРеглОборот
	|		ИНАЧЕ
	|			ЗакупкиОбороты.СтоимостьБезНДСОборот
	|	КОНЕЦ КАК Об_СтоимостьПоступленияПриход,
	|	ВЫБОР 
	|		КОГДА ЗакупкиОбороты.ХозяйственнаяОперация = ЗНАЧЕНИЕ(Перечисление.ХозяйственныеОперации.ПриемНаКомиссию)
	|				И ЗакупкиОбороты.Партнер = ЗНАЧЕНИЕ(Справочник.Партнеры.НашеПредприятие)
	|		ТОГДА 0
	|		ИНАЧЕ 1
	|	КОНЕЦ * ВЫБОР 
	|		КОГДА НастройкиХозопераций.Расход = ЗНАЧЕНИЕ(Перечисление.ТипыДанныхУчета.Номенклатура)
	|			ТОГДА 1
	|			ИНАЧЕ 0
	|	КОНЕЦ * ВЫБОР 
	|		КОГДА &ДанныеОтчета = 1 
	|			ТОГДА ЗакупкиОбороты.СтоимостьОборот
	|		КОГДА &ДанныеОтчета = 2 ИЛИ &ДанныеОтчета = 3
	|			ТОГДА ЗакупкиОбороты.СтоимостьБезНДСОборот
	|		КОГДА &ДанныеОтчета = 4 
	|			ТОГДА ЗакупкиОбороты.СтоимостьРеглОборот
	|		ИНАЧЕ
	|			ЗакупкиОбороты.СтоимостьБезНДСОборот
	|	КОНЕЦ КАК Об_СтоимостьПоступленияРасход,
	|	0 КАК Об_СтоимостьПоступленияКонечныйОстаток,
	|	
	|	// Показатель ""Доп. расходы""
	|	0 КАК Об_ДопРасходыНачальныйОстаток,
	|	ВЫБОР 
	|		КОГДА ЗакупкиОбороты.ХозяйственнаяОперация = ЗНАЧЕНИЕ(Перечисление.ХозяйственныеОперации.ПриемНаКомиссию)
	|				И ЗакупкиОбороты.Партнер = ЗНАЧЕНИЕ(Справочник.Партнеры.НашеПредприятие)
	|		ТОГДА 0
	|		ИНАЧЕ 1
	|	КОНЕЦ * ВЫБОР 
	|		КОГДА НастройкиХозопераций.Приход = ЗНАЧЕНИЕ(Перечисление.ТипыДанныхУчета.Номенклатура)
	|			ТОГДА 1
	|			ИНАЧЕ 0
	|	КОНЕЦ * ВЫБОР 
	|		КОГДА &ДанныеОтчета = 1 
	|			ТОГДА ЗакупкиОбороты.СуммаДопРасходовОборот
	|		КОГДА &ДанныеОтчета = 2 
	|			ТОГДА ЗакупкиОбороты.СуммаДопРасходовБезНДСОборот
	|		КОГДА &ДанныеОтчета = 3 
	|			ТОГДА 0
	|	КОНЕЦ КАК Об_ДопРасходыПриход,
	|	ВЫБОР 
	|		КОГДА ЗакупкиОбороты.ХозяйственнаяОперация = ЗНАЧЕНИЕ(Перечисление.ХозяйственныеОперации.ПриемНаКомиссию)
	|				И ЗакупкиОбороты.Партнер = ЗНАЧЕНИЕ(Справочник.Партнеры.НашеПредприятие)
	|		ТОГДА 0
	|		ИНАЧЕ 1
	|	КОНЕЦ * ВЫБОР 
	|		КОГДА НастройкиХозопераций.Расход = ЗНАЧЕНИЕ(Перечисление.ТипыДанныхУчета.Номенклатура)
	|			ТОГДА 1
	|			ИНАЧЕ 0
	|	КОНЕЦ * ВЫБОР 
	|		КОГДА &ДанныеОтчета = 1 
	|			ТОГДА ЗакупкиОбороты.СуммаДопРасходовОборот
	|		КОГДА &ДанныеОтчета = 2 
	|			ТОГДА ЗакупкиОбороты.СуммаДопРасходовБезНДСОборот
	|		КОГДА &ДанныеОтчета = 3 
	|			ТОГДА 0
	|	КОНЕЦ КАК Об_ДопРасходыРасход,
	|	0 КАК Об_ДопРасходыКонечныйОстаток,
	|
	|	// Показатель ""Трудозатраты""
	|	0 КАК Об_ТрудозатратыНачальныйОстаток,
	|	0 КАК Об_ТрудозатратыПриход,
	|	0 КАК Об_ТрудозатратыРасход,
	|	0 КАК Об_ТрудозатратыКонечныйОстаток,
	|	
	|	// Показатель ""ПостатейныеПостоянные""
	|	0 КАК Об_ПостатейныеПостоянныеНачальныйОстаток,
	|	0 КАК Об_ПостатейныеПостоянныеПриход,
	|	0 КАК Об_ПостатейныеПостоянныеРасход,
	|	0 КАК Об_ПостатейныеПостоянныеКонечныйОстаток,
	|
	|	// Показатель ""ПостатейныеПеременные""
	|	0 КАК Об_ПостатейныеПеременныеНачальныйОстаток,
	|	0 КАК Об_ПостатейныеПеременныеПриход,
	|	0 КАК Об_ПостатейныеПеременныеРасход,
	|	0 КАК Об_ПостатейныеПеременныеКонечныйОстаток,
	|	
	|	// Показатель ""Себестоимость""
	|	0 КАК Об_СебестоимостьНачальныйОстаток,
	|	ВЫБОР 
	|		КОГДА ЗакупкиОбороты.ХозяйственнаяОперация = ЗНАЧЕНИЕ(Перечисление.ХозяйственныеОперации.ПриемНаКомиссию)
	|				И ЗакупкиОбороты.Партнер = ЗНАЧЕНИЕ(Справочник.Партнеры.НашеПредприятие)
	|		ТОГДА 0
	|		ИНАЧЕ 1
	|	КОНЕЦ * ВЫБОР 
	|		КОГДА НастройкиХозопераций.Приход = ЗНАЧЕНИЕ(Перечисление.ТипыДанныхУчета.Номенклатура)
	|			ТОГДА 1
	|			ИНАЧЕ 0
	|	КОНЕЦ * ВЫБОР 
	|		КОГДА &ДанныеОтчета = 1 
	|			ТОГДА ЗакупкиОбороты.СтоимостьОборот + ЗакупкиОбороты.СуммаДопРасходовОборот
	|		КОГДА &ДанныеОтчета = 2 ИЛИ &ДанныеОтчета = 3
	|			ТОГДА ЗакупкиОбороты.СтоимостьБезНДСОборот + ЗакупкиОбороты.СуммаДопРасходовБезНДСОборот
	|		КОГДА &ДанныеОтчета = 4 
	|			ТОГДА ЗакупкиОбороты.СтоимостьРеглОборот
	|		ИНАЧЕ
	|			ЗакупкиОбороты.СтоимостьБезНДСОборот
	|	КОНЕЦ КАК Об_СебестоимостьПриход,
	|	ВЫБОР 
	|		КОГДА ЗакупкиОбороты.ХозяйственнаяОперация = ЗНАЧЕНИЕ(Перечисление.ХозяйственныеОперации.ПриемНаКомиссию)
	|				И ЗакупкиОбороты.Партнер = ЗНАЧЕНИЕ(Справочник.Партнеры.НашеПредприятие)
	|		ТОГДА 0
	|		ИНАЧЕ 1
	|	КОНЕЦ * ВЫБОР 
	|		КОГДА НастройкиХозопераций.Расход = ЗНАЧЕНИЕ(Перечисление.ТипыДанныхУчета.Номенклатура)
	|			ТОГДА 1
	|			ИНАЧЕ 0
	|	КОНЕЦ * ВЫБОР 
	|		КОГДА &ДанныеОтчета = 1 
	|			ТОГДА ЗакупкиОбороты.СтоимостьОборот + ЗакупкиОбороты.СуммаДопРасходовОборот
	|		КОГДА &ДанныеОтчета = 2 ИЛИ &ДанныеОтчета = 3
	|			ТОГДА ЗакупкиОбороты.СтоимостьБезНДСОборот + ЗакупкиОбороты.СуммаДопРасходовБезНДСОборот
	|		КОГДА &ДанныеОтчета = 4 
	|			ТОГДА ЗакупкиОбороты.СтоимостьРеглОборот
	|		ИНАЧЕ
	|			ЗакупкиОбороты.СтоимостьБезНДСОборот
	|	КОНЕЦ КАК Об_СебестоимостьРасход,
	|	0 КАК Об_СебестоимостьКонечныйОстаток,
	|
	|	// Показатель ""Налоговый учет""
	|	0 КАК Об_НалоговыйУчетНачальныйОстаток,
	|	0 КАК Об_НалоговыйУчетПриход,
	|	0 КАК Об_НалоговыйУчетРасход,
	|	0 КАК Об_НалоговыйУчетКонечныйОстаток,
	|
	|	// Показатель ""Постоянная разница""
	|	0 КАК Об_ПостояннаяРазницаНачальныйОстаток,
	|	0 КАК Об_ПостояннаяРазницаПриход,
	|	0 КАК Об_ПостояннаяРазницаРасход,
	|	0 КАК Об_ПостояннаяРазницаКонечныйОстаток,
	|
	|	// Показатель ""Временная разница""
	|	0 КАК Об_ВременнаяРазницаНачальныйОстаток,
	|	0 КАК Об_ВременнаяРазницаПриход,
	|	0 КАК Об_ВременнаяРазницаРасход,
	|	0 КАК Об_ВременнаяРазницаКонечныйОстаток
	|	
	|{ВЫБРАТЬ
	|	НаборДанных,
	|	ПериодДень,
	|	ПериодНеделя,
	|	ПериодДекада,
	|	ПериодМесяц,
	|	ПериодКвартал,
	|	ПериодПолугодие,
	|	ПериодГод,
	|	АналитикаУчетаНоменклатуры.*,
	|	Номенклатура.*,
	|	ЕдиницаХранения.*,
	|	ЕдиницаДляОтчетов.*,
	|	КоэффициентЕдиницыДляОтчетов,
	|	Характеристика.*,
	|	Серия.*,
	|	Склад.*,
	|	Назначение.*,
	|	НаправлениеДеятельности.*,
	|	ВидЗапасов.*,
	|	Партнер.*,
	|	Менеджер.*,
	|	Подразделение.*,
	|	Сделка.*,
	|	ГруппаФинансовогоУчета.*,
	|	Организация.*,
	|	СтатьяДоходов.*,
	|	СтатьяРасходов.*,
	|	СтатьяДоходовРасходов.*,
	|	АналитикаДоходов.*,
	|	АналитикаРасходов.*,
	|	АналитикаДоходовРасходов.*,
	|	Договор,
	|	Заказ,
	|	Контрагент,
	|	Соглашение,
	|	ТипЗапасов,
	|	ХозяйственнаяОперацияСправочник.*,
	|	ХозяйственнаяОперацияПрихода,
	|	ХозяйственнаяОперацияРасхода,
	|	Об_КоличествоНачальныйОстаток,
	|	Об_КоличествоПриход,
	|	Об_КоличествоРасход,
	|	Об_КоличествоКонечныйОстаток,
	|	Об_ВесНачальныйОстаток,
	|	Об_ВесПриход,
	|	Об_ВесРасход,
	|	Об_ВесКонечныйОстаток,
	|	Об_ОбъемНачальныйОстаток,
	|	Об_ОбъемПриход,
	|	Об_ОбъемРасход,
	|	Об_ОбъемКонечныйОстаток,
	|	Об_СтоимостьПоступленияНачальныйОстаток,
	|	Об_СтоимостьПоступленияПриход,
	|	Об_СтоимостьПоступленияРасход,
	|	Об_СтоимостьПоступленияКонечныйОстаток,
	|	Об_ДопРасходыНачальныйОстаток,
	|	Об_ДопРасходыПриход,
	|	Об_ДопРасходыРасход,
	|	Об_ДопРасходыКонечныйОстаток,
	|	Об_ТрудозатратыНачальныйОстаток,
	|	Об_ТрудозатратыПриход,
	|	Об_ТрудозатратыРасход,
	|	Об_ТрудозатратыКонечныйОстаток,
	|	Об_ПостатейныеПостоянныеНачальныйОстаток,
	|	Об_ПостатейныеПостоянныеПриход,
	|	Об_ПостатейныеПостоянныеРасход,
	|	Об_ПостатейныеПостоянныеКонечныйОстаток,
	|	Об_ПостатейныеПеременныеНачальныйОстаток,
	|	Об_ПостатейныеПеременныеПриход,
	|	Об_ПостатейныеПеременныеРасход,
	|	Об_ПостатейныеПеременныеКонечныйОстаток,
	|	Об_СебестоимостьНачальныйОстаток,
	|	Об_СебестоимостьПриход,
	|	Об_СебестоимостьРасход,
	|	Об_СебестоимостьКонечныйОстаток,
	|	Об_НалоговыйУчетНачальныйОстаток,
	|	Об_НалоговыйУчетПриход,
	|	Об_НалоговыйУчетРасход,
	|	Об_НалоговыйУчетКонечныйОстаток,
	|	Об_ПостояннаяРазницаНачальныйОстаток,
	|	Об_ПостояннаяРазницаПриход,
	|	Об_ПостояннаяРазницаРасход,
	|	Об_ПостояннаяРазницаКонечныйОстаток,
	|	Об_ВременнаяРазницаНачальныйОстаток,
	|	Об_ВременнаяРазницаПриход,
	|	Об_ВременнаяРазницаРасход,
	|	Об_ВременнаяРазницаКонечныйОстаток
	|	}
	|ПОМЕСТИТЬ ОборотнаяАналитика
	|ИЗ
	|	РегистрНакопления.Закупки.Обороты(
	|		{&НачалоПериода}, 
	|		{&КонецПериода}, 
	|		Авто, 
	|		НЕ АналитикаУчетаНоменклатуры.Номенклатура.ТипНоменклатуры = ЗНАЧЕНИЕ(Перечисление.ТипыНоменклатуры.Услуга)
	|		{(АналитикаУчетаНоменклатуры.Номенклатура).* КАК Номенклатура, 
	|		 (АналитикаУчетаНоменклатуры.Номенклатура.ЕдиницаИзмерения).* КАК ЕдиницаИзмерения,
	|		 (АналитикаУчетаНоменклатуры.Номенклатура.ЕдиницаДляОтчетов).* КАК ЕдиницаДляОтчетов,
	|		 (АналитикаУчетаНоменклатуры.Характеристика).* КАК Характеристика, 
	|		 (АналитикаУчетаНоменклатуры.Серия).* КАК Серия, 
	|		 (АналитикаУчетаНоменклатуры.Склад).* КАК Склад,
	|		 (АналитикаУчетаНоменклатуры.Назначение).* КАК Назначение,
	|		 (АналитикаУчетаНоменклатуры.Назначение.НаправлениеДеятельности).* КАК НаправлениеДеятельности,
	|		 (ВидЗапасов).*,
	|		 (Партнер).* КАК Партнер,
	|		 (Организация).* КАК Организация,
	|		 (Договор).* КАК Договор,
	|		 (Заказ).* КАК Заказ,
	|		 (Контрагент).* КАК Контрагент,
	|		 (Соглашение).* КАК Соглашение,
	|		 (ТипЗапасов).* КАК ТипЗапасов
	|		}
	|	) КАК ЗакупкиОбороты
	|
	|		{ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.АналитикаУчетаНоменклатуры КАК АналитикаНоменклатуры
	|			ПО ЗакупкиОбороты.АналитикаУчетаНоменклатуры = АналитикаНоменклатуры.КлючАналитики
	|		}
	|
	|		ЛЕВОЕ СОЕДИНЕНИЕ Справочник.НастройкиХозяйственныхОпераций КАК НастройкиХозопераций
	|		ПО НастройкиХозопераций.ХозяйственнаяОперация = ЗакупкиОбороты.ХозяйственнаяОперация
	|{ГДЕ
	|	((АналитикаНоменклатуры.Номенклатура, АналитикаНоменклатуры.Характеристика) В
	|			(ВЫБРАТЬ
	|				ОтборПоСегментуНоменклатуры.Номенклатура,
	|				ОтборПоСегментуНоменклатуры.Характеристика
	|			ИЗ
	|				ОтборПоСегментуНоменклатуры
	|			ГДЕ
	|				ОтборПоСегментуНоменклатуры.ИспользуетсяОтборПоСегментуНоменклатуры = &ИспользуетсяОтборПоСегментуНоменклатуры)),
	|	(""ЗакупкиОбороты"") КАК НаборДанных,
	|	НАЧАЛОПЕРИОДА(ЗакупкиОбороты.ПериодДень,      ДЕНЬ)      КАК ПериодДень,
	|	НАЧАЛОПЕРИОДА(ЗакупкиОбороты.ПериодНеделя,    НЕДЕЛЯ)    КАК ПериодНеделя,
	|	НАЧАЛОПЕРИОДА(ЗакупкиОбороты.ПериодДекада,    ДЕКАДА)    КАК ПериодДекада,
	|	НАЧАЛОПЕРИОДА(ЗакупкиОбороты.ПериодМесяц,     МЕСЯЦ)     КАК ПериодМесяц,
	|	НАЧАЛОПЕРИОДА(ЗакупкиОбороты.ПериодКвартал,   КВАРТАЛ)   КАК ПериодКвартал,
	|	НАЧАЛОПЕРИОДА(ЗакупкиОбороты.ПериодПолугодие, ПОЛУГОДИЕ) КАК ПериодПолугодие,
	|	НАЧАЛОПЕРИОДА(ЗакупкиОбороты.ПериодГод,       ГОД)       КАК ПериодГод,
	|	ЗакупкиОбороты.АналитикаУчетаНоменклатуры.*,
	|	(ВЫБОР
	|			КОГДА &ФормироватьВидыЗапасовПоГруппамФинансовогоУчета
	|				ТОГДА ЗакупкиОбороты.ВидЗапасов.ГруппаФинансовогоУчета
	|			ИНАЧЕ АналитикаНоменклатуры.Номенклатура.ГруппаФинансовогоУчета
	|		КОНЕЦ).* КАК ГруппаФинансовогоУчета,
	|	(NULL) КАК СтатьяДоходов,
	|	(ЗНАЧЕНИЕ(ПланВидовХарактеристик.СтатьиРасходов.СебестоимостьПродаж)).* КАК СтатьяРасходов,
	|	(ЗНАЧЕНИЕ(ПланВидовХарактеристик.СтатьиРасходов.СебестоимостьПродаж)).* КАК СтатьяДоходовРасходов,
	|	(ВЫБОР 
	|		КОГДА НастройкиХозопераций.Ссылка = ЗНАЧЕНИЕ(Справочник.НастройкиХозяйственныхОпераций.ЗакупкаУДругойОрганизации)
	|			ТОГДА ЗНАЧЕНИЕ(Справочник.НастройкиХозяйственныхОпераций.РеализацияТоваровВДругуюОрганизацию)
	|		ИНАЧЕ НастройкиХозопераций.Ссылка
	|	КОНЕЦ).* КАК ХозяйственнаяОперацияСправочник,
	|	(ВЫБОР
	|			КОГДА НастройкиХозопераций.Приход = ЗНАЧЕНИЕ(Перечисление.ТипыДанныхУчета.Номенклатура)
	|				ТОГДА ИСТИНА
	|			ИНАЧЕ ЛОЖЬ
	|		КОНЕЦ) КАК ХозяйственнаяОперацияПрихода,
	|	(ВЫБОР
	|			КОГДА НастройкиХозопераций.Расход = ЗНАЧЕНИЕ(Перечисление.ТипыДанныхУчета.Номенклатура)
	|				ТОГДА ИСТИНА
	|			ИНАЧЕ ЛОЖЬ
	|		КОНЕЦ) КАК ХозяйственнаяОперацияРасхода}";
	
	ТекстЗапроса = СтрЗаменить(
		ТекстЗапроса, 
		"&ТекстЗапросаВесУпаковки", 
		Справочники.УпаковкиЕдиницыИзмерения.ТекстЗапросаВесУпаковки("АналитикаНоменклатуры.Номенклатура.ЕдиницаИзмерения", "АналитикаНоменклатуры.Номенклатура"));
		
	ТекстЗапроса = СтрЗаменить(
		ТекстЗапроса, 
		"&ТекстЗапросаОбъемУпаковки", 
		Справочники.УпаковкиЕдиницыИзмерения.ТекстЗапросаОбъемУпаковки("АналитикаНоменклатуры.Номенклатура.ЕдиницаИзмерения", "АналитикаНоменклатуры.Номенклатура"));
	
	Возврат ТекстЗапроса;
КонецФункции

Функция ТекстЗапросаВыручкаИСебестоимостьПродажОбороты()
	ТекстЗапроса = "
	|////////////////////////////////////////////////////////////////////////////////
	|ВЫБРАТЬ РАЗРЕШЕННЫЕ
	|	""ВыручкаИСебестоимостьПродажОбороты"" КАК НаборДанных,
	|	
	|	// Аналитика периодов
	|	НАЧАЛОПЕРИОДА(ВыручкаИСебестоимостьПродажОбороты.ПериодДень,      ДЕНЬ)      КАК ПериодДень,
	|	НАЧАЛОПЕРИОДА(ВыручкаИСебестоимостьПродажОбороты.ПериодНеделя,    НЕДЕЛЯ)    КАК ПериодНеделя,
	|	НАЧАЛОПЕРИОДА(ВыручкаИСебестоимостьПродажОбороты.ПериодДекада,    ДЕКАДА)    КАК ПериодДекада,
	|	НАЧАЛОПЕРИОДА(ВыручкаИСебестоимостьПродажОбороты.ПериодМесяц,     МЕСЯЦ)     КАК ПериодМесяц,
	|	НАЧАЛОПЕРИОДА(ВыручкаИСебестоимостьПродажОбороты.ПериодКвартал,   КВАРТАЛ)   КАК ПериодКвартал,
	|	НАЧАЛОПЕРИОДА(ВыручкаИСебестоимостьПродажОбороты.ПериодПолугодие, ПОЛУГОДИЕ) КАК ПериодПолугодие,
	|	НАЧАЛОПЕРИОДА(ВыручкаИСебестоимостьПродажОбороты.ПериодГод,       ГОД)       КАК ПериодГод,
	|	
	|	// Общая аналитика
	|	ВыручкаИСебестоимостьПродажОбороты.АналитикаУчетаНоменклатуры КАК АналитикаУчетаНоменклатуры,
	|	АналитикаНоменклатуры.Номенклатура                            КАК Номенклатура,
	|	АналитикаНоменклатуры.Номенклатура.ЕдиницаИзмерения           КАК ЕдиницаХранения,
	|	АналитикаНоменклатуры.Номенклатура.ЕдиницаДляОтчетов          КАК ЕдиницаДляОтчетов,
	|	АналитикаНоменклатуры.Номенклатура.КоэффициентЕдиницыДляОтчетов КАК КоэффициентЕдиницыДляОтчетов,
	|	АналитикаНоменклатуры.Характеристика                          КАК Характеристика,
	|	АналитикаНоменклатуры.Серия                                   КАК Серия,
	|	АналитикаНоменклатуры.Склад                                   КАК Склад,
	|	АналитикаНоменклатуры.Назначение                              КАК Назначение,
	|	АналитикаНоменклатуры.Назначение.НаправлениеДеятельности      КАК НаправлениеДеятельности,
	|	
	|	ВыручкаИСебестоимостьПродажОбороты.ВидЗапасов КАК ВидЗапасов,
	|	ЕСТЬNULL(АналитикаПартий.Поставщик, NULL) КАК Партнер,
	|	ЕСТЬNULL(ВЫРАЗИТЬ(ВыручкаИСебестоимостьПродажОбороты.АналитикаФинансовогоУчета КАК Справочник.Пользователи), NULL) КАК Менеджер,
	|	ЕСТЬNULL(ВЫРАЗИТЬ(ВыручкаИСебестоимостьПродажОбороты.АналитикаФинансовогоУчета КАК Справочник.СтруктураПредприятия), NULL) КАК Подразделение,
	|	ЕСТЬNULL(ВЫРАЗИТЬ(ВыручкаИСебестоимостьПродажОбороты.АналитикаФинансовогоУчета КАК Справочник.СделкиСКлиентами), NULL) КАК Сделка,
	|	
	|	ВЫБОР 
	|		КОГДА &ФормироватьВидыЗапасовПоГруппамФинансовогоУчета 
	|			ТОГДА ВыручкаИСебестоимостьПродажОбороты.ВидЗапасов.ГруппаФинансовогоУчета
	|			ИНАЧЕ АналитикаНоменклатуры.Номенклатура.ГруппаФинансовогоУчета
	|	КОНЕЦ КАК ГруппаФинансовогоУчета,
	|	
	|	АналитикаПартнеров.Организация КАК Организация,
	|	
	|	// Аналитика оборотов
	|	ЗНАЧЕНИЕ(ПланВидовХарактеристик.СтатьиДоходов.ВыручкаОтПродаж)    КАК СтатьяДоходов,
	|	NULL                                                              КАК СтатьяРасходов,
	|	ЗНАЧЕНИЕ(ПланВидовХарактеристик.СтатьиДоходов.ВыручкаОтПродаж)    КАК СтатьяДоходовРасходов,
	|	NULL                                                              КАК АналитикаДоходов,
	|	NULL                                                              КАК АналитикаРасходов,
	|	NULL                                                              КАК АналитикаДоходовРасходов,
	|	ВыручкаИСебестоимостьПродажОбороты.Договор                        КАК Договор,
	|	ВыручкаИСебестоимостьПродажОбороты.ЗаказКлиента                   КАК Заказ,
	|	АналитикаПартнеров.Контрагент                                     КАК Контрагент,
	|	ВыручкаИСебестоимостьПродажОбороты.Соглашение                     КАК Соглашение,
	|	ВыручкаИСебестоимостьПродажОбороты.ТипЗапасов                     КАК ТипЗапасов,
	|	НастройкиХозопераций.Ссылка                                       КАК ХозяйственнаяОперацияСправочник,
	|	ВЫБОР 
	|		КОГДА НастройкиХозопераций.Приход = ЗНАЧЕНИЕ(Перечисление.ТипыДанныхУчета.Номенклатура)
	|				ИЛИ (НастройкиХозопераций.ХозяйственнаяОперация = Значение(Перечисление.ХозяйственныеОперации.ОприходованиеПоВозврату))
	|			ТОГДА ИСТИНА
	|			ИНАЧЕ ЛОЖЬ
	|	КОНЕЦ                                                             КАК ХозяйственнаяОперацияПрихода,
	|	ВЫБОР 
	|		КОГДА НастройкиХозопераций.Расход = ЗНАЧЕНИЕ(Перечисление.ТипыДанныхУчета.Номенклатура)
	|				И НЕ (НастройкиХозопераций.ХозяйственнаяОперация = Значение(Перечисление.ХозяйственныеОперации.ОприходованиеПоВозврату))
	|			ТОГДА ИСТИНА
	|			ИНАЧЕ ЛОЖЬ
	|	КОНЕЦ                                                             КАК ХозяйственнаяОперацияРасхода,
	|	
	|	// Показатель ""Количество""
	|	0 КАК Об_КоличествоНачальныйОстаток,
	|	ВЫБОР 
	|		КОГДА НастройкиХозопераций.Приход = ЗНАЧЕНИЕ(Перечисление.ТипыДанныхУчета.Номенклатура)
	|				И ВыручкаИСебестоимостьПродажОбороты.КоличествоОборот > 0
	|			ТОГДА 1
	|		КОГДА НастройкиХозопераций.Приход = ЗНАЧЕНИЕ(Перечисление.ТипыДанныхУчета.Номенклатура)
	|				И ВыручкаИСебестоимостьПродажОбороты.КоличествоОборот < 0
	|			ТОГДА -1
	|		ИНАЧЕ 0
	|	КОНЕЦ * ВЫБОР 
	|		КОГДА &ЕдиницыКоличества = 0
	|			ТОГДА 1
	|		КОГДА &ЕдиницыКоличества = 1 
	|			ТОГДА
	|				ВЫБОР 
	|					КОГДА АналитикаНоменклатуры.Номенклатура.КоэффициентЕдиницыДляОтчетов <> 0 
	|						ТОГДА 1 / АналитикаНоменклатуры.Номенклатура.КоэффициентЕдиницыДляОтчетов
	|						ИНАЧЕ 0
	|				КОНЕЦ
	|	КОНЕЦ * ВыручкаИСебестоимостьПродажОбороты.КоличествоОборот КАК Об_КоличествоПриход,
	|	ВЫБОР 
	|		КОГДА НастройкиХозопераций.Расход = ЗНАЧЕНИЕ(Перечисление.ТипыДанныхУчета.Номенклатура)
	|				И ВыручкаИСебестоимостьПродажОбороты.КоличествоОборот > 0
	|			ТОГДА 1
	|		КОГДА НастройкиХозопераций.Расход = ЗНАЧЕНИЕ(Перечисление.ТипыДанныхУчета.Номенклатура)
	|				И ВыручкаИСебестоимостьПродажОбороты.КоличествоОборот < 0
	|			ТОГДА -1
	|		ИНАЧЕ 0
	|	КОНЕЦ * ВЫБОР 
	|		КОГДА &ЕдиницыКоличества = 0
	|			ТОГДА 1
	|		КОГДА &ЕдиницыКоличества = 1 
	|			ТОГДА
	|				ВЫБОР 
	|					КОГДА АналитикаНоменклатуры.Номенклатура.КоэффициентЕдиницыДляОтчетов <> 0 
	|						ТОГДА 1 / АналитикаНоменклатуры.Номенклатура.КоэффициентЕдиницыДляОтчетов
	|						ИНАЧЕ 0
	|				КОНЕЦ
	|	КОНЕЦ * ВыручкаИСебестоимостьПродажОбороты.КоличествоОборот КАК Об_КоличествоРасход,
	|	0 КАК Об_КоличествоКонечныйОстаток,
	|	
	|	// Показатели ""Вес""
	|	0 КАК Об_ВесНачальныйОстаток,
	|	ВЫБОР 
	|		КОГДА НастройкиХозопераций.Приход = ЗНАЧЕНИЕ(Перечисление.ТипыДанныхУчета.Номенклатура)
	|				И ВыручкаИСебестоимостьПродажОбороты.КоличествоОборот > 0
	|			ТОГДА 1
	|		КОГДА НастройкиХозопераций.Приход = ЗНАЧЕНИЕ(Перечисление.ТипыДанныхУчета.Номенклатура)
	|				И ВыручкаИСебестоимостьПродажОбороты.КоличествоОборот < 0
	|			ТОГДА -1
	|		ИНАЧЕ 0
	|	КОНЕЦ * ВыручкаИСебестоимостьПродажОбороты.КоличествоОборот * &ТекстЗапросаВесУпаковки КАК Об_ВесПриход,
	|	ВЫБОР 
	|		КОГДА НастройкиХозопераций.Расход = ЗНАЧЕНИЕ(Перечисление.ТипыДанныхУчета.Номенклатура)
	|				И ВыручкаИСебестоимостьПродажОбороты.КоличествоОборот > 0
	|			ТОГДА 1
	|		КОГДА НастройкиХозопераций.Расход = ЗНАЧЕНИЕ(Перечисление.ТипыДанныхУчета.Номенклатура)
	|				И ВыручкаИСебестоимостьПродажОбороты.КоличествоОборот < 0
	|			ТОГДА -1
	|		ИНАЧЕ 0
	|	КОНЕЦ * ВыручкаИСебестоимостьПродажОбороты.КоличествоОборот * &ТекстЗапросаВесУпаковки КАК Об_ВесРасход,
	|	0 КАК Об_ВесКонечныйОстаток,
	|	
	|	// Показатель ""Объем""
	|	0 КАК Об_ОбъемНачальныйОстаток,
	|	ВЫБОР 
	|		КОГДА НастройкиХозопераций.Приход = ЗНАЧЕНИЕ(Перечисление.ТипыДанныхУчета.Номенклатура)
	|				И ВыручкаИСебестоимостьПродажОбороты.КоличествоОборот > 0
	|			ТОГДА 1
	|		КОГДА НастройкиХозопераций.Приход = ЗНАЧЕНИЕ(Перечисление.ТипыДанныхУчета.Номенклатура)
	|				И ВыручкаИСебестоимостьПродажОбороты.КоличествоОборот < 0
	|			ТОГДА -1
	|		ИНАЧЕ 0
	|	КОНЕЦ * ВыручкаИСебестоимостьПродажОбороты.КоличествоОборот * &ТекстЗапросаОбъемУпаковки КАК Об_ОбъемПриход,
	|	ВЫБОР 
	|		КОГДА НастройкиХозопераций.Расход = ЗНАЧЕНИЕ(Перечисление.ТипыДанныхУчета.Номенклатура)
	|				И ВыручкаИСебестоимостьПродажОбороты.КоличествоОборот > 0
	|			ТОГДА 1
	|		КОГДА НастройкиХозопераций.Расход = ЗНАЧЕНИЕ(Перечисление.ТипыДанныхУчета.Номенклатура)
	|				И ВыручкаИСебестоимостьПродажОбороты.КоличествоОборот < 0
	|			ТОГДА -1
	|		ИНАЧЕ 0
	|	КОНЕЦ * ВыручкаИСебестоимостьПродажОбороты.КоличествоОборот * &ТекстЗапросаОбъемУпаковки КАК Об_ОбъемРасход,
	|	0 КАК Об_ОбъемКонечныйОстаток,
	|	
	|	// Показатель ""Стоимость""
	|	0 КАК Об_СтоимостьПоступленияНачальныйОстаток,
	|	ВЫБОР 
	|		КОГДА НастройкиХозопераций.Приход = ЗНАЧЕНИЕ(Перечисление.ТипыДанныхУчета.Номенклатура)
	|				И ВыручкаИСебестоимостьПродажОбороты.СтоимостьОборот > 0
	|			ТОГДА 1
	|		КОГДА НастройкиХозопераций.Приход = ЗНАЧЕНИЕ(Перечисление.ТипыДанныхУчета.Номенклатура)
	|				И ВыручкаИСебестоимостьПродажОбороты.СтоимостьОборот < 0
	|			ТОГДА -1
	|		ИНАЧЕ 0
	|	КОНЕЦ * ВЫБОР 
	|		КОГДА &ДанныеОтчета = 1 
	|			ТОГДА ВыручкаИСебестоимостьПродажОбороты.СтоимостьОборот
	|		КОГДА &ДанныеОтчета = 2 
	|			ТОГДА ВыручкаИСебестоимостьПродажОбороты.СтоимостьБезНДСОборот
	|		КОГДА &ДанныеОтчета = 3 
	|			ТОГДА ВыручкаИСебестоимостьПродажОбороты.СтоимостьУпрОборот
	|		КОГДА &ДанныеОтчета = 4 
	|			ТОГДА ВыручкаИСебестоимостьПродажОбороты.СтоимостьРеглОборот
	|		ИНАЧЕ 
	|			ВЫБОР КОГДА &ПоПредприятию ТОГДА
	|				ВыручкаИСебестоимостьПродажОбороты.СтоимостьБезНДСОборот
	|			ИНАЧЕ
	|				ВыручкаИСебестоимостьПродажОбороты.СтоимостьУпрОборот
	|			КОНЕЦ
	|	КОНЕЦ КАК Об_СтоимостьПоступленияПриход,
	|	ВЫБОР 
	|		КОГДА НастройкиХозопераций.Расход = ЗНАЧЕНИЕ(Перечисление.ТипыДанныхУчета.Номенклатура)
	|				И ВыручкаИСебестоимостьПродажОбороты.СтоимостьОборот > 0
	|			ТОГДА 1
	|		КОГДА НастройкиХозопераций.Расход = ЗНАЧЕНИЕ(Перечисление.ТипыДанныхУчета.Номенклатура)
	|				И ВыручкаИСебестоимостьПродажОбороты.СтоимостьОборот < 0
	|			ТОГДА -1
	|		ИНАЧЕ 0
	|	КОНЕЦ * ВЫБОР 
	|		КОГДА &ДанныеОтчета = 1 
	|			ТОГДА ВыручкаИСебестоимостьПродажОбороты.СтоимостьОборот
	|		КОГДА &ДанныеОтчета = 2 
	|			ТОГДА ВыручкаИСебестоимостьПродажОбороты.СтоимостьБезНДСОборот
	|		КОГДА &ДанныеОтчета = 3 
	|			ТОГДА ВыручкаИСебестоимостьПродажОбороты.СтоимостьУпрОборот
	|		КОГДА &ДанныеОтчета = 4 
	|			ТОГДА ВыручкаИСебестоимостьПродажОбороты.СтоимостьРеглОборот
	|		ИНАЧЕ 
	|			ВЫБОР КОГДА &ПоПредприятию ТОГДА
	|				ВыручкаИСебестоимостьПродажОбороты.СтоимостьБезНДСОборот
	|			ИНАЧЕ
	|				ВыручкаИСебестоимостьПродажОбороты.СтоимостьУпрОборот
	|			КОНЕЦ
	|	КОНЕЦ КАК Об_СтоимостьПоступленияРасход,
	|	0 КАК Об_СтоимостьПоступленияКонечныйОстаток,
	|	
	|	// Показатель ""Доп. расходы""
	|	0 КАК Об_ДопРасходыНачальныйОстаток,
	|	ВЫБОР 
	|		КОГДА НастройкиХозопераций.Приход = ЗНАЧЕНИЕ(Перечисление.ТипыДанныхУчета.Номенклатура)
	|				И ВыручкаИСебестоимостьПродажОбороты.ДопРасходыОборот > 0
	|			ТОГДА 1
	|		КОГДА НастройкиХозопераций.Приход = ЗНАЧЕНИЕ(Перечисление.ТипыДанныхУчета.Номенклатура)
	|				И ВыручкаИСебестоимостьПродажОбороты.ДопРасходыОборот < 0
	|			ТОГДА -1
	|		ИНАЧЕ 0
	|	КОНЕЦ * ВЫБОР
	|		КОГДА &ДанныеОтчета = 1 
	|			ТОГДА ВыручкаИСебестоимостьПродажОбороты.ДопРасходыОборот
	|		КОГДА &ДанныеОтчета = 2 
	|			ТОГДА ВыручкаИСебестоимостьПродажОбороты.ДопРасходыБезНДСОборот
	|		КОГДА &ДанныеОтчета = 3 
	|			ТОГДА ВыручкаИСебестоимостьПродажОбороты.ДопРасходыУпрОборот
	|		КОГДА &ДанныеОтчета = 4 
	|			ТОГДА ВыручкаИСебестоимостьПродажОбороты.ДопРасходыРеглОборот
	|		ИНАЧЕ 
	|			ВЫБОР КОГДА &ПоПредприятию ТОГДА
	|				ВыручкаИСебестоимостьПродажОбороты.ДопРасходыБезНДСОборот
	|			ИНАЧЕ
	|				ВыручкаИСебестоимостьПродажОбороты.ДопРасходыУпрОборот
	|			КОНЕЦ
	|	КОНЕЦ КАК Об_ДопРасходыПриход,
	|	ВЫБОР 
	|		КОГДА НастройкиХозопераций.Расход = ЗНАЧЕНИЕ(Перечисление.ТипыДанныхУчета.Номенклатура)
	|				И ВыручкаИСебестоимостьПродажОбороты.ДопРасходыОборот > 0
	|			ТОГДА 1
	|		КОГДА НастройкиХозопераций.Расход = ЗНАЧЕНИЕ(Перечисление.ТипыДанныхУчета.Номенклатура)
	|				И ВыручкаИСебестоимостьПродажОбороты.ДопРасходыОборот < 0
	|			ТОГДА -1
	|		ИНАЧЕ 0
	|	КОНЕЦ * ВЫБОР
	|		КОГДА &ДанныеОтчета = 1 
	|			ТОГДА ВыручкаИСебестоимостьПродажОбороты.ДопРасходыОборот
	|		КОГДА &ДанныеОтчета = 2 
	|			ТОГДА ВыручкаИСебестоимостьПродажОбороты.ДопРасходыБезНДСОборот
	|		КОГДА &ДанныеОтчета = 3 
	|			ТОГДА ВыручкаИСебестоимостьПродажОбороты.ДопРасходыУпрОборот
	|		КОГДА &ДанныеОтчета = 4 
	|			ТОГДА ВыручкаИСебестоимостьПродажОбороты.ДопРасходыРеглОборот
	|		ИНАЧЕ 
	|			ВЫБОР КОГДА &ПоПредприятию ТОГДА
	|				ВыручкаИСебестоимостьПродажОбороты.ДопРасходыБезНДСОборот
	|			ИНАЧЕ
	|				ВыручкаИСебестоимостьПродажОбороты.ДопРасходыУпрОборот
	|			КОНЕЦ
	|	КОНЕЦ КАК Об_ДопРасходыРасход,
	|	0 КАК Об_ДопРасходыКонечныйОстаток,
	|
	|	// Показатель ""Трудозатраты""
	|	0 КАК Об_ТрудозатратыНачальныйОстаток,
	|	ВЫБОР 
	|		КОГДА НастройкиХозопераций.Приход = ЗНАЧЕНИЕ(Перечисление.ТипыДанныхУчета.Номенклатура)
	|				И ВыручкаИСебестоимостьПродажОбороты.ТрудозатратыОборот > 0
	|			ТОГДА 1
	|		КОГДА НастройкиХозопераций.Приход = ЗНАЧЕНИЕ(Перечисление.ТипыДанныхУчета.Номенклатура)
	|				И ВыручкаИСебестоимостьПродажОбороты.ТрудозатратыОборот < 0
	|			ТОГДА -1
	|		ИНАЧЕ 0
	|	КОНЕЦ * ВЫБОР
	|		КОГДА &ДанныеОтчета = 1 
	|			ТОГДА ВыручкаИСебестоимостьПродажОбороты.ТрудозатратыОборот
	|		КОГДА &ДанныеОтчета = 2 
	|			ТОГДА ВыручкаИСебестоимостьПродажОбороты.ТрудозатратыОборот
	|		КОГДА &ДанныеОтчета = 3 
	|			ТОГДА ВыручкаИСебестоимостьПродажОбороты.ТрудозатратыУпрОборот
	|		КОГДА &ДанныеОтчета = 4 
	|			ТОГДА ВыручкаИСебестоимостьПродажОбороты.ТрудозатратыРеглОборот
	|		ИНАЧЕ 
	|			ВЫБОР КОГДА &ПоПредприятию ТОГДА
	|				ВыручкаИСебестоимостьПродажОбороты.ТрудозатратыОборот
	|			ИНАЧЕ
	|				ВыручкаИСебестоимостьПродажОбороты.ТрудозатратыОборот
	|			КОНЕЦ
	|	КОНЕЦ КАК Об_ТрудозатратыПриход,
	|	ВЫБОР 
	|		КОГДА НастройкиХозопераций.Расход = ЗНАЧЕНИЕ(Перечисление.ТипыДанныхУчета.Номенклатура)
	|				И ВыручкаИСебестоимостьПродажОбороты.ТрудозатратыОборот > 0
	|			ТОГДА 1
	|		КОГДА НастройкиХозопераций.Расход = ЗНАЧЕНИЕ(Перечисление.ТипыДанныхУчета.Номенклатура)
	|				И ВыручкаИСебестоимостьПродажОбороты.ТрудозатратыОборот < 0
	|			ТОГДА -1
	|		ИНАЧЕ 0
	|	КОНЕЦ * ВЫБОР
	|		КОГДА &ДанныеОтчета = 1 
	|			ТОГДА ВыручкаИСебестоимостьПродажОбороты.ТрудозатратыОборот
	|		КОГДА &ДанныеОтчета = 2 
	|			ТОГДА ВыручкаИСебестоимостьПродажОбороты.ТрудозатратыОборот
	|		КОГДА &ДанныеОтчета = 3 
	|			ТОГДА ВыручкаИСебестоимостьПродажОбороты.ТрудозатратыУпрОборот
	|		КОГДА &ДанныеОтчета = 4 
	|			ТОГДА ВыручкаИСебестоимостьПродажОбороты.ТрудозатратыРеглОборот
	|		ИНАЧЕ 
	|			ВЫБОР КОГДА &ПоПредприятию ТОГДА
	|				ВыручкаИСебестоимостьПродажОбороты.ТрудозатратыОборот
	|			ИНАЧЕ
	|				ВыручкаИСебестоимостьПродажОбороты.ТрудозатратыУпрОборот
	|			КОНЕЦ
	|	КОНЕЦ КАК Об_ТрудозатратыРасход,
	|	0 КАК Об_ТрудозатратыКонечныйОстаток,
	|
	|	// Показатель ""ПостатейныеПостоянные""
	|	0 КАК Об_ПостатейныеПостоянныеНачальныйОстаток,
	|	ВЫБОР 
	|		КОГДА НастройкиХозопераций.Приход = ЗНАЧЕНИЕ(Перечисление.ТипыДанныхУчета.Номенклатура)
	|				И ВыручкаИСебестоимостьПродажОбороты.ПостатейныеПостоянныеСНДСОборот > 0
	|			ТОГДА 1
	|		КОГДА НастройкиХозопераций.Приход = ЗНАЧЕНИЕ(Перечисление.ТипыДанныхУчета.Номенклатура)
	|				И ВыручкаИСебестоимостьПродажОбороты.ПостатейныеПостоянныеСНДСОборот < 0
	|			ТОГДА -1
	|		ИНАЧЕ 0
	|	КОНЕЦ * ВЫБОР
	|		КОГДА &ДанныеОтчета = 1 
	|			ТОГДА ВыручкаИСебестоимостьПродажОбороты.ПостатейныеПостоянныеСНДСОборот
	|		КОГДА &ДанныеОтчета = 2 
	|			ТОГДА ВыручкаИСебестоимостьПродажОбороты.ПостатейныеПостоянныеБезНДСОборот
	|		КОГДА &ДанныеОтчета = 3 
	|			ТОГДА ВыручкаИСебестоимостьПродажОбороты.ПостатейныеПостоянныеУпрОборот
	|		КОГДА &ДанныеОтчета = 4 
	|			ТОГДА ВыручкаИСебестоимостьПродажОбороты.ПостатейныеПостоянныеРеглОборот
	|		ИНАЧЕ 
	|			ВЫБОР КОГДА &ПоПредприятию ТОГДА
	|				ВыручкаИСебестоимостьПродажОбороты.ПостатейныеПостоянныеБезНДСОборот
	|			ИНАЧЕ
	|				ВыручкаИСебестоимостьПродажОбороты.ПостатейныеПостоянныеУпрОборот
	|			КОНЕЦ
	|	КОНЕЦ КАК Об_ПостатейныеПостоянныеПриход,
	|	ВЫБОР 
	|		КОГДА НастройкиХозопераций.Расход = ЗНАЧЕНИЕ(Перечисление.ТипыДанныхУчета.Номенклатура)
	|				И ВыручкаИСебестоимостьПродажОбороты.ПостатейныеПостоянныеСНДСОборот > 0
	|			ТОГДА 1
	|		КОГДА НастройкиХозопераций.Расход = ЗНАЧЕНИЕ(Перечисление.ТипыДанныхУчета.Номенклатура)
	|				И ВыручкаИСебестоимостьПродажОбороты.ПостатейныеПостоянныеСНДСОборот < 0
	|			ТОГДА -1
	|		ИНАЧЕ 0
	|	КОНЕЦ * ВЫБОР
	|		КОГДА &ДанныеОтчета = 1 
	|			ТОГДА ВыручкаИСебестоимостьПродажОбороты.ПостатейныеПостоянныеСНДСОборот
	|		КОГДА &ДанныеОтчета = 2 
	|			ТОГДА ВыручкаИСебестоимостьПродажОбороты.ПостатейныеПостоянныеБезНДСОборот
	|		КОГДА &ДанныеОтчета = 3 
	|			ТОГДА ВыручкаИСебестоимостьПродажОбороты.ПостатейныеПостоянныеУпрОборот
	|		КОГДА &ДанныеОтчета = 4 
	|			ТОГДА ВыручкаИСебестоимостьПродажОбороты.ПостатейныеПостоянныеРеглОборот
	|		ИНАЧЕ 
	|			ВЫБОР КОГДА &ПоПредприятию ТОГДА
	|				ВыручкаИСебестоимостьПродажОбороты.ПостатейныеПостоянныеБезНДСОборот
	|			ИНАЧЕ
	|				ВыручкаИСебестоимостьПродажОбороты.ПостатейныеПостоянныеУпрОборот
	|			КОНЕЦ
	|	КОНЕЦ КАК Об_ПостатейныеПостоянныеРасход,
	|	0 КАК Об_ПостатейныеПостоянныеКонечныйОстаток,
	|
	|	// Показатель ""ПостатейныеПеременные""
	|	0 КАК Об_ПостатейныеПеременныеНачальныйОстаток,
	|	ВЫБОР 
	|		КОГДА НастройкиХозопераций.Приход = ЗНАЧЕНИЕ(Перечисление.ТипыДанныхУчета.Номенклатура)
	|				И ВыручкаИСебестоимостьПродажОбороты.ПостатейныеПеременныеСНДСОборот > 0
	|			ТОГДА 1
	|		КОГДА НастройкиХозопераций.Приход = ЗНАЧЕНИЕ(Перечисление.ТипыДанныхУчета.Номенклатура)
	|				И ВыручкаИСебестоимостьПродажОбороты.ПостатейныеПеременныеСНДСОборот < 0
	|			ТОГДА -1
	|		ИНАЧЕ 0
	|	КОНЕЦ * ВЫБОР
	|		КОГДА &ДанныеОтчета = 1 
	|			ТОГДА ВыручкаИСебестоимостьПродажОбороты.ПостатейныеПеременныеСНДСОборот
	|		КОГДА &ДанныеОтчета = 2 
	|			ТОГДА ВыручкаИСебестоимостьПродажОбороты.ПостатейныеПеременныеБезНДСОборот
	|		КОГДА &ДанныеОтчета = 3 
	|			ТОГДА ВыручкаИСебестоимостьПродажОбороты.ПостатейныеПеременныеУпрОборот
	|		КОГДА &ДанныеОтчета = 4 
	|			ТОГДА ВыручкаИСебестоимостьПродажОбороты.ПостатейныеПеременныеРеглОборот
	|		ИНАЧЕ 
	|			ВЫБОР КОГДА &ПоПредприятию ТОГДА
	|				ВыручкаИСебестоимостьПродажОбороты.ПостатейныеПеременныеБезНДСОборот
	|			ИНАЧЕ
	|				ВыручкаИСебестоимостьПродажОбороты.ПостатейныеПеременныеУпрОборот
	|			КОНЕЦ
	|	КОНЕЦ КАК Об_ПостатейныеПеременныеПриход,
	|	ВЫБОР 
	|		КОГДА НастройкиХозопераций.Расход = ЗНАЧЕНИЕ(Перечисление.ТипыДанныхУчета.Номенклатура)
	|				И ВыручкаИСебестоимостьПродажОбороты.ПостатейныеПеременныеСНДСОборот > 0
	|			ТОГДА 1
	|		КОГДА НастройкиХозопераций.Расход = ЗНАЧЕНИЕ(Перечисление.ТипыДанныхУчета.Номенклатура)
	|				И ВыручкаИСебестоимостьПродажОбороты.ПостатейныеПеременныеСНДСОборот < 0
	|			ТОГДА -1
	|		ИНАЧЕ 0
	|	КОНЕЦ * ВЫБОР
	|		КОГДА &ДанныеОтчета = 1 
	|			ТОГДА ВыручкаИСебестоимостьПродажОбороты.ПостатейныеПеременныеСНДСОборот
	|		КОГДА &ДанныеОтчета = 2 
	|			ТОГДА ВыручкаИСебестоимостьПродажОбороты.ПостатейныеПеременныеБезНДСОборот
	|		КОГДА &ДанныеОтчета = 3 
	|			ТОГДА ВыручкаИСебестоимостьПродажОбороты.ПостатейныеПеременныеУпрОборот
	|		КОГДА &ДанныеОтчета = 4 
	|			ТОГДА ВыручкаИСебестоимостьПродажОбороты.ПостатейныеПеременныеРеглОборот
	|		ИНАЧЕ 
	|			ВЫБОР КОГДА &ПоПредприятию ТОГДА
	|				ВыручкаИСебестоимостьПродажОбороты.ПостатейныеПеременныеБезНДСОборот
	|			ИНАЧЕ
	|				ВыручкаИСебестоимостьПродажОбороты.ПостатейныеПеременныеУпрОборот
	|			КОНЕЦ
	|	КОНЕЦ КАК Об_ПостатейныеПеременныеРасход,
	|	0 КАК Об_ПостатейныеПеременныеКонечныйОстаток,
	|	
	|	// Показатель ""Себестоимость""
	|	0 КАК Об_СебестоимостьНачальныйОстаток,
	|	ВЫБОР 
	|		КОГДА НастройкиХозопераций.Приход = ЗНАЧЕНИЕ(Перечисление.ТипыДанныхУчета.Номенклатура)
	|				И (ВыручкаИСебестоимостьПродажОбороты.СтоимостьОборот + ВыручкаИСебестоимостьПродажОбороты.ДопРасходыОборот) > 0
	|			ТОГДА 1
	|		КОГДА НастройкиХозопераций.Приход = ЗНАЧЕНИЕ(Перечисление.ТипыДанныхУчета.Номенклатура)
	|				И (ВыручкаИСебестоимостьПродажОбороты.СтоимостьОборот + ВыручкаИСебестоимостьПродажОбороты.ДопРасходыОборот) < 0
	|			ТОГДА -1
	|		ИНАЧЕ 0
	|	КОНЕЦ * ВЫБОР 
	|		КОГДА &ДанныеОтчета = 1 
	|			ТОГДА ВыручкаИСебестоимостьПродажОбороты.СтоимостьОборот
	|				+ ВыручкаИСебестоимостьПродажОбороты.ДопРасходыОборот
	|				+ ВыручкаИСебестоимостьПродажОбороты.ТрудозатратыОборот
	|				+ ВыручкаИСебестоимостьПродажОбороты.ПостатейныеПостоянныеСНДСОборот
	|				+ ВыручкаИСебестоимостьПродажОбороты.ПостатейныеПеременныеСНДСОборот
	|		КОГДА &ДанныеОтчета = 2 
	|			ТОГДА ВыручкаИСебестоимостьПродажОбороты.СтоимостьБезНДСОборот
	|				+ ВыручкаИСебестоимостьПродажОбороты.ДопРасходыБезНДСОборот
	|				+ ВыручкаИСебестоимостьПродажОбороты.ТрудозатратыОборот
	|				+ ВыручкаИСебестоимостьПродажОбороты.ПостатейныеПостоянныеБезНДСОборот
	|				+ ВыручкаИСебестоимостьПродажОбороты.ПостатейныеПеременныеБезНДСОборот
	|		КОГДА &ДанныеОтчета = 3 
	|			ТОГДА ВыручкаИСебестоимостьПродажОбороты.СтоимостьУпрОборот
	|				+ ВыручкаИСебестоимостьПродажОбороты.ДопРасходыУпрОборот
	|				+ ВыручкаИСебестоимостьПродажОбороты.ТрудозатратыУпрОборот
	|				+ ВыручкаИСебестоимостьПродажОбороты.ПостатейныеПостоянныеУпрОборот
	|				+ ВыручкаИСебестоимостьПродажОбороты.ПостатейныеПеременныеУпрОборот
	|		КОГДА &ДанныеОтчета = 4 
	|			ТОГДА ВыручкаИСебестоимостьПродажОбороты.СтоимостьРеглОборот
	|				+ ВыручкаИСебестоимостьПродажОбороты.ДопРасходыРеглОборот
	|				+ ВыручкаИСебестоимостьПродажОбороты.ТрудозатратыРеглОборот
	|				+ ВыручкаИСебестоимостьПродажОбороты.ПостатейныеПостоянныеРеглОборот
	|				+ ВыручкаИСебестоимостьПродажОбороты.ПостатейныеПеременныеРеглОборот
	|		ИНАЧЕ 
	|			ВЫБОР КОГДА &ПоПредприятию ТОГДА
	|				ВыручкаИСебестоимостьПродажОбороты.СтоимостьБезНДСОборот
	|				+ ВыручкаИСебестоимостьПродажОбороты.ДопРасходыБезНДСОборот
	|				+ ВыручкаИСебестоимостьПродажОбороты.ТрудозатратыОборот
	|				+ ВыручкаИСебестоимостьПродажОбороты.ПостатейныеПостоянныеБезНДСОборот
	|				+ ВыручкаИСебестоимостьПродажОбороты.ПостатейныеПеременныеБезНДСОборот
	|			ИНАЧЕ
	|				ВыручкаИСебестоимостьПродажОбороты.СтоимостьУпрОборот
	|				+ ВыручкаИСебестоимостьПродажОбороты.ДопРасходыУпрОборот
	|				+ ВыручкаИСебестоимостьПродажОбороты.ТрудозатратыУпрОборот
	|				+ ВыручкаИСебестоимостьПродажОбороты.ПостатейныеПостоянныеУпрОборот
	|				+ ВыручкаИСебестоимостьПродажОбороты.ПостатейныеПеременныеУпрОборот
	|			КОНЕЦ
	|	КОНЕЦ КАК Об_СебестоимостьПриход,
	|	ВЫБОР 
	|		КОГДА НастройкиХозопераций.Расход = ЗНАЧЕНИЕ(Перечисление.ТипыДанныхУчета.Номенклатура)
	|				И (ВыручкаИСебестоимостьПродажОбороты.СтоимостьОборот + ВыручкаИСебестоимостьПродажОбороты.ДопРасходыОборот) > 0
	|			ТОГДА 1
	|		КОГДА НастройкиХозопераций.Расход = ЗНАЧЕНИЕ(Перечисление.ТипыДанныхУчета.Номенклатура)
	|				И (ВыручкаИСебестоимостьПродажОбороты.СтоимостьОборот + ВыручкаИСебестоимостьПродажОбороты.ДопРасходыОборот) < 0
	|			ТОГДА -1
	|		ИНАЧЕ 0
	|	КОНЕЦ * ВЫБОР 
	|		КОГДА &ДанныеОтчета = 1 
	|			ТОГДА ВыручкаИСебестоимостьПродажОбороты.СтоимостьОборот
	|				+ ВыручкаИСебестоимостьПродажОбороты.ДопРасходыОборот
	|				+ ВыручкаИСебестоимостьПродажОбороты.ТрудозатратыОборот
	|				+ ВыручкаИСебестоимостьПродажОбороты.ПостатейныеПостоянныеСНДСОборот
	|				+ ВыручкаИСебестоимостьПродажОбороты.ПостатейныеПеременныеСНДСОборот
	|		КОГДА &ДанныеОтчета = 2 
	|			ТОГДА ВыручкаИСебестоимостьПродажОбороты.СтоимостьБезНДСОборот
	|				+ ВыручкаИСебестоимостьПродажОбороты.ДопРасходыБезНДСОборот
	|				+ ВыручкаИСебестоимостьПродажОбороты.ТрудозатратыОборот
	|				+ ВыручкаИСебестоимостьПродажОбороты.ПостатейныеПостоянныеБезНДСОборот
	|				+ ВыручкаИСебестоимостьПродажОбороты.ПостатейныеПеременныеБезНДСОборот
	|		КОГДА &ДанныеОтчета = 3 
	|			ТОГДА ВыручкаИСебестоимостьПродажОбороты.СтоимостьУпрОборот
	|				+ ВыручкаИСебестоимостьПродажОбороты.ДопРасходыУпрОборот
	|				+ ВыручкаИСебестоимостьПродажОбороты.ТрудозатратыУпрОборот
	|				+ ВыручкаИСебестоимостьПродажОбороты.ПостатейныеПостоянныеУпрОборот
	|				+ ВыручкаИСебестоимостьПродажОбороты.ПостатейныеПеременныеУпрОборот
	|		КОГДА &ДанныеОтчета = 4 
	|			ТОГДА ВыручкаИСебестоимостьПродажОбороты.СтоимостьРеглОборот
	|				+ ВыручкаИСебестоимостьПродажОбороты.ДопРасходыРеглОборот
	|				+ ВыручкаИСебестоимостьПродажОбороты.ТрудозатратыРеглОборот
	|				+ ВыручкаИСебестоимостьПродажОбороты.ПостатейныеПостоянныеРеглОборот
	|				+ ВыручкаИСебестоимостьПродажОбороты.ПостатейныеПеременныеРеглОборот
	|		ИНАЧЕ 
	|			ВЫБОР КОГДА &ПоПредприятию ТОГДА
	|				ВыручкаИСебестоимостьПродажОбороты.СтоимостьБезНДСОборот
	|				+ ВыручкаИСебестоимостьПродажОбороты.ДопРасходыБезНДСОборот
	|				+ ВыручкаИСебестоимостьПродажОбороты.ТрудозатратыОборот
	|				+ ВыручкаИСебестоимостьПродажОбороты.ПостатейныеПостоянныеБезНДСОборот
	|				+ ВыручкаИСебестоимостьПродажОбороты.ПостатейныеПеременныеБезНДСОборот
	|			ИНАЧЕ
	|				ВыручкаИСебестоимостьПродажОбороты.СтоимостьУпрОборот
	|				+ ВыручкаИСебестоимостьПродажОбороты.ДопРасходыУпрОборот
	|				+ ВыручкаИСебестоимостьПродажОбороты.ТрудозатратыУпрОборот
	|				+ ВыручкаИСебестоимостьПродажОбороты.ПостатейныеПостоянныеУпрОборот
	|				+ ВыручкаИСебестоимостьПродажОбороты.ПостатейныеПеременныеУпрОборот
	|			КОНЕЦ
	|	КОНЕЦ КАК Об_СебестоимостьРасход,
	|	0 КАК Об_СебестоимостьКонечныйОстаток,
	|	
	|	// Показатель ""Налоговый учет""
	|	0 КАК Об_НалоговыйУчетНачальныйОстаток,
	|	ВЫБОР 
	|		КОГДА НастройкиХозопераций.Приход = ЗНАЧЕНИЕ(Перечисление.ТипыДанныхУчета.Номенклатура)
	|				И (ВыручкаИСебестоимостьПродажОбороты.СтоимостьОборот + ВыручкаИСебестоимостьПродажОбороты.ДопРасходыОборот) > 0
	|			ТОГДА 1
	|		КОГДА НастройкиХозопераций.Приход = ЗНАЧЕНИЕ(Перечисление.ТипыДанныхУчета.Номенклатура)
	|				И (ВыручкаИСебестоимостьПродажОбороты.СтоимостьОборот + ВыручкаИСебестоимостьПродажОбороты.ДопРасходыОборот) < 0
	|			ТОГДА -1
	|		ИНАЧЕ 0
	|	КОНЕЦ * ВЫБОР 
	|		КОГДА &ДанныеОтчета = 1 ИЛИ &ДанныеОтчета = 2 ИЛИ &ДанныеОтчета = 3
	|			ТОГДА 0
	|		КОГДА &ДанныеОтчета = 4 
	|			ТОГДА ВыручкаИСебестоимостьПродажОбороты.СтоимостьРеглОборот
	|				+ ВыручкаИСебестоимостьПродажОбороты.ДопРасходыРеглОборот
	|				+ ВыручкаИСебестоимостьПродажОбороты.ТрудозатратыРеглОборот
	|				+ ВыручкаИСебестоимостьПродажОбороты.ПостатейныеПостоянныеРеглОборот
	|				+ ВыручкаИСебестоимостьПродажОбороты.ПостатейныеПеременныеРеглОборот
	|				- ВыручкаИСебестоимостьПродажОбороты.ПостояннаяРазницаОборот
	|				- ВыручкаИСебестоимостьПродажОбороты.ВременнаяРазницаОборот
	|		ИНАЧЕ 
	|			0
	|	КОНЕЦ КАК Об_НалоговыйУчетПриход,
	|	ВЫБОР 
	|		КОГДА НастройкиХозопераций.Расход = ЗНАЧЕНИЕ(Перечисление.ТипыДанныхУчета.Номенклатура)
	|				И (ВыручкаИСебестоимостьПродажОбороты.СтоимостьОборот + ВыручкаИСебестоимостьПродажОбороты.ДопРасходыОборот) > 0
	|			ТОГДА 1
	|		КОГДА НастройкиХозопераций.Расход = ЗНАЧЕНИЕ(Перечисление.ТипыДанныхУчета.Номенклатура)
	|				И (ВыручкаИСебестоимостьПродажОбороты.СтоимостьОборот + ВыручкаИСебестоимостьПродажОбороты.ДопРасходыОборот) < 0
	|			ТОГДА -1
	|		ИНАЧЕ 0
	|	КОНЕЦ * ВЫБОР 
	|		КОГДА &ДанныеОтчета = 1 ИЛИ &ДанныеОтчета = 2 ИЛИ &ДанныеОтчета = 3
	|			ТОГДА 0
	|		КОГДА &ДанныеОтчета = 4 
	|			ТОГДА ВыручкаИСебестоимостьПродажОбороты.СтоимостьРеглОборот
	|				+ ВыручкаИСебестоимостьПродажОбороты.ДопРасходыРеглОборот
	|				+ ВыручкаИСебестоимостьПродажОбороты.ТрудозатратыРеглОборот
	|				+ ВыручкаИСебестоимостьПродажОбороты.ПостатейныеПостоянныеРеглОборот
	|				+ ВыручкаИСебестоимостьПродажОбороты.ПостатейныеПеременныеРеглОборот
	|				- ВыручкаИСебестоимостьПродажОбороты.ПостояннаяРазницаОборот
	|				- ВыручкаИСебестоимостьПродажОбороты.ВременнаяРазницаОборот
	|		ИНАЧЕ 
	|			0
	|	КОНЕЦ КАК Об_НалоговыйУчетРасход,
	|	0 КАК Об_НалоговыйУчетКонечныйОстаток,
	|
	|	// Показатель ""Постоянная разница""
	|	0 КАК Об_ПостояннаяРазницаНачальныйОстаток,
	|	ВЫБОР 
	|		КОГДА НастройкиХозопераций.Приход = ЗНАЧЕНИЕ(Перечисление.ТипыДанныхУчета.Номенклатура)
	|				И ВыручкаИСебестоимостьПродажОбороты.ПостояннаяРазницаОборот > 0
	|			ТОГДА 1
	|		КОГДА НастройкиХозопераций.Приход = ЗНАЧЕНИЕ(Перечисление.ТипыДанныхУчета.Номенклатура)
	|				И ВыручкаИСебестоимостьПродажОбороты.ПостояннаяРазницаОборот < 0
	|			ТОГДА -1
	|		ИНАЧЕ 0
	|	КОНЕЦ * ВЫБОР
	|		КОГДА &ДанныеОтчета = 1 ИЛИ &ДанныеОтчета = 2 ИЛИ &ДанныеОтчета = 4
	|			ТОГДА 0
	|		КОГДА &ДанныеОтчета = 4 
	|			ТОГДА ВыручкаИСебестоимостьПродажОбороты.ПостояннаяРазницаОборот
	|		ИНАЧЕ 
	|			0
	|	КОНЕЦ КАК Об_ПостояннаяРазницаПриход,
	|	ВЫБОР 
	|		КОГДА НастройкиХозопераций.Расход = ЗНАЧЕНИЕ(Перечисление.ТипыДанныхУчета.Номенклатура)
	|				И ВыручкаИСебестоимостьПродажОбороты.ПостояннаяРазницаОборот > 0
	|			ТОГДА 1
	|		КОГДА НастройкиХозопераций.Расход = ЗНАЧЕНИЕ(Перечисление.ТипыДанныхУчета.Номенклатура)
	|				И ВыручкаИСебестоимостьПродажОбороты.ПостояннаяРазницаОборот < 0
	|			ТОГДА -1
	|		ИНАЧЕ 0
	|	КОНЕЦ * ВЫБОР
	|		КОГДА &ДанныеОтчета = 1 ИЛИ &ДанныеОтчета = 2 ИЛИ &ДанныеОтчета = 4
	|			ТОГДА 0
	|		КОГДА &ДанныеОтчета = 4 
	|			ТОГДА ВыручкаИСебестоимостьПродажОбороты.ПостояннаяРазницаОборот
	|		ИНАЧЕ 
	|			0
	|	КОНЕЦ КАК Об_ПостояннаяРазницаРасход,
	|	0 КАК Об_ПостояннаяРазницаКонечныйОстаток,
	|
	|	// Показатель ""Временная разница""
	|	0 КАК Об_ВременнаяРазницаНачальныйОстаток,
	|	ВЫБОР 
	|		КОГДА НастройкиХозопераций.Приход = ЗНАЧЕНИЕ(Перечисление.ТипыДанныхУчета.Номенклатура)
	|				И ВыручкаИСебестоимостьПродажОбороты.ВременнаяРазницаОборот > 0
	|			ТОГДА 1
	|		КОГДА НастройкиХозопераций.Приход = ЗНАЧЕНИЕ(Перечисление.ТипыДанныхУчета.Номенклатура)
	|				И ВыручкаИСебестоимостьПродажОбороты.ВременнаяРазницаОборот < 0
	|			ТОГДА -1
	|		ИНАЧЕ 0
	|	КОНЕЦ * ВЫБОР
	|		КОГДА &ДанныеОтчета = 1 ИЛИ &ДанныеОтчета = 2 ИЛИ &ДанныеОтчета = 4
	|			ТОГДА 0
	|		КОГДА &ДанныеОтчета = 4 
	|			ТОГДА ВыручкаИСебестоимостьПродажОбороты.ВременнаяРазницаОборот
	|		ИНАЧЕ 
	|			0
	|	КОНЕЦ КАК Об_ВременнаяРазницаПриход,
	|	ВЫБОР 
	|		КОГДА НастройкиХозопераций.Расход = ЗНАЧЕНИЕ(Перечисление.ТипыДанныхУчета.Номенклатура)
	|				И ВыручкаИСебестоимостьПродажОбороты.ВременнаяРазницаОборот > 0
	|			ТОГДА 1
	|		КОГДА НастройкиХозопераций.Расход = ЗНАЧЕНИЕ(Перечисление.ТипыДанныхУчета.Номенклатура)
	|				И ВыручкаИСебестоимостьПродажОбороты.ВременнаяРазницаОборот < 0
	|			ТОГДА -1
	|		ИНАЧЕ 0
	|	КОНЕЦ * ВЫБОР
	|		КОГДА &ДанныеОтчета = 1 ИЛИ &ДанныеОтчета = 2 ИЛИ &ДанныеОтчета = 4
	|			ТОГДА 0
	|		КОГДА &ДанныеОтчета = 4 
	|			ТОГДА ВыручкаИСебестоимостьПродажОбороты.ВременнаяРазницаОборот
	|		ИНАЧЕ 
	|			0
	|	КОНЕЦ КАК ВременнаяРазницаРасход,
	|	0 КАК Об_ВременнаяРазницаКонечныйОстаток
	|	
	|ИЗ
	|	РегистрНакопления.ВыручкаИСебестоимостьПродаж.Обороты(
	|		{&НачалоПериода}, 
	|		{&КонецПериода}, 
	|		Авто, 
	|		НЕ АналитикаУчетаНоменклатуры.Номенклатура.ТипНоменклатуры = ЗНАЧЕНИЕ(Перечисление.ТипыНоменклатуры.Услуга)
	|		{(АналитикаУчетаНоменклатуры.Номенклатура).* КАК Номенклатура, 
	|		 (АналитикаУчетаНоменклатуры.Номенклатура.ЕдиницаИзмерения).* КАК ЕдиницаИзмерения,
	|		 (АналитикаУчетаНоменклатуры.Номенклатура.ЕдиницаДляОтчетов).* КАК ЕдиницаДляОтчетов,
	|		 (АналитикаУчетаНоменклатуры.Характеристика).* КАК Характеристика, 
	|		 (АналитикаУчетаНоменклатуры.Серия).* КАК Серия,
	|		 (АналитикаУчетаНоменклатуры.Склад).* КАК Склад, 
	|		 (АналитикаУчетаНоменклатуры.Назначение).* КАК Назначение, 
	|		 (АналитикаУчетаНоменклатуры.Назначение.НаправлениеДеятельности).* КАК НаправлениеДеятельности,
	|		 (АналитикаУчетаПоПартнерам.Организация).* КАК Организация,
	|		 (АналитикаУчетаПоПартнерам.Контрагент).* КАК Контрагент,
	|		 (ВидЗапасов).* КАК ВидЗапасов,
	|		 (ЕСТЬNULL(АналитикаУчетаПартий.Поставщик, NULL)).*	КАК Партнер,
	|		 (ЕСТЬNULL(ВЫРАЗИТЬ(АналитикаФинансовогоУчета КАК Справочник.Пользователи), NULL)).* КАК Менеджер,
	|		 (ЕСТЬNULL(ВЫРАЗИТЬ(АналитикаФинансовогоУчета КАК Справочник.СтруктураПредприятия), NULL)).* КАК Подразделение,
	|		 (ЕСТЬNULL(ВЫРАЗИТЬ(АналитикаФинансовогоУчета КАК Справочник.СделкиСКлиентами), NULL)).* КАК Сделка
	|		 (Договор).* КАК Договор,
	|		 (ЗаказКлиента).* КАК Заказ,
	|		 (Соглашение).* КАК Соглашение,
	|		 (ТипЗапасов).* КАК ТипЗапасов
	|		}
	|		) КАК ВыручкаИСебестоимостьПродажОбороты
	|
	|		{ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.АналитикаУчетаНоменклатуры КАК АналитикаНоменклатуры
	|			ПО ВыручкаИСебестоимостьПродажОбороты.АналитикаУчетаНоменклатуры = АналитикаНоменклатуры.КлючАналитики
	|		}
	|
	|		{ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.АналитикаУчетаПоПартнерам КАК АналитикаПартнеров
	|			ПО ВыручкаИСебестоимостьПродажОбороты.АналитикаУчетаПоПартнерам = АналитикаПартнеров.КлючАналитики
	|		}
	|
	|		{ЛЕВОЕ СОЕДИНЕНИЕ Справочник.КлючиАналитикиУчетаПартий КАК АналитикаПартий
	|			ПО АналитикаПартий.Ссылка = ВыручкаИСебестоимостьПродажОбороты.АналитикаУчетаПартий
	|		}
	|
	|		ЛЕВОЕ СОЕДИНЕНИЕ Справочник.НастройкиХозяйственныхОпераций КАК НастройкиХозопераций
	|		ПО НастройкиХозопераций.ХозяйственнаяОперация = ВыручкаИСебестоимостьПродажОбороты.ХозяйственнаяОперация
	|{ГДЕ
	|	((АналитикаНоменклатуры.Номенклатура, АналитикаНоменклатуры.Характеристика) В
	|			(ВЫБРАТЬ
	|				ОтборПоСегментуНоменклатуры.Номенклатура,
	|				ОтборПоСегментуНоменклатуры.Характеристика
	|			ИЗ
	|				ОтборПоСегментуНоменклатуры
	|			ГДЕ
	|				ОтборПоСегментуНоменклатуры.ИспользуетсяОтборПоСегментуНоменклатуры = &ИспользуетсяОтборПоСегментуНоменклатуры)),
	|	(""ВыручкаИСебестоимостьПродажОбороты"") КАК НаборДанных,
	|	НАЧАЛОПЕРИОДА(ВыручкаИСебестоимостьПродажОбороты.ПериодДень,      ДЕНЬ)      КАК ПериодДень,
	|	НАЧАЛОПЕРИОДА(ВыручкаИСебестоимостьПродажОбороты.ПериодНеделя,    НЕДЕЛЯ)    КАК ПериодНеделя,
	|	НАЧАЛОПЕРИОДА(ВыручкаИСебестоимостьПродажОбороты.ПериодДекада,    ДЕКАДА)    КАК ПериодДекада,
	|	НАЧАЛОПЕРИОДА(ВыручкаИСебестоимостьПродажОбороты.ПериодМесяц,     МЕСЯЦ)     КАК ПериодМесяц,
	|	НАЧАЛОПЕРИОДА(ВыручкаИСебестоимостьПродажОбороты.ПериодКвартал,   КВАРТАЛ)   КАК ПериодКвартал,
	|	НАЧАЛОПЕРИОДА(ВыручкаИСебестоимостьПродажОбороты.ПериодПолугодие, ПОЛУГОДИЕ) КАК ПериодПолугодие,
	|	НАЧАЛОПЕРИОДА(ВыручкаИСебестоимостьПродажОбороты.ПериодГод,       ГОД)       КАК ПериодГод,
	|	ВыручкаИСебестоимостьПродажОбороты.АналитикаУчетаНоменклатуры.*,
	|	(ВЫБОР
	|			КОГДА &ФормироватьВидыЗапасовПоГруппамФинансовогоУчета
	|				ТОГДА ВыручкаИСебестоимостьПродажОбороты.ВидЗапасов.ГруппаФинансовогоУчета
	|			ИНАЧЕ АналитикаНоменклатуры.Номенклатура.ГруппаФинансовогоУчета
	|		КОНЕЦ).* КАК ГруппаФинансовогоУчета,
	|	(ЗНАЧЕНИЕ(ПланВидовХарактеристик.СтатьиДоходов.ВыручкаОтПродаж)).* КАК СтатьяДоходов,
	|	(NULL) КАК СтатьяРасходов,
	|	(ЗНАЧЕНИЕ(ПланВидовХарактеристик.СтатьиДоходов.ВыручкаОтПродаж)).* КАК СтатьяДоходовРасходов,
	|	НастройкиХозопераций.Ссылка.* КАК ХозяйственнаяОперацияСправочник,
	|	(ВЫБОР
	|			КОГДА НастройкиХозопераций.Приход = ЗНАЧЕНИЕ(Перечисление.ТипыДанныхУчета.Номенклатура)
	|				ИЛИ (НастройкиХозопераций.ХозяйственнаяОперация = Значение(Перечисление.ХозяйственныеОперации.ОприходованиеПоВозврату))
	|				ТОГДА ИСТИНА
	|			ИНАЧЕ ЛОЖЬ
	|		КОНЕЦ) КАК ХозяйственнаяОперацияПрихода,
	|	(ВЫБОР
	|			КОГДА НастройкиХозопераций.Расход = ЗНАЧЕНИЕ(Перечисление.ТипыДанныхУчета.Номенклатура)
	|				И НЕ (НастройкиХозопераций.ХозяйственнаяОперация = Значение(Перечисление.ХозяйственныеОперации.ОприходованиеПоВозврату))
	|				ТОГДА ИСТИНА
	|			ИНАЧЕ ЛОЖЬ
	|		КОНЕЦ) КАК ХозяйственнаяОперацияРасхода}";
	
	ТекстЗапроса = СтрЗаменить(
		ТекстЗапроса, 
		"&ТекстЗапросаВесУпаковки", 
		Справочники.УпаковкиЕдиницыИзмерения.ТекстЗапросаВесУпаковки("АналитикаНоменклатуры.Номенклатура.ЕдиницаИзмерения", "АналитикаНоменклатуры.Номенклатура"));
		
	ТекстЗапроса = СтрЗаменить(
		ТекстЗапроса, 
		"&ТекстЗапросаОбъемУпаковки", 
		Справочники.УпаковкиЕдиницыИзмерения.ТекстЗапросаОбъемУпаковки("АналитикаНоменклатуры.Номенклатура.ЕдиницаИзмерения", "АналитикаНоменклатуры.Номенклатура"));
		
	Возврат ТекстЗапроса;
КонецФункции

Функция ТекстЗапросаДвиженияНоменклатураНоменклатураОборотыПриход()
	ТекстЗапроса = "
	|////////////////////////////////////////////////////////////////////////////////
	|ВЫБРАТЬ РАЗРЕШЕННЫЕ
	|	""ДвиженияНоменклатураНоменклатураОборотыПриход"" КАК НаборДанных,
	|	
	|	// Аналитика периодов
	|	НАЧАЛОПЕРИОДА(ДвиженияНоменклатураНоменклатураОборотыПриход.ПериодДень,      ДЕНЬ)      КАК ПериодДень,
	|	НАЧАЛОПЕРИОДА(ДвиженияНоменклатураНоменклатураОборотыПриход.ПериодНеделя,    НЕДЕЛЯ)    КАК ПериодНеделя,
	|	НАЧАЛОПЕРИОДА(ДвиженияНоменклатураНоменклатураОборотыПриход.ПериодДекада,    ДЕКАДА)    КАК ПериодДекада,
	|	НАЧАЛОПЕРИОДА(ДвиженияНоменклатураНоменклатураОборотыПриход.ПериодМесяц,     МЕСЯЦ)     КАК ПериодМесяц,
	|	НАЧАЛОПЕРИОДА(ДвиженияНоменклатураНоменклатураОборотыПриход.ПериодКвартал,   КВАРТАЛ)   КАК ПериодКвартал,
	|	НАЧАЛОПЕРИОДА(ДвиженияНоменклатураНоменклатураОборотыПриход.ПериодПолугодие, ПОЛУГОДИЕ) КАК ПериодПолугодие,
	|	НАЧАЛОПЕРИОДА(ДвиженияНоменклатураНоменклатураОборотыПриход.ПериодГод,       ГОД)       КАК ПериодГод,
	|	
	|	// Общая аналитика
	|	ДвиженияНоменклатураНоменклатураОборотыПриход.КорАналитикаУчетаНоменклатуры КАК АналитикаУчетаНоменклатуры,
	|	АналитикаНоменклатуры.Номенклатура                                          КАК Номенклатура,
	|	АналитикаНоменклатуры.Номенклатура.ЕдиницаИзмерения                         КАК ЕдиницаХранения,
	|	АналитикаНоменклатуры.Номенклатура.ЕдиницаДляОтчетов                        КАК ЕдиницаДляОтчетов,
	|	АналитикаНоменклатуры.Номенклатура.КоэффициентЕдиницыДляОтчетов КАК КоэффициентЕдиницыДляОтчетов,
	|	АналитикаНоменклатуры.Характеристика                                        КАК Характеристика,
	|	АналитикаНоменклатуры.Серия                                                 КАК Серия,
	|	АналитикаНоменклатуры.Склад                                                 КАК Склад,
	|	АналитикаНоменклатуры.Назначение                                            КАК Назначение,
	|	АналитикаНоменклатуры.Назначение.НаправлениеДеятельности                    КАК НаправлениеДеятельности,
	|	
	|	ДвиженияНоменклатураНоменклатураОборотыПриход.КорВидЗапасов               КАК ВидЗапасов,
	|	NULL                                                                      КАК Партнер,
	|	NULL                                                                      КАК Менеджер,
	|	ДвиженияНоменклатураНоменклатураОборотыПриход.Подразделение               КАК Подразделение,
	|	NULL                                                                      КАК Сделка,
	|	
	|	ВЫБОР 
	|		КОГДА &ФормироватьВидыЗапасовПоГруппамФинансовогоУчета 
	|			ТОГДА ДвиженияНоменклатураНоменклатураОборотыПриход.КорВидЗапасов.ГруппаФинансовогоУчета
	|			ИНАЧЕ КорАналитикаУчетаНоменклатуры.Номенклатура.ГруппаФинансовогоУчета
	|	КОНЕЦ КАК ГруппаФинансовогоУчета,
	|	
	|	ДвиженияНоменклатураНоменклатураОборотыПриход.Организация КАК Организация,
	|	
	|	// Аналитика оборотов
	|	NULL КАК СтатьяДоходов,
	|	NULL КАК СтатьяРасходов,
	|	NULL КАК СтатьяДоходовРасходов,
	|	NULL КАК АналитикаДоходов,
	|	NULL КАК АналитикаРасходов,
	|	NULL КАК АналитикаДоходовРасходов,
	|	NULL КАК Договор,
	|	NULL КАК Заказ,
	|	NULL КАК Контрагент,
	|	NULL КАК Соглашение,
	|	ДвиженияНоменклатураНоменклатураОборотыПриход.КорТипЗапасов         КАК ТипЗапасов,
	|	НастройкиХозопераций.Ссылка                                         КАК ХозяйственнаяОперацияСправочник,
	|	ВЫБОР 
	|		КОГДА НастройкиХозопераций.Приход = ЗНАЧЕНИЕ(Перечисление.ТипыДанныхУчета.Номенклатура)
	|			ТОГДА ИСТИНА
	|			ИНАЧЕ ЛОЖЬ
	|	КОНЕЦ                                                               КАК ХозяйственнаяОперацияПрихода,
	|	ВЫБОР 
	|		КОГДА НастройкиХозопераций.Расход = ЗНАЧЕНИЕ(Перечисление.ТипыДанныхУчета.Номенклатура)
	|			ТОГДА ИСТИНА
	|			ИНАЧЕ ЛОЖЬ
	|	КОНЕЦ                                                               КАК ХозяйственнаяОперацияРасхода,
	|	
	|	// Показатель ""Количество""
	|	0 КАК Об_КоличествоНачальныйОстаток,
	|	ВЫБОР 
	|		КОГДА &ЕдиницыКоличества = 0 
	|			ТОГДА 1
	|		КОГДА &ЕдиницыКоличества = 1 
	|			ТОГДА
	|				ВЫБОР 
	|					КОГДА КорАналитикаУчетаНоменклатуры.Номенклатура.КоэффициентЕдиницыДляОтчетов <> 0 
	|						ТОГДА 1 / КорАналитикаУчетаНоменклатуры.Номенклатура.КоэффициентЕдиницыДляОтчетов
	|						ИНАЧЕ 0
	|				КОНЕЦ
	|	КОНЕЦ * ДвиженияНоменклатураНоменклатураОборотыПриход.КорКоличествоОборот КАК Об_КоличествоПриход,
	|	0 КАК Об_КоличествоРасход,
	|	0 КАК Об_КоличествоКонечныйОстаток,
	|	
	|	// Показатель ""Вес""
	|	0 КАК Об_ВесНачальныйОстаток,
	|	ДвиженияНоменклатураНоменклатураОборотыПриход.КорКоличествоОборот * &ТекстЗапросаВесУпаковки КАК Об_ВесПриход,
	|	0 КАК Об_ВесРасход,
	|	0 КАК Об_ВесКонечныйОстаток,
	|	
	|	// Показатель ""Объем""
	|	0 КАК Об_ОбъемНачальныйОстаток,
	|	ДвиженияНоменклатураНоменклатураОборотыПриход.КорКоличествоОборот * &ТекстЗапросаОбъемУпаковки КАК Об_ОбъемПриход,
	|	0 КАК Об_ОбъемРасход,
	|	0 КАК Об_ОбъемКонечныйОстаток,
	|	
	|	// Показатель ""Стоимость""
	|	0 КАК Об_СтоимостьПоступленияНачальныйОстаток,
	|	ВЫБОР 
	|		КОГДА &ДанныеОтчета = 1 
	|			ТОГДА ДвиженияНоменклатураНоменклатураОборотыПриход.СтоимостьОборот
	|		КОГДА &ДанныеОтчета = 2 
	|			ТОГДА ДвиженияНоменклатураНоменклатураОборотыПриход.СтоимостьБезНДСОборот
	|		КОГДА &ДанныеОтчета = 3 
	|			ТОГДА ДвиженияНоменклатураНоменклатураОборотыПриход.СтоимостьУпрОборот
	|		КОГДА &ДанныеОтчета = 4 
	|			ТОГДА ДвиженияНоменклатураНоменклатураОборотыПриход.СтоимостьРеглОборот
	|		ИНАЧЕ 
	|			ВЫБОР КОГДА &ПоПредприятию ТОГДА
	|				ДвиженияНоменклатураНоменклатураОборотыПриход.СтоимостьБезНДСОборот
	|			ИНАЧЕ
	|				ДвиженияНоменклатураНоменклатураОборотыПриход.СтоимостьУпрОборот
	|			КОНЕЦ
	|	КОНЕЦ КАК Об_СтоимостьПоступленияПриход,
	|	0 КАК Об_СтоимостьПоступленияРасход,
	|	0 КАК Об_СтоимостьПоступленияКонечныйОстаток,
	|	
	|	// Показатель ""Доп. расходы""
	|	0 КАК Об_ДопРасходыНачальныйОстаток,
	|	ВЫБОР 
	|		КОГДА &ДанныеОтчета = 1 
	|			ТОГДА ДвиженияНоменклатураНоменклатураОборотыПриход.ДопРасходыОборот
	|		КОГДА &ДанныеОтчета = 2 
	|			ТОГДА ДвиженияНоменклатураНоменклатураОборотыПриход.ДопРасходыБезНДСОборот
	|		КОГДА &ДанныеОтчета = 3 
	|			ТОГДА ДвиженияНоменклатураНоменклатураОборотыПриход.ДопРасходыУпрОборот
	|		КОГДА &ДанныеОтчета = 4 
	|			ТОГДА ДвиженияНоменклатураНоменклатураОборотыПриход.ДопРасходыРеглОборот
	|		ИНАЧЕ 
	|			ВЫБОР КОГДА &ПоПредприятию ТОГДА
	|				ДвиженияНоменклатураНоменклатураОборотыПриход.ДопРасходыБезНДСОборот
	|			ИНАЧЕ
	|				ДвиженияНоменклатураНоменклатураОборотыПриход.ДопРасходыУпрОборот
	|			КОНЕЦ
	|	КОНЕЦ КАК Об_ДопРасходыПриход,
	|	0 КАК Об_ДопРасходыРасход,
	|	0 КАК Об_ДопРасходыКонечныйОстаток,
	|	
	|	// Показатель ""Трудозатраты""
	|	0 КАК Об_ТрудозатратыНачальныйОстаток,
	|	ВЫБОР 
	|		КОГДА &ДанныеОтчета = 1 
	|			ТОГДА ДвиженияНоменклатураНоменклатураОборотыПриход.ТрудозатратыОборот
	|		КОГДА &ДанныеОтчета = 2 
	|			ТОГДА ДвиженияНоменклатураНоменклатураОборотыПриход.ТрудозатратыОборот
	|		КОГДА &ДанныеОтчета = 3 
	|			ТОГДА ДвиженияНоменклатураНоменклатураОборотыПриход.ТрудозатратыУпрОборот
	|		КОГДА &ДанныеОтчета = 4 
	|			ТОГДА ДвиженияНоменклатураНоменклатураОборотыПриход.ТрудозатратыРеглОборот
	|		ИНАЧЕ 
	|			ВЫБОР КОГДА &ПоПредприятию ТОГДА
	|				ДвиженияНоменклатураНоменклатураОборотыПриход.ТрудозатратыОборот
	|			ИНАЧЕ
	|				ДвиженияНоменклатураНоменклатураОборотыПриход.ТрудозатратыУпрОборот
	|			КОНЕЦ
	|	КОНЕЦ КАК Об_ТрудозатратыПриход,
	|	0 КАК Об_ТрудозатратыРасход,
	|	0 КАК Об_ТрудозатратыКонечныйОстаток,
	|	
	|	// Показатель ""ПостатейныеПостоянные""
	|	0 КАК Об_ПостатейныеПостоянныеОстаток,
	|	ВЫБОР 
	|		КОГДА &ДанныеОтчета = 1 
	|			ТОГДА ДвиженияНоменклатураНоменклатураОборотыПриход.ПостатейныеПостоянныеСНДСОборот
	|		КОГДА &ДанныеОтчета = 2 
	|			ТОГДА ДвиженияНоменклатураНоменклатураОборотыПриход.ПостатейныеПостоянныеБезНДСОборот
	|		КОГДА &ДанныеОтчета = 3 
	|			ТОГДА ДвиженияНоменклатураНоменклатураОборотыПриход.ПостатейныеПостоянныеУпрОборот
	|		КОГДА &ДанныеОтчета = 4 
	|			ТОГДА ДвиженияНоменклатураНоменклатураОборотыПриход.ПостатейныеПостоянныеРеглОборот
	|		ИНАЧЕ 
	|			ВЫБОР КОГДА &ПоПредприятию ТОГДА
	|				ДвиженияНоменклатураНоменклатураОборотыПриход.ПостатейныеПостоянныеБезНДСОборот
	|			ИНАЧЕ
	|				ДвиженияНоменклатураНоменклатураОборотыПриход.ПостатейныеПостоянныеУпрОборот
	|			КОНЕЦ
	|	КОНЕЦ КАК Об_ПостатейныеПостоянныеПриход,
	|	0 КАК Об_ПостатейныеПостоянныеРасход,
	|	0 КАК Об_ПостатейныеПостоянныеКонечныйОстаток,
	|	
	|	// Показатель ""ПостатейныеПеременные""
	|	0 КАК Об_ПостатейныеПеременныеОстаток,
	|	ВЫБОР 
	|		КОГДА &ДанныеОтчета = 1 
	|			ТОГДА ДвиженияНоменклатураНоменклатураОборотыПриход.ПостатейныеПеременныеСНДСОборот
	|		КОГДА &ДанныеОтчета = 2 
	|			ТОГДА ДвиженияНоменклатураНоменклатураОборотыПриход.ПостатейныеПеременныеБезНДСОборот
	|		КОГДА &ДанныеОтчета = 3 
	|			ТОГДА ДвиженияНоменклатураНоменклатураОборотыПриход.ПостатейныеПеременныеУпрОборот
	|		КОГДА &ДанныеОтчета = 4 
	|			ТОГДА ДвиженияНоменклатураНоменклатураОборотыПриход.ПостатейныеПеременныеРеглОборот
	|		ИНАЧЕ 
	|			ВЫБОР КОГДА &ПоПредприятию ТОГДА
	|				ДвиженияНоменклатураНоменклатураОборотыПриход.ПостатейныеПеременныеБезНДСОборот
	|			ИНАЧЕ
	|				ДвиженияНоменклатураНоменклатураОборотыПриход.ПостатейныеПеременныеУпрОборот
	|			КОНЕЦ
	|	КОНЕЦ КАК Об_ПостатейныеПеременныеПриход,
	|	0 КАК Об_ПостатейныеПеременныеРасход,
	|	0 КАК Об_ПостатейныеПеременныеКонечныйОстаток,
	|
	|	// Показатель ""Себестоимость""
	|	0 КАК Об_СебестоимостьНачальныйОстаток,
	|	ВЫБОР 
	|		КОГДА &ДанныеОтчета = 1 
	|			ТОГДА ДвиженияНоменклатураНоменклатураОборотыПриход.СтоимостьОборот
	|				+ ДвиженияНоменклатураНоменклатураОборотыПриход.ДопРасходыОборот
	|				+ ДвиженияНоменклатураНоменклатураОборотыПриход.ТрудозатратыОборот
	|				+ ДвиженияНоменклатураНоменклатураОборотыПриход.ПостатейныеПостоянныеСНДСОборот
	|				+ ДвиженияНоменклатураНоменклатураОборотыПриход.ПостатейныеПеременныеСНДСОборот
	|		КОГДА &ДанныеОтчета = 2 
	|			ТОГДА ДвиженияНоменклатураНоменклатураОборотыПриход.СтоимостьБезНДСОборот
	|				+ ДвиженияНоменклатураНоменклатураОборотыПриход.ДопРасходыБезНДСОборот
	|				+ ДвиженияНоменклатураНоменклатураОборотыПриход.ТрудозатратыОборот
	|				+ ДвиженияНоменклатураНоменклатураОборотыПриход.ПостатейныеПостоянныеБезНДСОборот
	|				+ ДвиженияНоменклатураНоменклатураОборотыПриход.ПостатейныеПеременныеБезНДСОборот
	|		КОГДА &ДанныеОтчета = 3 
	|			ТОГДА ДвиженияНоменклатураНоменклатураОборотыПриход.СтоимостьУпрОборот
	|				+ ДвиженияНоменклатураНоменклатураОборотыПриход.ДопРасходыУпрОборот
	|				+ ДвиженияНоменклатураНоменклатураОборотыПриход.ТрудозатратыУпрОборот
	|				+ ДвиженияНоменклатураНоменклатураОборотыПриход.ПостатейныеПостоянныеУпрОборот
	|				+ ДвиженияНоменклатураНоменклатураОборотыПриход.ПостатейныеПеременныеУпрОборот
	|		КОГДА &ДанныеОтчета = 4 
	|			ТОГДА ДвиженияНоменклатураНоменклатураОборотыПриход.СтоимостьРеглОборот
	|				+ ДвиженияНоменклатураНоменклатураОборотыПриход.ДопРасходыРеглОборот
	|				+ ДвиженияНоменклатураНоменклатураОборотыПриход.ТрудозатратыРеглОборот
	|				+ ДвиженияНоменклатураНоменклатураОборотыПриход.ПостатейныеПостоянныеРеглОборот
	|				+ ДвиженияНоменклатураНоменклатураОборотыПриход.ПостатейныеПеременныеРеглОборот
	|		ИНАЧЕ 
	|			ВЫБОР КОГДА &ПоПредприятию ТОГДА
	|				ДвиженияНоменклатураНоменклатураОборотыПриход.СтоимостьБезНДСОборот
	|				+ ДвиженияНоменклатураНоменклатураОборотыПриход.ДопРасходыБезНДСОборот
	|				+ ДвиженияНоменклатураНоменклатураОборотыПриход.ТрудозатратыОборот
	|				+ ДвиженияНоменклатураНоменклатураОборотыПриход.ПостатейныеПостоянныеБезНДСОборот
	|				+ ДвиженияНоменклатураНоменклатураОборотыПриход.ПостатейныеПеременныеБезНДСОборот
	|			ИНАЧЕ
	|				ДвиженияНоменклатураНоменклатураОборотыПриход.СтоимостьУпрОборот
	|				+ ДвиженияНоменклатураНоменклатураОборотыПриход.ДопРасходыУпрОборот
	|				+ ДвиженияНоменклатураНоменклатураОборотыПриход.ТрудозатратыУпрОборот
	|				+ ДвиженияНоменклатураНоменклатураОборотыПриход.ПостатейныеПостоянныеУпрОборот
	|				+ ДвиженияНоменклатураНоменклатураОборотыПриход.ПостатейныеПеременныеУпрОборот
	|			КОНЕЦ
	|	КОНЕЦ КАК Об_СебестоимостьПриход,
	|	0 КАК Об_СебестоимостьРасход,
	|	0 КАК Об_СебестоимостьКонечныйОстаток,
	|
	|	// Показатель ""Налоговый учет""
	|	0 КАК Об_НалоговыйУчетНачальныйОстаток,
	|	ВЫБОР 
	|		КОГДА &ДанныеОтчета = 1 ИЛИ &ДанныеОтчета = 2 ИЛИ &ДанныеОтчета = 3
	|			ТОГДА 0
	|		КОГДА &ДанныеОтчета = 4 
	|			ТОГДА ДвиженияНоменклатураНоменклатураОборотыПриход.СтоимостьРеглОборот
	|				+ ДвиженияНоменклатураНоменклатураОборотыПриход.ДопРасходыРеглОборот
	|				+ ДвиженияНоменклатураНоменклатураОборотыПриход.ТрудозатратыРеглОборот
	|				+ ДвиженияНоменклатураНоменклатураОборотыПриход.ПостатейныеПостоянныеРеглОборот
	|				+ ДвиженияНоменклатураНоменклатураОборотыПриход.ПостатейныеПеременныеРеглОборот
	|				- ДвиженияНоменклатураНоменклатураОборотыПриход.ПостояннаяРазницаОборот
	|				- ДвиженияНоменклатураНоменклатураОборотыПриход.ВременнаяРазницаОборот
	|		ИНАЧЕ 
	|			0
	|	КОНЕЦ КАК Об_НалоговыйУчетПриход,
	|	0 КАК Об_НалоговыйУчетРасход,
	|	0 КАК Об_НалоговыйУчетКонечныйОстаток,
	|
	|	// Показатель ""Постоянная разница""
	|	0 КАК Об_ПостояннаяРазницаНачальныйОстаток,
	|	ВЫБОР 
	|		КОГДА НастройкиХозопераций.Приход = ЗНАЧЕНИЕ(Перечисление.ТипыДанныхУчета.Номенклатура)
	|				И ДвиженияНоменклатураНоменклатураОборотыПриход.ПостояннаяРазницаОборот > 0
	|			ТОГДА 1
	|		КОГДА НастройкиХозопераций.Приход = ЗНАЧЕНИЕ(Перечисление.ТипыДанныхУчета.Номенклатура)
	|				И ДвиженияНоменклатураНоменклатураОборотыПриход.ПостояннаяРазницаОборот < 0
	|			ТОГДА -1
	|		ИНАЧЕ 0
	|	КОНЕЦ * ВЫБОР
	|		КОГДА &ДанныеОтчета = 1 ИЛИ &ДанныеОтчета = 2 ИЛИ &ДанныеОтчета = 4
	|			ТОГДА 0
	|		КОГДА &ДанныеОтчета = 4 
	|			ТОГДА ДвиженияНоменклатураНоменклатураОборотыПриход.ПостояннаяРазницаОборот
	|		ИНАЧЕ 
	|			0
	|	КОНЕЦ КАК Об_ПостояннаяРазницаПриход,
	|	0 КАК Об_ПостояннаяРазницаРасход,
	|	0 КАК Об_ПостояннаяРазницаКонечныйОстаток,
	|
	|	// Показатель ""Временная разница""
	|	0 КАК Об_ВременнаяРазницаНачальныйОстаток,
	|	ВЫБОР 
	|		КОГДА НастройкиХозопераций.Приход = ЗНАЧЕНИЕ(Перечисление.ТипыДанныхУчета.Номенклатура)
	|				И ДвиженияНоменклатураНоменклатураОборотыПриход.ВременнаяРазницаОборот > 0
	|			ТОГДА 1
	|		КОГДА НастройкиХозопераций.Приход = ЗНАЧЕНИЕ(Перечисление.ТипыДанныхУчета.Номенклатура)
	|				И ДвиженияНоменклатураНоменклатураОборотыПриход.ВременнаяРазницаОборот < 0
	|			ТОГДА -1
	|		ИНАЧЕ 0
	|	КОНЕЦ * ВЫБОР
	|		КОГДА &ДанныеОтчета = 1 ИЛИ &ДанныеОтчета = 2 ИЛИ &ДанныеОтчета = 4
	|			ТОГДА 0
	|		КОГДА &ДанныеОтчета = 4 
	|			ТОГДА ДвиженияНоменклатураНоменклатураОборотыПриход.ВременнаяРазницаОборот
	|		ИНАЧЕ 
	|			0
	|	КОНЕЦ КАК Об_ВременнаяРазницаПриход,
	|	0 КАК ВременнаяРазницаРасход,
	|	0 КАК Об_ВременнаяРазницаКонечныйОстаток
	|	
	|ИЗ
	|	РегистрНакопления.ДвиженияНоменклатураНоменклатура.Обороты(
	|		{&НачалоПериода}, 
	|		{&КонецПериода}, 
	|		Авто, 
	|		{(КорАналитикаУчетаНоменклатуры.Номенклатура).* КАК Номенклатура, 
	|		 (КорАналитикаУчетаНоменклатуры.Номенклатура.ЕдиницаИзмерения).* КАК ЕдиницаИзмерения,
	|		 (КорАналитикаУчетаНоменклатуры.Номенклатура.ЕдиницаДляОтчетов).* КАК ЕдиницаДляОтчетов,
	|		 (КорАналитикаУчетаНоменклатуры.Характеристика).* КАК Характеристика,
	|		 (КорАналитикаУчетаНоменклатуры.Серия).* КАК Серия, 
	|		 (КорАналитикаУчетаНоменклатуры.Склад).* КАК Склад,
	|		 (КорАналитикаУчетаНоменклатуры.Назначение).* КАК Назначение, 
	|		 (КорАналитикаУчетаНоменклатуры.Назначение.НаправлениеДеятельности).* КАК НаправлениеДеятельности, 
	|		 (Организация).* КАК Организация,
	|		 (КорВидЗапасов).* КАК ВидЗапасов,
	|		 (КорТипЗапасов).* КАК ТипЗапасов
	|		}
	|	) КАК ДвиженияНоменклатураНоменклатураОборотыПриход
	|
	|		{ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.АналитикаУчетаНоменклатуры КАК АналитикаНоменклатуры
	|			ПО ДвиженияНоменклатураНоменклатураОборотыПриход.КорАналитикаУчетаНоменклатуры = АналитикаНоменклатуры.КлючАналитики
	|		}
	|
	|		ЛЕВОЕ СОЕДИНЕНИЕ Справочник.НастройкиХозяйственныхОпераций КАК НастройкиХозопераций
	|		ПО НастройкиХозопераций.ХозяйственнаяОперация = ДвиженияНоменклатураНоменклатураОборотыПриход.ХозяйственнаяОперация
	|ГДЕ 
	|	НЕ АналитикаНоменклатуры.Номенклатура.ТипНоменклатуры = ЗНАЧЕНИЕ(Перечисление.ТипыНоменклатуры.Услуга)
	|{ГДЕ
	|	((АналитикаНоменклатуры.Номенклатура, АналитикаНоменклатуры.Характеристика) В
	|			(ВЫБРАТЬ
	|				ОтборПоСегментуНоменклатуры.Номенклатура,
	|				ОтборПоСегментуНоменклатуры.Характеристика
	|			ИЗ
	|				ОтборПоСегментуНоменклатуры
	|			ГДЕ
	|				ОтборПоСегментуНоменклатуры.ИспользуетсяОтборПоСегментуНоменклатуры = &ИспользуетсяОтборПоСегментуНоменклатуры)),
	|	(""ДвиженияНоменклатураНоменклатураОборотыПриход"") КАК НаборДанных,
	|	НАЧАЛОПЕРИОДА(ДвиженияНоменклатураНоменклатураОборотыПриход.ПериодДень,      ДЕНЬ)      КАК ПериодДень,
	|	НАЧАЛОПЕРИОДА(ДвиженияНоменклатураНоменклатураОборотыПриход.ПериодНеделя,    НЕДЕЛЯ)    КАК ПериодНеделя,
	|	НАЧАЛОПЕРИОДА(ДвиженияНоменклатураНоменклатураОборотыПриход.ПериодДекада,    ДЕКАДА)    КАК ПериодДекада,
	|	НАЧАЛОПЕРИОДА(ДвиженияНоменклатураНоменклатураОборотыПриход.ПериодМесяц,     МЕСЯЦ)     КАК ПериодМесяц,
	|	НАЧАЛОПЕРИОДА(ДвиженияНоменклатураНоменклатураОборотыПриход.ПериодКвартал,   КВАРТАЛ)   КАК ПериодКвартал,
	|	НАЧАЛОПЕРИОДА(ДвиженияНоменклатураНоменклатураОборотыПриход.ПериодПолугодие, ПОЛУГОДИЕ) КАК ПериодПолугодие,
	|	НАЧАЛОПЕРИОДА(ДвиженияНоменклатураНоменклатураОборотыПриход.ПериодГод,       ГОД)       КАК ПериодГод,
	|	ДвиженияНоменклатураНоменклатураОборотыПриход.КорАналитикаУчетаНоменклатуры.* КАК АналитикаУчетаНоменклатуры,
	|	(ВЫБОР
	|			КОГДА &ФормироватьВидыЗапасовПоГруппамФинансовогоУчета
	|				ТОГДА ДвиженияНоменклатураНоменклатураОборотыПриход.КорВидЗапасов.ГруппаФинансовогоУчета
	|			ИНАЧЕ ДвиженияНоменклатураНоменклатураОборотыПриход.КорАналитикаУчетаНоменклатуры.Номенклатура.ГруппаФинансовогоУчета
	|		КОНЕЦ).* КАК ГруппаФинансовогоУчета,
	|	NULL КАК Заказ,
	|	НастройкиХозопераций.Ссылка.* КАК ХозяйственнаяОперацияСправочник,
	|	(ВЫБОР
	|			КОГДА НастройкиХозопераций.Приход = ЗНАЧЕНИЕ(Перечисление.ТипыДанныхУчета.Номенклатура)
	|				ТОГДА ИСТИНА
	|			ИНАЧЕ ЛОЖЬ
	|		КОНЕЦ) КАК ХозяйственнаяОперацияПрихода,
	|	(ВЫБОР
	|			КОГДА НастройкиХозопераций.Расход = ЗНАЧЕНИЕ(Перечисление.ТипыДанныхУчета.Номенклатура)
	|				ТОГДА ИСТИНА
	|			ИНАЧЕ ЛОЖЬ
	|		КОНЕЦ) КАК ХозяйственнаяОперацияРасхода}";
	
	ТекстЗапроса = СтрЗаменить(
		ТекстЗапроса, 
		"&ТекстЗапросаВесУпаковки", 
		Справочники.УпаковкиЕдиницыИзмерения.ТекстЗапросаВесУпаковки("КорАналитикаУчетаНоменклатуры.Номенклатура.ЕдиницаИзмерения", "КорАналитикаУчетаНоменклатуры.Номенклатура"));
		
	ТекстЗапроса = СтрЗаменить(
		ТекстЗапроса, 
		"&ТекстЗапросаОбъемУпаковки", 
		Справочники.УпаковкиЕдиницыИзмерения.ТекстЗапросаОбъемУпаковки("КорАналитикаУчетаНоменклатуры.Номенклатура.ЕдиницаИзмерения", "КорАналитикаУчетаНоменклатуры.Номенклатура"));
	
	Возврат ТекстЗапроса;
КонецФункции

Функция ТекстЗапросаДвиженияНоменклатураНоменклатураОборотыРасход()
	ТекстЗапроса = "
	|////////////////////////////////////////////////////////////////////////////////
	|ВЫБРАТЬ РАЗРЕШЕННЫЕ
	|	""ДвиженияНоменклатураНоменклатураОборотыРасход"" КАК НаборДанных,
	|	
	|	// Аналитика периодов
	|	НАЧАЛОПЕРИОДА(ДвиженияНоменклатураНоменклатураОборотыРасход.ПериодДень,      ДЕНЬ)      КАК ПериодДень,
	|	НАЧАЛОПЕРИОДА(ДвиженияНоменклатураНоменклатураОборотыРасход.ПериодНеделя,    НЕДЕЛЯ)    КАК ПериодНеделя,
	|	НАЧАЛОПЕРИОДА(ДвиженияНоменклатураНоменклатураОборотыРасход.ПериодДекада,    ДЕКАДА)    КАК ПериодДекада,
	|	НАЧАЛОПЕРИОДА(ДвиженияНоменклатураНоменклатураОборотыРасход.ПериодМесяц,     МЕСЯЦ)     КАК ПериодМесяц,
	|	НАЧАЛОПЕРИОДА(ДвиженияНоменклатураНоменклатураОборотыРасход.ПериодКвартал,   КВАРТАЛ)   КАК ПериодКвартал,
	|	НАЧАЛОПЕРИОДА(ДвиженияНоменклатураНоменклатураОборотыРасход.ПериодПолугодие, ПОЛУГОДИЕ) КАК ПериодПолугодие,
	|	НАЧАЛОПЕРИОДА(ДвиженияНоменклатураНоменклатураОборотыРасход.ПериодГод,       ГОД)       КАК ПериодГод,
	|	
	|	// Общая аналитика
	|	ДвиженияНоменклатураНоменклатураОборотыРасход.АналитикаУчетаНоменклатуры КАК АналитикаУчетаНоменклатуры,
	|	АналитикаНоменклатуры.Номенклатура                                          КАК Номенклатура,
	|	АналитикаНоменклатуры.Номенклатура.ЕдиницаИзмерения                         КАК ЕдиницаХранения,
	|	АналитикаНоменклатуры.Номенклатура.ЕдиницаДляОтчетов                        КАК ЕдиницаДляОтчетов,
	|	АналитикаНоменклатуры.Номенклатура.КоэффициентЕдиницыДляОтчетов КАК КоэффициентЕдиницыДляОтчетов,
	|	АналитикаНоменклатуры.Характеристика                                        КАК Характеристика,
	|	АналитикаНоменклатуры.Серия                                                 КАК Серия,
	|	АналитикаНоменклатуры.Склад                                                 КАК Склад,
	|	АналитикаНоменклатуры.Назначение                                            КАК Назначение,
	|	АналитикаНоменклатуры.Назначение.НаправлениеДеятельности                    КАК НаправлениеДеятельности,
	|	
	|	ДвиженияНоменклатураНоменклатураОборотыРасход.ВидЗапасов               КАК ВидЗапасов,
	|	NULL                                                                   КАК Партнер,
	|	NULL                                                                   КАК Менеджер,
	|	ДвиженияНоменклатураНоменклатураОборотыРасход.Подразделение            КАК Подразделение,
	|	NULL                                                                   КАК Сделка,
	|	
	|	ВЫБОР 
	|		КОГДА &ФормироватьВидыЗапасовПоГруппамФинансовогоУчета 
	|			ТОГДА ДвиженияНоменклатураНоменклатураОборотыРасход.ВидЗапасов.ГруппаФинансовогоУчета
	|			ИНАЧЕ АналитикаНоменклатуры.Номенклатура.ГруппаФинансовогоУчета
	|	КОНЕЦ КАК ГруппаФинансовогоУчета,
	|	
	|	ДвиженияНоменклатураНоменклатураОборотыРасход.Организация КАК Организация,
	|	
	|	// Аналитика оборотов
	|	NULL КАК СтатьяДоходов,
	|	NULL КАК СтатьяРасходов,
	|	NULL КАК СтатьяДоходовРасходов,
	|	NULL КАК АналитикаДоходов,
	|	NULL КАК АналитикаРасходов,
	|	NULL КАК АналитикаДоходовРасходов,
	|	NULL КАК Договор,
	|	NULL КАК Заказ,
	|	NULL КАК Контрагент,
	|	NULL КАК Соглашение,
	|	ДвиженияНоменклатураНоменклатураОборотыРасход.ТипЗапасов            КАК ТипЗапасов,
	|	НастройкиХозопераций.Ссылка                                         КАК ХозяйственнаяОперацияСправочник,
	|	ВЫБОР 
	|		КОГДА НастройкиХозопераций.Приход = ЗНАЧЕНИЕ(Перечисление.ТипыДанныхУчета.Номенклатура)
	|			ТОГДА ИСТИНА
	|			ИНАЧЕ ЛОЖЬ
	|	КОНЕЦ                                                               КАК ХозяйственнаяОперацияПрихода,
	|	ВЫБОР 
	|		КОГДА НастройкиХозопераций.Расход = ЗНАЧЕНИЕ(Перечисление.ТипыДанныхУчета.Номенклатура)
	|			ТОГДА ИСТИНА
	|			ИНАЧЕ ЛОЖЬ
	|	КОНЕЦ                                                               КАК ХозяйственнаяОперацияРасхода,
	|	
	|	// Показатель ""Количество""
	|	0 КАК Об_КоличествоНачальныйОстаток,
	|	0 КАК Об_КоличествоПриход,
	|	ВЫБОР 
	|		КОГДА &ЕдиницыКоличества = 0 
	|			ТОГДА 1
	|		КОГДА &ЕдиницыКоличества = 1 
	|			ТОГДА
	|				ВЫБОР 
	|					КОГДА АналитикаНоменклатуры.Номенклатура.КоэффициентЕдиницыДляОтчетов <> 0 
	|						ТОГДА 1 / АналитикаНоменклатуры.Номенклатура.КоэффициентЕдиницыДляОтчетов
	|						ИНАЧЕ 0
	|				КОНЕЦ
	|	КОНЕЦ * ДвиженияНоменклатураНоменклатураОборотыРасход.КоличествоОборот КАК Об_КоличествоРасход,
	|	0 КАК Об_КоличествоКонечныйОстаток,
	|	
	|	// Показатель ""Вес""
	|	0 КАК Об_ВесНачальныйОстаток,
	|	0 КАК Об_ВесПриход,
	|	ДвиженияНоменклатураНоменклатураОборотыРасход.КоличествоОборот * &ТекстЗапросаВесУпаковки КАК Об_ВесРасход,
	|	0 КАК Об_ВесКонечныйОстаток,
	|	
	|	// Показатель ""Объем""
	|	0 КАК Об_ОбъемНачальныйОстаток,
	|	0 КАК Об_ОбъемПриход,
	|	ДвиженияНоменклатураНоменклатураОборотыРасход.КоличествоОборот * &ТекстЗапросаОбъемУпаковки КАК Об_ОбъемРасход,
	|	0 КАК Об_ОбъемКонечныйОстаток,
	|	
	|	// Показатель ""Стоимость""
	|	0 КАК Об_СтоимостьПоступленияНачальныйОстаток,
	|	0 КАК Об_СтоимостьПоступленияПриход,
	| 	ВЫБОР 
	|		КОГДА &ДанныеОтчета = 1 
	|			ТОГДА ДвиженияНоменклатураНоменклатураОборотыРасход.СтоимостьОборот
	|		КОГДА &ДанныеОтчета = 2 
	|			ТОГДА ДвиженияНоменклатураНоменклатураОборотыРасход.СтоимостьБезНДСОборот
	|		КОГДА &ДанныеОтчета = 3 
	|			ТОГДА ДвиженияНоменклатураНоменклатураОборотыРасход.СтоимостьУпрОборот
	|		КОГДА &ДанныеОтчета = 4 
	|			ТОГДА ДвиженияНоменклатураНоменклатураОборотыРасход.СтоимостьРеглОборот
	|		ИНАЧЕ 
	|			ВЫБОР КОГДА &ПоПредприятию ТОГДА
	|				ДвиженияНоменклатураНоменклатураОборотыРасход.СтоимостьБезНДСОборот
	|			ИНАЧЕ
	|				ДвиженияНоменклатураНоменклатураОборотыРасход.СтоимостьУпрОборот
	|			КОНЕЦ
	|	КОНЕЦ КАК Об_СтоимостьПоступленияРасход,
	|	0 КАК Об_СтоимостьПоступленияКонечныйОстаток,
	|	
	|	// Показатель ""Доп. расходы""
	|	0 КАК Об_ДопРасходыНачальныйОстаток,
	|	0 КАК Об_ДопРасходыПриход,
	|	ВЫБОР 
	|		КОГДА &ДанныеОтчета = 1 
	|			ТОГДА ДвиженияНоменклатураНоменклатураОборотыРасход.ДопРасходыОборот
	|		КОГДА &ДанныеОтчета = 2 
	|			ТОГДА ДвиженияНоменклатураНоменклатураОборотыРасход.ДопРасходыБезНДСОборот
	|		КОГДА &ДанныеОтчета = 3 
	|			ТОГДА ДвиженияНоменклатураНоменклатураОборотыРасход.ДопРасходыУпрОборот
	|		КОГДА &ДанныеОтчета = 4 
	|			ТОГДА ДвиженияНоменклатураНоменклатураОборотыРасход.ДопРасходыРеглОборот
	|		ИНАЧЕ 
	|			ВЫБОР КОГДА &ПоПредприятию ТОГДА
	|				ДвиженияНоменклатураНоменклатураОборотыРасход.ДопРасходыБезНДСОборот
	|			ИНАЧЕ
	|				ДвиженияНоменклатураНоменклатураОборотыРасход.ДопРасходыУпрОборот
	|			КОНЕЦ
	|	КОНЕЦ КАК Об_ДопРасходыРасход,
	|	0 КАК Об_ДопРасходыКонечныйОстаток,
	|	
	|	// Показатель ""Трудозатраты""
	|	0 КАК Об_ТрудозатратыНачальныйОстаток,
	|	0 КАК Об_ТрудозатратыПриход,
	|	ВЫБОР 
	|		КОГДА &ДанныеОтчета = 1 
	|			ТОГДА ДвиженияНоменклатураНоменклатураОборотыРасход.ТрудозатратыОборот
	|		КОГДА &ДанныеОтчета = 2 
	|			ТОГДА ДвиженияНоменклатураНоменклатураОборотыРасход.ТрудозатратыОборот
	|		КОГДА &ДанныеОтчета = 3 
	|			ТОГДА ДвиженияНоменклатураНоменклатураОборотыРасход.ТрудозатратыУпрОборот
	|		КОГДА &ДанныеОтчета = 4 
	|			ТОГДА ДвиженияНоменклатураНоменклатураОборотыРасход.ТрудозатратыРеглОборот
	|		ИНАЧЕ 
	|			ВЫБОР КОГДА &ПоПредприятию ТОГДА
	|				ДвиженияНоменклатураНоменклатураОборотыРасход.ТрудозатратыОборот
	|			ИНАЧЕ
	|				ДвиженияНоменклатураНоменклатураОборотыРасход.ТрудозатратыУпрОборот
	|			КОНЕЦ
	|	КОНЕЦ КАК Об_ТрудозатратыРасход,
	|	0 КАК Об_ТрудозатратыКонечныйОстаток,
	|	
	|	// Показатель ""ПостатейныеПостоянные""
	|	0 КАК Об_ПостатейныеПостоянныеНачальныйОстаток,
	|	0 КАК Об_ПостатейныеПостоянныеПриход,
	|	ВЫБОР 
	|		КОГДА &ДанныеОтчета = 1 
	|			ТОГДА ДвиженияНоменклатураНоменклатураОборотыРасход.ПостатейныеПостоянныеСНДСОборот
	|		КОГДА &ДанныеОтчета = 2 
	|			ТОГДА ДвиженияНоменклатураНоменклатураОборотыРасход.ПостатейныеПостоянныеБезНДСОборот
	|		КОГДА &ДанныеОтчета = 3 
	|			ТОГДА ДвиженияНоменклатураНоменклатураОборотыРасход.ПостатейныеПостоянныеУпрОборот
	|		КОГДА &ДанныеОтчета = 4 
	|			ТОГДА ДвиженияНоменклатураНоменклатураОборотыРасход.ПостатейныеПостоянныеРеглОборот
	|		ИНАЧЕ 
	|			ВЫБОР КОГДА &ПоПредприятию ТОГДА
	|				ДвиженияНоменклатураНоменклатураОборотыРасход.ПостатейныеПостоянныеБезНДСОборот
	|			ИНАЧЕ
	|				ДвиженияНоменклатураНоменклатураОборотыРасход.ПостатейныеПостоянныеУпрОборот
	|			КОНЕЦ
	|	КОНЕЦ КАК Об_ПостатейныеПостоянныеРасход,
	|	0 КАК Об_ПостатейныеПостоянныеКонечныйОстаток,
	|	
	|	// Показатель ""ПостатейныеПеременные""
	|	0 КАК Об_ПостатейныеПеременныеНачальныйОстаток,
	|	0 КАК Об_ПостатейныеПеременныеПриход,
	|	ВЫБОР 
	|		КОГДА &ДанныеОтчета = 1 
	|			ТОГДА ДвиженияНоменклатураНоменклатураОборотыРасход.ПостатейныеПеременныеСНДСОборот
	|		КОГДА &ДанныеОтчета = 2 
	|			ТОГДА ДвиженияНоменклатураНоменклатураОборотыРасход.ПостатейныеПеременныеБезНДСОборот
	|		КОГДА &ДанныеОтчета = 3 
	|			ТОГДА ДвиженияНоменклатураНоменклатураОборотыРасход.ПостатейныеПеременныеУпрОборот
	|		КОГДА &ДанныеОтчета = 4 
	|			ТОГДА ДвиженияНоменклатураНоменклатураОборотыРасход.ПостатейныеПеременныеРеглОборот
	|		ИНАЧЕ 
	|			ВЫБОР КОГДА &ПоПредприятию ТОГДА
	|				ДвиженияНоменклатураНоменклатураОборотыРасход.ПостатейныеПеременныеБезНДСОборот
	|			ИНАЧЕ
	|				ДвиженияНоменклатураНоменклатураОборотыРасход.ПостатейныеПеременныеУпрОборот
	|			КОНЕЦ
	|	КОНЕЦ КАК Об_ПостатейныеПеременныеРасход,
	|	0 КАК Об_ПостатейныеПеременныеКонечныйОстаток,
	|
	|	// Показатель ""Себестоимость""
	|	0 КАК Об_СебестоимостьНачальныйОстаток,
	|	0 КАК Об_СебестоимостьПриход,
	|	ВЫБОР 
	|		КОГДА &ДанныеОтчета = 1 
	|			ТОГДА ДвиженияНоменклатураНоменклатураОборотыРасход.СтоимостьОборот
	|				+ ДвиженияНоменклатураНоменклатураОборотыРасход.ДопРасходыОборот
	|				+ ДвиженияНоменклатураНоменклатураОборотыРасход.ТрудозатратыОборот
	|				+ ДвиженияНоменклатураНоменклатураОборотыРасход.ПостатейныеПостоянныеСНДСОборот
	|				+ ДвиженияНоменклатураНоменклатураОборотыРасход.ПостатейныеПеременныеСНДСОборот
	|		КОГДА &ДанныеОтчета = 2 
	|			ТОГДА ДвиженияНоменклатураНоменклатураОборотыРасход.СтоимостьБезНДСОборот
	|				+ ДвиженияНоменклатураНоменклатураОборотыРасход.ДопРасходыБезНДСОборот
	|				+ ДвиженияНоменклатураНоменклатураОборотыРасход.ТрудозатратыОборот
	|				+ ДвиженияНоменклатураНоменклатураОборотыРасход.ПостатейныеПостоянныеБезНДСОборот
	|				+ ДвиженияНоменклатураНоменклатураОборотыРасход.ПостатейныеПеременныеБезНДСОборот
	|		КОГДА &ДанныеОтчета = 3 
	|			ТОГДА ДвиженияНоменклатураНоменклатураОборотыРасход.СтоимостьУпрОборот
	|				+ ДвиженияНоменклатураНоменклатураОборотыРасход.ДопРасходыУпрОборот
	|				+ ДвиженияНоменклатураНоменклатураОборотыРасход.ТрудозатратыУпрОборот
	|				+ ДвиженияНоменклатураНоменклатураОборотыРасход.ПостатейныеПостоянныеУпрОборот
	|				+ ДвиженияНоменклатураНоменклатураОборотыРасход.ПостатейныеПеременныеУпрОборот
	|		КОГДА &ДанныеОтчета = 4 
	|			ТОГДА ДвиженияНоменклатураНоменклатураОборотыРасход.СтоимостьРеглОборот
	|				+ ДвиженияНоменклатураНоменклатураОборотыРасход.ДопРасходыРеглОборот
	|				+ ДвиженияНоменклатураНоменклатураОборотыРасход.ТрудозатратыРеглОборот
	|				+ ДвиженияНоменклатураНоменклатураОборотыРасход.ПостатейныеПостоянныеРеглОборот
	|				+ ДвиженияНоменклатураНоменклатураОборотыРасход.ПостатейныеПеременныеРеглОборот
	|		ИНАЧЕ 
	|			ВЫБОР КОГДА &ПоПредприятию ТОГДА
	|				ДвиженияНоменклатураНоменклатураОборотыРасход.СтоимостьБезНДСОборот
	|				+ ДвиженияНоменклатураНоменклатураОборотыРасход.ДопРасходыБезНДСОборот
	|				+ ДвиженияНоменклатураНоменклатураОборотыРасход.ТрудозатратыОборот
	|				+ ДвиженияНоменклатураНоменклатураОборотыРасход.ПостатейныеПостоянныеБезНДСОборот
	|				+ ДвиженияНоменклатураНоменклатураОборотыРасход.ПостатейныеПеременныеБезНДСОборот
	|			ИНАЧЕ
	|				ДвиженияНоменклатураНоменклатураОборотыРасход.СтоимостьУпрОборот
	|				+ ДвиженияНоменклатураНоменклатураОборотыРасход.ДопРасходыУпрОборот
	|				+ ДвиженияНоменклатураНоменклатураОборотыРасход.ТрудозатратыУпрОборот
	|				+ ДвиженияНоменклатураНоменклатураОборотыРасход.ПостатейныеПостоянныеУпрОборот
	|				+ ДвиженияНоменклатураНоменклатураОборотыРасход.ПостатейныеПеременныеУпрОборот
	|			КОНЕЦ
	|	КОНЕЦ КАК Об_СебестоимостьРасход,
	|	0 КАК Об_СебестоимостьКонечныйОстаток,
	|
	|	// Показатель ""Налоговый учет""
	|	0 КАК Об_НалоговыйУчетНачальныйОстаток,
	|	0 КАК Об_НалоговыйУчетПриход,
	|	ВЫБОР 
	|		КОГДА &ДанныеОтчета = 1 ИЛИ &ДанныеОтчета = 2 ИЛИ &ДанныеОтчета = 3
	|			ТОГДА 0
	|		КОГДА &ДанныеОтчета = 4 
	|			ТОГДА ДвиженияНоменклатураНоменклатураОборотыРасход.СтоимостьРеглОборот
	|				+ ДвиженияНоменклатураНоменклатураОборотыРасход.ДопРасходыРеглОборот
	|				+ ДвиженияНоменклатураНоменклатураОборотыРасход.ТрудозатратыРеглОборот
	|				+ ДвиженияНоменклатураНоменклатураОборотыРасход.ПостатейныеПостоянныеРеглОборот
	|				+ ДвиженияНоменклатураНоменклатураОборотыРасход.ПостатейныеПеременныеРеглОборот
	|				- ДвиженияНоменклатураНоменклатураОборотыРасход.ПостояннаяРазницаОборот
	|				- ДвиженияНоменклатураНоменклатураОборотыРасход.ВременнаяРазницаОборот
	|		ИНАЧЕ 
	|			0
	|	КОНЕЦ КАК Об_НалоговыйУчетРасход,
	|	0 КАК Об_НалоговыйУчетКонечныйОстаток,
	|
	|	// Показатель ""Постоянная разница""
	|	0 КАК Об_ПостояннаяРазницаНачальныйОстаток,
	|	0 КАК Об_ПостояннаяРазницаПриход,
	|	ВЫБОР 
	|		КОГДА НастройкиХозопераций.Расход = ЗНАЧЕНИЕ(Перечисление.ТипыДанныхУчета.Номенклатура)
	|				И ДвиженияНоменклатураНоменклатураОборотыРасход.ПостояннаяРазницаОборот > 0
	|			ТОГДА 1
	|		КОГДА НастройкиХозопераций.Расход = ЗНАЧЕНИЕ(Перечисление.ТипыДанныхУчета.Номенклатура)
	|				И ДвиженияНоменклатураНоменклатураОборотыРасход.ПостояннаяРазницаОборот < 0
	|			ТОГДА -1
	|		ИНАЧЕ 0
	|	КОНЕЦ * ВЫБОР
	|		КОГДА &ДанныеОтчета = 1 ИЛИ &ДанныеОтчета = 2 ИЛИ &ДанныеОтчета = 4
	|			ТОГДА 0
	|		КОГДА &ДанныеОтчета = 4 
	|			ТОГДА ДвиженияНоменклатураНоменклатураОборотыРасход.ПостояннаяРазницаОборот
	|		ИНАЧЕ 
	|			0
	|	КОНЕЦ КАК Об_ПостояннаяРазницаРасход,
	|	0 КАК Об_ПостояннаяРазницаКонечныйОстаток,
	|
	|	// Показатель ""Временная разница""
	|	0 КАК Об_ВременнаяРазницаНачальныйОстаток,
	|	0 КАК Об_ВременнаяРазницаПриход,
	|	ВЫБОР 
	|		КОГДА НастройкиХозопераций.Расход = ЗНАЧЕНИЕ(Перечисление.ТипыДанныхУчета.Номенклатура)
	|				И ДвиженияНоменклатураНоменклатураОборотыРасход.ВременнаяРазницаОборот > 0
	|			ТОГДА 1
	|		КОГДА НастройкиХозопераций.Расход = ЗНАЧЕНИЕ(Перечисление.ТипыДанныхУчета.Номенклатура)
	|				И ДвиженияНоменклатураНоменклатураОборотыРасход.ВременнаяРазницаОборот < 0
	|			ТОГДА -1
	|		ИНАЧЕ 0
	|	КОНЕЦ * ВЫБОР
	|		КОГДА &ДанныеОтчета = 1 ИЛИ &ДанныеОтчета = 2 ИЛИ &ДанныеОтчета = 4
	|			ТОГДА 0
	|		КОГДА &ДанныеОтчета = 4 
	|			ТОГДА ДвиженияНоменклатураНоменклатураОборотыРасход.ВременнаяРазницаОборот
	|		ИНАЧЕ 
	|			0
	|	КОНЕЦ КАК ВременнаяРазницаРасход,
	|	0 КАК Об_ВременнаяРазницаКонечныйОстаток
	|	
	|ИЗ
	|	РегистрНакопления.ДвиженияНоменклатураНоменклатура.Обороты(
	|		{&НачалоПериода}, 
	|		{&КонецПериода}, 
	|		Авто, 
	|		{(АналитикаУчетаНоменклатуры.Номенклатура).* КАК Номенклатура, 
	|		 (АналитикаУчетаНоменклатуры.Номенклатура.ЕдиницаИзмерения).* КАК ЕдиницаИзмерения,
	|		 (АналитикаУчетаНоменклатуры.Номенклатура.ЕдиницаДляОтчетов).* КАК ЕдиницаДляОтчетов,
	|		 (АналитикаУчетаНоменклатуры.Характеристика).* КАК Характеристика,
	|		 (АналитикаУчетаНоменклатуры.Серия).* КАК Серия, 
	|		 (АналитикаУчетаНоменклатуры.Склад).* КАК Склад,
	|		 (АналитикаУчетаНоменклатуры.Назначение).* КАК Назначение, 
	|		 (АналитикаУчетаНоменклатуры.Назначение.НаправлениеДеятельности).* КАК НаправлениеДеятельности, 
	|		 (Организация).* КАК Организация,
	|		 (ВидЗапасов).* КАК ВидЗапасов,
	|		 (ТипЗапасов).* КАК ТипЗапасов
	|		}
	|	) КАК ДвиженияНоменклатураНоменклатураОборотыРасход
	|
	|		{ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.АналитикаУчетаНоменклатуры КАК АналитикаНоменклатуры
	|			ПО ДвиженияНоменклатураНоменклатураОборотыРасход.АналитикаУчетаНоменклатуры = АналитикаНоменклатуры.КлючАналитики
	|		}
	|
	|		ЛЕВОЕ СОЕДИНЕНИЕ Справочник.НастройкиХозяйственныхОпераций КАК НастройкиХозопераций
	|		ПО НастройкиХозопераций.ХозяйственнаяОперация = ДвиженияНоменклатураНоменклатураОборотыРасход.ХозяйственнаяОперация
	|ГДЕ 
	|	НЕ АналитикаНоменклатуры.Номенклатура.ТипНоменклатуры = ЗНАЧЕНИЕ(Перечисление.ТипыНоменклатуры.Услуга)
	|{ГДЕ
	|	((АналитикаНоменклатуры.Номенклатура, АналитикаНоменклатуры.Характеристика) В
	|			(ВЫБРАТЬ
	|				ОтборПоСегментуНоменклатуры.Номенклатура,
	|				ОтборПоСегментуНоменклатуры.Характеристика
	|			ИЗ
	|				ОтборПоСегментуНоменклатуры
	|			ГДЕ
	|				ОтборПоСегментуНоменклатуры.ИспользуетсяОтборПоСегментуНоменклатуры = &ИспользуетсяОтборПоСегментуНоменклатуры)),
	|	(""ДвиженияНоменклатураНоменклатураОборотыРасход"") КАК НаборДанных,
	|	НАЧАЛОПЕРИОДА(ДвиженияНоменклатураНоменклатураОборотыРасход.ПериодДень,      ДЕНЬ)      КАК ПериодДень,
	|	НАЧАЛОПЕРИОДА(ДвиженияНоменклатураНоменклатураОборотыРасход.ПериодНеделя,    НЕДЕЛЯ)    КАК ПериодНеделя,
	|	НАЧАЛОПЕРИОДА(ДвиженияНоменклатураНоменклатураОборотыРасход.ПериодДекада,    ДЕКАДА)    КАК ПериодДекада,
	|	НАЧАЛОПЕРИОДА(ДвиженияНоменклатураНоменклатураОборотыРасход.ПериодМесяц,     МЕСЯЦ)     КАК ПериодМесяц,
	|	НАЧАЛОПЕРИОДА(ДвиженияНоменклатураНоменклатураОборотыРасход.ПериодКвартал,   КВАРТАЛ)   КАК ПериодКвартал,
	|	НАЧАЛОПЕРИОДА(ДвиженияНоменклатураНоменклатураОборотыРасход.ПериодПолугодие, ПОЛУГОДИЕ) КАК ПериодПолугодие,
	|	НАЧАЛОПЕРИОДА(ДвиженияНоменклатураНоменклатураОборотыРасход.ПериодГод,       ГОД)       КАК ПериодГод,
	|	ДвиженияНоменклатураНоменклатураОборотыРасход.АналитикаУчетаНоменклатуры.*,
	|	(ВЫБОР
	|			КОГДА &ФормироватьВидыЗапасовПоГруппамФинансовогоУчета
	|				ТОГДА ДвиженияНоменклатураНоменклатураОборотыРасход.ВидЗапасов.ГруппаФинансовогоУчета
	|			ИНАЧЕ АналитикаНоменклатуры.Номенклатура.ГруппаФинансовогоУчета
	|		КОНЕЦ).* КАК ГруппаФинансовогоУчета,
	|	NULL КАК Заказ,
	|	НастройкиХозопераций.Ссылка.* КАК ХозяйственнаяОперацияСправочник,
	|	(ВЫБОР
	|			КОГДА НастройкиХозопераций.Приход = ЗНАЧЕНИЕ(Перечисление.ТипыДанныхУчета.Номенклатура)
	|				ТОГДА ИСТИНА
	|			ИНАЧЕ ЛОЖЬ
	|		КОНЕЦ) КАК ХозяйственнаяОперацияПрихода,
	|	(ВЫБОР
	|			КОГДА НастройкиХозопераций.Расход = ЗНАЧЕНИЕ(Перечисление.ТипыДанныхУчета.Номенклатура)
	|				ТОГДА ИСТИНА
	|			ИНАЧЕ ЛОЖЬ
	|		КОНЕЦ) КАК ХозяйственнаяОперацияРасхода}";
	
	ТекстЗапроса = СтрЗаменить(
		ТекстЗапроса, 
		"&ТекстЗапросаВесУпаковки", 
		Справочники.УпаковкиЕдиницыИзмерения.ТекстЗапросаВесУпаковки("АналитикаНоменклатуры.Номенклатура.ЕдиницаИзмерения", "АналитикаНоменклатуры.Номенклатура"));
		
	ТекстЗапроса = СтрЗаменить(
		ТекстЗапроса, 
		"&ТекстЗапросаОбъемУпаковки", 
		Справочники.УпаковкиЕдиницыИзмерения.ТекстЗапросаОбъемУпаковки("АналитикаНоменклатуры.Номенклатура.ЕдиницаИзмерения", "АналитикаНоменклатуры.Номенклатура"));
	
	Возврат ТекстЗапроса;
КонецФункции

Функция ТекстЗапросаДвиженияНоменклатураДоходыРасходыОбороты()
	ТекстЗапроса = "
	|////////////////////////////////////////////////////////////////////////////////
	|ВЫБРАТЬ РАЗРЕШЕННЫЕ
	|	""ДвиженияНоменклатураДоходыРасходыОбороты"" КАК НаборДанных,
	|	
	|	// Аналитика периодов
	|	НАЧАЛОПЕРИОДА(ДвиженияНоменклатураДоходыРасходыОбороты.ПериодДень,      ДЕНЬ)      КАК ПериодДень,
	|	НАЧАЛОПЕРИОДА(ДвиженияНоменклатураДоходыРасходыОбороты.ПериодНеделя,    НЕДЕЛЯ)    КАК ПериодНеделя,
	|	НАЧАЛОПЕРИОДА(ДвиженияНоменклатураДоходыРасходыОбороты.ПериодДекада,    ДЕКАДА)    КАК ПериодДекада,
	|	НАЧАЛОПЕРИОДА(ДвиженияНоменклатураДоходыРасходыОбороты.ПериодМесяц,     МЕСЯЦ)     КАК ПериодМесяц,
	|	НАЧАЛОПЕРИОДА(ДвиженияНоменклатураДоходыРасходыОбороты.ПериодКвартал,   КВАРТАЛ)   КАК ПериодКвартал,
	|	НАЧАЛОПЕРИОДА(ДвиженияНоменклатураДоходыРасходыОбороты.ПериодПолугодие, ПОЛУГОДИЕ) КАК ПериодПолугодие,
	|	НАЧАЛОПЕРИОДА(ДвиженияНоменклатураДоходыРасходыОбороты.ПериодГод,       ГОД)       КАК ПериодГод,
	|	
	|	// Общая аналитика
	|	ДвиженияНоменклатураДоходыРасходыОбороты.АналитикаУчетаНоменклатуры КАК АналитикаУчетаНоменклатуры,
	|	АналитикаНоменклатуры.Номенклатура                                  КАК Номенклатура,
	|	АналитикаНоменклатуры.Номенклатура.ЕдиницаИзмерения                 КАК ЕдиницаХранения,
	|	АналитикаНоменклатуры.Номенклатура.ЕдиницаДляОтчетов                КАК ЕдиницаДляОтчетов,
	|	АналитикаНоменклатуры.Номенклатура.КоэффициентЕдиницыДляОтчетов КАК КоэффициентЕдиницыДляОтчетов,
	|	АналитикаНоменклатуры.Характеристика                                КАК Характеристика,
	|	АналитикаНоменклатуры.Серия                                         КАК Серия,
	|	АналитикаНоменклатуры.Склад                                         КАК Склад,
	|	АналитикаНоменклатуры.Назначение                                    КАК Назначение,
	|	АналитикаНоменклатуры.Назначение.НаправлениеДеятельности            КАК НаправлениеДеятельности,
	|	
	|	ДвиженияНоменклатураДоходыРасходыОбороты.ВидЗапасов               КАК ВидЗапасов,
	|	NULL                                                              КАК Партнер,
	|	NULL                                                              КАК Менеджер,
	|	ДвиженияНоменклатураДоходыРасходыОбороты.Подразделение            КАК Подразделение,
	|	NULL                                                              КАК Сделка,
	|	
	|	ВЫБОР 
	|		КОГДА &ФормироватьВидыЗапасовПоГруппамФинансовогоУчета 
	|			ТОГДА ДвиженияНоменклатураДоходыРасходыОбороты.ВидЗапасов.ГруппаФинансовогоУчета
	|			ИНАЧЕ АналитикаНоменклатуры.Номенклатура.ГруппаФинансовогоУчета
	|	КОНЕЦ КАК ГруппаФинансовогоУчета,
	|	
	|	ДвиженияНоменклатураДоходыРасходыОбороты.Организация КАК Организация,
	|	
	|	// Аналитика оборотов
	|	ВЫБОР
	|		КОГДА ДвиженияНоменклатураДоходыРасходыОбороты.СтатьяДоходовРасходов Ссылка ПланВидовХарактеристик.СтатьиДоходов
	|			ТОГДА ДвиженияНоменклатураДоходыРасходыОбороты.СтатьяДоходовРасходов
	|			ИНАЧЕ NULL
	|	КОНЕЦ                                                             КАК СтатьяДоходов,
	|	ВЫБОР
	|		КОГДА ДвиженияНоменклатураДоходыРасходыОбороты.СтатьяДоходовРасходов Ссылка ПланВидовХарактеристик.СтатьиРасходов
	|			ТОГДА ДвиженияНоменклатураДоходыРасходыОбороты.СтатьяДоходовРасходов
	|			ИНАЧЕ NULL
	|	КОНЕЦ                                                             КАК СтатьяРасходов,
	|	ДвиженияНоменклатураДоходыРасходыОбороты.СтатьяДоходовРасходов    КАК СтатьяДоходовРасходов,
	|	ДвиженияНоменклатураДоходыРасходыОбороты.АналитикаДоходов         КАК АналитикаДоходов,
	|	ДвиженияНоменклатураДоходыРасходыОбороты.АналитикаРасходов        КАК АналитикаРасходов,
	|	ВЫБОР
	|		КОГДА НЕ ТИПЗНАЧЕНИЯ(ДвиженияНоменклатураДоходыРасходыОбороты.АналитикаДоходов) ЕСТЬ NULL
	|			ТОГДА ДвиженияНоменклатураДоходыРасходыОбороты.АналитикаДоходов
	|		КОГДА НЕ ТИПЗНАЧЕНИЯ(ДвиженияНоменклатураДоходыРасходыОбороты.АналитикаРасходов) ЕСТЬ NULL
	|			ТОГДА ДвиженияНоменклатураДоходыРасходыОбороты.АналитикаРасходов
	|	КОНЕЦ                                                             КАК АналитикаДоходовРасходов,
	|	NULL                                                              КАК Договор,
	|	NULL                                                              КАК Заказ,
	|	NULL                                                              КАК Контрагент,
	|	NULL                                                              КАК Соглашение,
	|	ДвиженияНоменклатураДоходыРасходыОбороты.ТипЗапасов               КАК ТипЗапасов,
	|	НастройкиХозопераций.Ссылка                                       КАК ХозяйственнаяОперацияСправочник,
	|	ВЫБОР 
	|		КОГДА НастройкиХозопераций.Приход = ЗНАЧЕНИЕ(Перечисление.ТипыДанныхУчета.Номенклатура)
	|			ТОГДА ИСТИНА
	|			ИНАЧЕ ЛОЖЬ
	|	КОНЕЦ                                                             КАК ХозяйственнаяОперацияПрихода,
	|	ВЫБОР 
	|		КОГДА НастройкиХозопераций.Расход = ЗНАЧЕНИЕ(Перечисление.ТипыДанныхУчета.Номенклатура)
	|			ТОГДА ИСТИНА
	|			ИНАЧЕ ЛОЖЬ
	|	КОНЕЦ                                                             КАК ХозяйственнаяОперацияРасхода,
	|	
	|	// Показатель ""Количество""
	|	0 КАК Об_КоличествоНачальныйОстаток,
	|	ВЫБОР 
	|		КОГДА НастройкиХозопераций.Приход = ЗНАЧЕНИЕ(Перечисление.ТипыДанныхУчета.Номенклатура)
	|			ТОГДА 1
	|			ИНАЧЕ 0
	|	КОНЕЦ * ВЫБОР 
	|		КОГДА &ЕдиницыКоличества = 0 
	|			ТОГДА 1
	|		КОГДА &ЕдиницыКоличества = 1 
	|			ТОГДА
	|				ВЫБОР 
	|					КОГДА АналитикаНоменклатуры.Номенклатура.КоэффициентЕдиницыДляОтчетов <> 0 
	|						ТОГДА 1 / АналитикаНоменклатуры.Номенклатура.КоэффициентЕдиницыДляОтчетов
	|						ИНАЧЕ 0
	|				КОНЕЦ
	|	КОНЕЦ * ДвиженияНоменклатураДоходыРасходыОбороты.КоличествоОборот КАК Об_КоличествоПриход,
	|	ВЫБОР 
	|		КОГДА НастройкиХозопераций.Расход = ЗНАЧЕНИЕ(Перечисление.ТипыДанныхУчета.Номенклатура)
	|			ТОГДА 1
	|			ИНАЧЕ 0
	|	КОНЕЦ * ВЫБОР 
	|		КОГДА &ЕдиницыКоличества = 0 
	|			ТОГДА 1
	|		КОГДА &ЕдиницыКоличества = 1 
	|			ТОГДА
	|				ВЫБОР 
	|					КОГДА АналитикаНоменклатуры.Номенклатура.КоэффициентЕдиницыДляОтчетов <> 0 
	|						ТОГДА 1 / АналитикаНоменклатуры.Номенклатура.КоэффициентЕдиницыДляОтчетов
	|						ИНАЧЕ 0
	|				КОНЕЦ
	|	КОНЕЦ * ДвиженияНоменклатураДоходыРасходыОбороты.КоличествоОборот КАК Об_КоличествоРасход,
	|	0 КАК Об_КоличествоКонечныйОстаток,
	|	
	|	// Показатель ""Вес""
	|	0 КАК Об_ВесНачальныйОстаток,
	|	ВЫБОР 
	|		КОГДА НастройкиХозопераций.Приход = ЗНАЧЕНИЕ(Перечисление.ТипыДанныхУчета.Номенклатура)
	|			ТОГДА 1
	|			ИНАЧЕ 0
	|	КОНЕЦ * ДвиженияНоменклатураДоходыРасходыОбороты.КоличествоОборот * &ТекстЗапросаВесУпаковки   КАК Об_ВесПриход,
	|	ВЫБОР 
	|		КОГДА НастройкиХозопераций.Расход = ЗНАЧЕНИЕ(Перечисление.ТипыДанныхУчета.Номенклатура)
	|			ТОГДА 1
	|			ИНАЧЕ 0
	|	КОНЕЦ * ДвиженияНоменклатураДоходыРасходыОбороты.КоличествоОборот * &ТекстЗапросаВесУпаковки   КАК Об_ВесРасход,
	|	0 КАК Об_ВесКонечныйОстаток,
	|	
	|	// Показатель ""Объем""
	|	0 КАК Об_ОбъемНачальныйОстаток,
	|	ВЫБОР 
	|		КОГДА НастройкиХозопераций.Приход = ЗНАЧЕНИЕ(Перечисление.ТипыДанныхУчета.Номенклатура)
	|			ТОГДА 1
	|			ИНАЧЕ 0
	|	КОНЕЦ * ДвиженияНоменклатураДоходыРасходыОбороты.КоличествоОборот * &ТекстЗапросаОбъемУпаковки КАК Об_ОбъемПриход,
	|	ВЫБОР 
	|		КОГДА НастройкиХозопераций.Расход = ЗНАЧЕНИЕ(Перечисление.ТипыДанныхУчета.Номенклатура)
	|			ТОГДА 1
	|			ИНАЧЕ 0
	|	КОНЕЦ * ДвиженияНоменклатураДоходыРасходыОбороты.КоличествоОборот * &ТекстЗапросаОбъемУпаковки КАК Об_ОбъемРасход,
	|	0 КАК Об_ОбъемКонечныйОстаток,
	|	
	|	// Показатель ""Стоимость""
	|	0 КАК Об_СтоимостьПоступленияНачальныйОстаток,
	|	0 КАК Об_СтоимостьПоступленияПриход,
	|	0 КАК Об_СтоимостьПоступленияРасход,
	|	0 КАК Об_СтоимостьПоступленияКонечныйОстаток,
	|	
	|	// Показатель ""Доп. расходы""
	|	0 КАК Об_ДопРасходыНачальныйОстаток,
	|	ВЫБОР 
	|		КОГДА &ДанныеОтчета = 1 
	|			ТОГДА ДвиженияНоменклатураДоходыРасходыОбороты.ДопРасходыОборот
	|		КОГДА &ДанныеОтчета = 2 
	|			ТОГДА ДвиженияНоменклатураДоходыРасходыОбороты.ДопРасходыБезНДСОборот
	|		КОГДА &ДанныеОтчета = 3 
	|			ТОГДА ДвиженияНоменклатураДоходыРасходыОбороты.ДопРасходыУпрОборот
	|		КОГДА &ДанныеОтчета = 4 
	|			ТОГДА ДвиженияНоменклатураДоходыРасходыОбороты.ДопРасходыРеглОборот
	|		ИНАЧЕ 
	|			ВЫБОР КОГДА &ПоПредприятию ТОГДА
	|				ДвиженияНоменклатураДоходыРасходыОбороты.ДопРасходыБезНДСОборот
	|			ИНАЧЕ
	|				ДвиженияНоменклатураДоходыРасходыОбороты.ДопРасходыУпрОборот
	|			КОНЕЦ
	|	КОНЕЦ КАК Об_ДопРасходыПриход,
	|	ВЫБОР 
	|		КОГДА &ДанныеОтчета = 1 
	|			ТОГДА ДвиженияНоменклатураДоходыРасходыОбороты.ДопРасходыОборот
	|		КОГДА &ДанныеОтчета = 2 
	|			ТОГДА ДвиженияНоменклатураДоходыРасходыОбороты.ДопРасходыБезНДСОборот
	|		КОГДА &ДанныеОтчета = 3 
	|			ТОГДА ДвиженияНоменклатураДоходыРасходыОбороты.ДопРасходыУпрОборот
	|		КОГДА &ДанныеОтчета = 4 
	|			ТОГДА ДвиженияНоменклатураДоходыРасходыОбороты.ДопРасходыРеглОборот
	|		ИНАЧЕ 
	|			ВЫБОР КОГДА &ПоПредприятию ТОГДА
	|				ДвиженияНоменклатураДоходыРасходыОбороты.ДопРасходыБезНДСОборот
	|			ИНАЧЕ
	|				ДвиженияНоменклатураДоходыРасходыОбороты.ДопРасходыУпрОборот
	|			КОНЕЦ
	|	КОНЕЦ КАК Об_ДопРасходыРасход,
	|	0 КАК Об_ДопРасходыКонечныйОстаток,
	|	
	|	// Показатель ""Трудозатраты""
	|	0 КАК Об_ТрудозатратыНачальныйОстаток,
	|	ВЫБОР 
	|		КОГДА &ДанныеОтчета = 1 
	|			ТОГДА ДвиженияНоменклатураДоходыРасходыОбороты.ТрудозатратыОборот
	|		КОГДА &ДанныеОтчета = 2 
	|			ТОГДА ДвиженияНоменклатураДоходыРасходыОбороты.ТрудозатратыОборот
	|		КОГДА &ДанныеОтчета = 3 
	|			ТОГДА ДвиженияНоменклатураДоходыРасходыОбороты.ТрудозатратыУпрОборот
	|		КОГДА &ДанныеОтчета = 4 
	|			ТОГДА ДвиженияНоменклатураДоходыРасходыОбороты.ТрудозатратыРеглОборот
	|		ИНАЧЕ 
	|			ВЫБОР КОГДА &ПоПредприятию ТОГДА
	|				ДвиженияНоменклатураДоходыРасходыОбороты.ТрудозатратыОборот
	|			ИНАЧЕ
	|				ДвиженияНоменклатураДоходыРасходыОбороты.ТрудозатратыУпрОборот
	|			КОНЕЦ
	|	КОНЕЦ КАК Об_ТрудозатратыПриход,
	|	ВЫБОР 
	|		КОГДА &ДанныеОтчета = 1 
	|			ТОГДА ДвиженияНоменклатураДоходыРасходыОбороты.ТрудозатратыОборот
	|		КОГДА &ДанныеОтчета = 2 
	|			ТОГДА ДвиженияНоменклатураДоходыРасходыОбороты.ТрудозатратыОборот
	|		КОГДА &ДанныеОтчета = 3 
	|			ТОГДА ДвиженияНоменклатураДоходыРасходыОбороты.ТрудозатратыУпрОборот
	|		КОГДА &ДанныеОтчета = 4 
	|			ТОГДА ДвиженияНоменклатураДоходыРасходыОбороты.ТрудозатратыРеглОборот
	|		ИНАЧЕ 
	|			ВЫБОР КОГДА &ПоПредприятию ТОГДА
	|				ДвиженияНоменклатураДоходыРасходыОбороты.ТрудозатратыОборот
	|			ИНАЧЕ
	|				ДвиженияНоменклатураДоходыРасходыОбороты.ТрудозатратыУпрОборот
	|			КОНЕЦ
	|	КОНЕЦ КАК Об_ТрудозатратыРасход,
	|	0 КАК Об_ТрудозатратыКонечныйОстаток,
	|	
	|	// Показатель ""ПостатейныеПостоянные""
	|	0 КАК Об_ПостатейныеПостоянныеНачальныйОстаток,
	|	ВЫБОР 
	|		КОГДА &ДанныеОтчета = 1 
	|			ТОГДА ДвиженияНоменклатураДоходыРасходыОбороты.ПостатейныеПостоянныеСНДСОборот
	|		КОГДА &ДанныеОтчета = 2 
	|			ТОГДА ДвиженияНоменклатураДоходыРасходыОбороты.ПостатейныеПостоянныеБезНДСОборот
	|		КОГДА &ДанныеОтчета = 3 
	|			ТОГДА ДвиженияНоменклатураДоходыРасходыОбороты.ПостатейныеПостоянныеУпрОборот
	|		КОГДА &ДанныеОтчета = 4 
	|			ТОГДА ДвиженияНоменклатураДоходыРасходыОбороты.ПостатейныеПостоянныеРеглОборот
	|		ИНАЧЕ 
	|			ВЫБОР КОГДА &ПоПредприятию ТОГДА
	|				ДвиженияНоменклатураДоходыРасходыОбороты.ПостатейныеПостоянныеБезНДСОборот
	|			ИНАЧЕ
	|				ДвиженияНоменклатураДоходыРасходыОбороты.ПостатейныеПостоянныеУпрОборот
	|			КОНЕЦ
	|	КОНЕЦ КАК Об_ПостатейныеПостоянныеПриход,
	|	ВЫБОР 
	|		КОГДА &ДанныеОтчета = 1 
	|			ТОГДА ДвиженияНоменклатураДоходыРасходыОбороты.ПостатейныеПостоянныеСНДСОборот
	|		КОГДА &ДанныеОтчета = 2 
	|			ТОГДА ДвиженияНоменклатураДоходыРасходыОбороты.ПостатейныеПостоянныеБезНДСОборот
	|		КОГДА &ДанныеОтчета = 3 
	|			ТОГДА ДвиженияНоменклатураДоходыРасходыОбороты.ПостатейныеПостоянныеУпрОборот
	|		КОГДА &ДанныеОтчета = 4 
	|			ТОГДА ДвиженияНоменклатураДоходыРасходыОбороты.ПостатейныеПостоянныеРеглОборот
	|		ИНАЧЕ 
	|			ВЫБОР КОГДА &ПоПредприятию ТОГДА
	|				ДвиженияНоменклатураДоходыРасходыОбороты.ПостатейныеПостоянныеБезНДСОборот
	|			ИНАЧЕ
	|				ДвиженияНоменклатураДоходыРасходыОбороты.ПостатейныеПостоянныеУпрОборот
	|			КОНЕЦ
	|	КОНЕЦ КАК Об_ПостатейныеПостоянныеРасход,
	|	0 КАК Об_ПостатейныеПостоянныеКонечныйОстаток,
	|	
	|	// Показатель ""ПостатейныеПеременные""
	|	0 КАК Об_ПостатейныеПеременныеНачальныйОстаток,
	|	ВЫБОР 
	|		КОГДА &ДанныеОтчета = 1 
	|			ТОГДА ДвиженияНоменклатураДоходыРасходыОбороты.ПостатейныеПеременныеСНДСОборот
	|		КОГДА &ДанныеОтчета = 2 
	|			ТОГДА ДвиженияНоменклатураДоходыРасходыОбороты.ПостатейныеПеременныеБезНДСОборот
	|		КОГДА &ДанныеОтчета = 3 
	|			ТОГДА ДвиженияНоменклатураДоходыРасходыОбороты.ПостатейныеПеременныеУпрОборот
	|		КОГДА &ДанныеОтчета = 4 
	|			ТОГДА ДвиженияНоменклатураДоходыРасходыОбороты.ПостатейныеПеременныеРеглОборот
	|		ИНАЧЕ 
	|			ВЫБОР КОГДА &ПоПредприятию ТОГДА
	|				ДвиженияНоменклатураДоходыРасходыОбороты.ПостатейныеПеременныеБезНДСОборот
	|			ИНАЧЕ
	|				ДвиженияНоменклатураДоходыРасходыОбороты.ПостатейныеПеременныеУпрОборот
	|			КОНЕЦ
	|	КОНЕЦ КАК Об_ПостатейныеПеременныеПриход,
	|	ВЫБОР 
	|		КОГДА &ДанныеОтчета = 1 
	|			ТОГДА ДвиженияНоменклатураДоходыРасходыОбороты.ПостатейныеПеременныеСНДСОборот
	|		КОГДА &ДанныеОтчета = 2 
	|			ТОГДА ДвиженияНоменклатураДоходыРасходыОбороты.ПостатейныеПеременныеБезНДСОборот
	|		КОГДА &ДанныеОтчета = 3 
	|			ТОГДА ДвиженияНоменклатураДоходыРасходыОбороты.ПостатейныеПеременныеУпрОборот
	|		КОГДА &ДанныеОтчета = 4 
	|			ТОГДА ДвиженияНоменклатураДоходыРасходыОбороты.ПостатейныеПеременныеРеглОборот
	|		ИНАЧЕ 
	|			ВЫБОР КОГДА &ПоПредприятию ТОГДА
	|				ДвиженияНоменклатураДоходыРасходыОбороты.ПостатейныеПеременныеБезНДСОборот
	|			ИНАЧЕ
	|				ДвиженияНоменклатураДоходыРасходыОбороты.ПостатейныеПеременныеУпрОборот
	|			КОНЕЦ
	|	КОНЕЦ КАК Об_ПостатейныеПеременныеРасход,
	|	0 КАК Об_ПостатейныеПеременныеКонечныйОстаток,
	|
	|	// Показатель ""Себестоимость""
	|	0 КАК Об_СебестоимостьНачальныйОстаток,
	|	ВЫБОР 
	|		КОГДА &ДанныеОтчета = 1 
	|			ТОГДА ДвиженияНоменклатураДоходыРасходыОбороты.СтоимостьОборот
	|				+ ДвиженияНоменклатураДоходыРасходыОбороты.ДопРасходыОборот
	|				+ ДвиженияНоменклатураДоходыРасходыОбороты.ТрудозатратыОборот
	|				+ ДвиженияНоменклатураДоходыРасходыОбороты.ПостатейныеПостоянныеСНДСОборот
	|				+ ДвиженияНоменклатураДоходыРасходыОбороты.ПостатейныеПеременныеСНДСОборот
	|		КОГДА &ДанныеОтчета = 2 
	|			ТОГДА ДвиженияНоменклатураДоходыРасходыОбороты.СтоимостьБезНДСОборот 
	|				+ ДвиженияНоменклатураДоходыРасходыОбороты.ДопРасходыБезНДСОборот
	|				+ ДвиженияНоменклатураДоходыРасходыОбороты.ТрудозатратыОборот
	|				+ ДвиженияНоменклатураДоходыРасходыОбороты.ПостатейныеПостоянныеБезНДСОборот
	|				+ ДвиженияНоменклатураДоходыРасходыОбороты.ПостатейныеПеременныеБезНДСОборот
	|		КОГДА &ДанныеОтчета = 3 
	|			ТОГДА ДвиженияНоменклатураДоходыРасходыОбороты.СтоимостьУпрОборот
	|				+ ДвиженияНоменклатураДоходыРасходыОбороты.ДопРасходыУпрОборот
	|				+ ДвиженияНоменклатураДоходыРасходыОбороты.ТрудозатратыУпрОборот
	|				+ ДвиженияНоменклатураДоходыРасходыОбороты.ПостатейныеПостоянныеУпрОборот
	|				+ ДвиженияНоменклатураДоходыРасходыОбороты.ПостатейныеПеременныеУпрОборот
	|		КОГДА &ДанныеОтчета = 4 
	|			ТОГДА ДвиженияНоменклатураДоходыРасходыОбороты.СтоимостьРеглОборот
	|				+ ДвиженияНоменклатураДоходыРасходыОбороты.ДопРасходыРеглОборот
	|				+ ДвиженияНоменклатураДоходыРасходыОбороты.ТрудозатратыРеглОборот
	|				+ ДвиженияНоменклатураДоходыРасходыОбороты.ПостатейныеПостоянныеРеглОборот
	|				+ ДвиженияНоменклатураДоходыРасходыОбороты.ПостатейныеПеременныеРеглОборот
	|		ИНАЧЕ 
	|			ВЫБОР КОГДА &ПоПредприятию ТОГДА
	|				ДвиженияНоменклатураДоходыРасходыОбороты.СтоимостьБезНДСОборот
	|				+ ДвиженияНоменклатураДоходыРасходыОбороты.ДопРасходыБезНДСОборот
	|				+ ДвиженияНоменклатураДоходыРасходыОбороты.ТрудозатратыОборот
	|				+ ДвиженияНоменклатураДоходыРасходыОбороты.ПостатейныеПостоянныеБезНДСОборот
	|				+ ДвиженияНоменклатураДоходыРасходыОбороты.ПостатейныеПеременныеБезНДСОборот
	|			ИНАЧЕ
	|				ДвиженияНоменклатураДоходыРасходыОбороты.СтоимостьУпрОборот
	|				+ ДвиженияНоменклатураДоходыРасходыОбороты.ДопРасходыУпрОборот
	|				+ ДвиженияНоменклатураДоходыРасходыОбороты.ТрудозатратыУпрОборот
	|				+ ДвиженияНоменклатураДоходыРасходыОбороты.ПостатейныеПостоянныеУпрОборот
	|				+ ДвиженияНоменклатураДоходыРасходыОбороты.ПостатейныеПеременныеУпрОборот
	|			КОНЕЦ
	|	КОНЕЦ КАК Об_СебестоимостьПриход,
	|	ВЫБОР 
	|		КОГДА &ДанныеОтчета = 1 
	|			ТОГДА ДвиженияНоменклатураДоходыРасходыОбороты.СтоимостьОборот 
	|				+ ДвиженияНоменклатураДоходыРасходыОбороты.ДопРасходыОборот
	|				+ ДвиженияНоменклатураДоходыРасходыОбороты.ТрудозатратыОборот
	|				+ ДвиженияНоменклатураДоходыРасходыОбороты.ПостатейныеПостоянныеСНДСОборот
	|				+ ДвиженияНоменклатураДоходыРасходыОбороты.ПостатейныеПеременныеСНДСОборот
	|		КОГДА &ДанныеОтчета = 2 
	|			ТОГДА ДвиженияНоменклатураДоходыРасходыОбороты.СтоимостьБезНДСОборот 
	|				+ ДвиженияНоменклатураДоходыРасходыОбороты.ДопРасходыБезНДСОборот
	|				+ ДвиженияНоменклатураДоходыРасходыОбороты.ТрудозатратыОборот
	|				+ ДвиженияНоменклатураДоходыРасходыОбороты.ПостатейныеПостоянныеБезНДСОборот
	|				+ ДвиженияНоменклатураДоходыРасходыОбороты.ПостатейныеПеременныеБезНДСОборот
	|		КОГДА &ДанныеОтчета = 3 
	|			ТОГДА ДвиженияНоменклатураДоходыРасходыОбороты.СтоимостьУпрОборот
	|				+ ДвиженияНоменклатураДоходыРасходыОбороты.ДопРасходыУпрОборот
	|				+ ДвиженияНоменклатураДоходыРасходыОбороты.ТрудозатратыУпрОборот
	|				+ ДвиженияНоменклатураДоходыРасходыОбороты.ПостатейныеПостоянныеУпрОборот
	|				+ ДвиженияНоменклатураДоходыРасходыОбороты.ПостатейныеПеременныеУпрОборот
	|		КОГДА &ДанныеОтчета = 4 
	|			ТОГДА ДвиженияНоменклатураДоходыРасходыОбороты.СтоимостьРеглОборот
	|				+ ДвиженияНоменклатураДоходыРасходыОбороты.ДопРасходыРеглОборот
	|				+ ДвиженияНоменклатураДоходыРасходыОбороты.ТрудозатратыРеглОборот
	|				+ ДвиженияНоменклатураДоходыРасходыОбороты.ПостатейныеПостоянныеРеглОборот
	|				+ ДвиженияНоменклатураДоходыРасходыОбороты.ПостатейныеПеременныеРеглОборот
	|		ИНАЧЕ 
	|			ВЫБОР КОГДА &ПоПредприятию ТОГДА
	|				ДвиженияНоменклатураДоходыРасходыОбороты.СтоимостьБезНДСОборот
	|				+ ДвиженияНоменклатураДоходыРасходыОбороты.ДопРасходыБезНДСОборот
	|				+ ДвиженияНоменклатураДоходыРасходыОбороты.ТрудозатратыОборот
	|				+ ДвиженияНоменклатураДоходыРасходыОбороты.ПостатейныеПостоянныеБезНДСОборот
	|				+ ДвиженияНоменклатураДоходыРасходыОбороты.ПостатейныеПеременныеБезНДСОборот
	|			ИНАЧЕ
	|				ДвиженияНоменклатураДоходыРасходыОбороты.СтоимостьУпрОборот
	|				+ ДвиженияНоменклатураДоходыРасходыОбороты.ДопРасходыУпрОборот
	|				+ ДвиженияНоменклатураДоходыРасходыОбороты.ТрудозатратыУпрОборот
	|				+ ДвиженияНоменклатураДоходыРасходыОбороты.ПостатейныеПостоянныеУпрОборот
	|				+ ДвиженияНоменклатураДоходыРасходыОбороты.ПостатейныеПеременныеУпрОборот
	|			КОНЕЦ
	|	КОНЕЦ КАК Об_СебестоимостьРасход,
	|	0 КАК Об_СебестоимостьКонечныйОстаток,
	|
	|	// Показатель ""Налоговый учет""
	|	0 КАК Об_НалоговыйУчетНачальныйОстаток,
	|	ВЫБОР 
	|		КОГДА &ДанныеОтчета = 1 ИЛИ &ДанныеОтчета = 2 ИЛИ &ДанныеОтчета = 3
	|			ТОГДА 0
	|		КОГДА &ДанныеОтчета = 4 
	|			ТОГДА ДвиженияНоменклатураДоходыРасходыОбороты.СтоимостьРеглОборот
	|				+ ДвиженияНоменклатураДоходыРасходыОбороты.ДопРасходыРеглОборот
	|				+ ДвиженияНоменклатураДоходыРасходыОбороты.ТрудозатратыРеглОборот
	|				+ ДвиженияНоменклатураДоходыРасходыОбороты.ПостатейныеПостоянныеРеглОборот
	|				+ ДвиженияНоменклатураДоходыРасходыОбороты.ПостатейныеПеременныеРеглОборот
	|				- ДвиженияНоменклатураДоходыРасходыОбороты.ПостояннаяРазницаОборот
	|				- ДвиженияНоменклатураДоходыРасходыОбороты.ВременнаяРазницаОборот
	|		ИНАЧЕ 
	|			0
	|	КОНЕЦ КАК Об_НалоговыйУчетПриход,
	|	ВЫБОР 
	|		КОГДА &ДанныеОтчета = 1 ИЛИ &ДанныеОтчета = 2 ИЛИ &ДанныеОтчета = 3
	|			ТОГДА 0
	|		КОГДА &ДанныеОтчета = 4 
	|			ТОГДА ДвиженияНоменклатураДоходыРасходыОбороты.СтоимостьРеглОборот
	|				+ ДвиженияНоменклатураДоходыРасходыОбороты.ДопРасходыРеглОборот
	|				+ ДвиженияНоменклатураДоходыРасходыОбороты.ТрудозатратыРеглОборот
	|				+ ДвиженияНоменклатураДоходыРасходыОбороты.ПостатейныеПостоянныеРеглОборот
	|				+ ДвиженияНоменклатураДоходыРасходыОбороты.ПостатейныеПеременныеРеглОборот
	|				- ДвиженияНоменклатураДоходыРасходыОбороты.ПостояннаяРазницаОборот
	|				- ДвиженияНоменклатураДоходыРасходыОбороты.ВременнаяРазницаОборот
	|		ИНАЧЕ 
	|			0
	|	КОНЕЦ КАК Об_НалоговыйУчетРасход,
	|	0 КАК Об_НалоговыйУчетКонечныйОстаток,
	|
	|	// Показатель ""Постоянная разница""
	|	0 КАК Об_ПостояннаяРазницаНачальныйОстаток,
	|	ВЫБОР 
	|		КОГДА НастройкиХозопераций.Приход = ЗНАЧЕНИЕ(Перечисление.ТипыДанныхУчета.Номенклатура)
	|				И ДвиженияНоменклатураДоходыРасходыОбороты.ПостояннаяРазницаОборот > 0
	|			ТОГДА 1
	|		КОГДА НастройкиХозопераций.Приход = ЗНАЧЕНИЕ(Перечисление.ТипыДанныхУчета.Номенклатура)
	|				И ДвиженияНоменклатураДоходыРасходыОбороты.ПостояннаяРазницаОборот < 0
	|			ТОГДА -1
	|		ИНАЧЕ 0
	|	КОНЕЦ * ВЫБОР
	|		КОГДА &ДанныеОтчета = 1 ИЛИ &ДанныеОтчета = 2 ИЛИ &ДанныеОтчета = 4
	|			ТОГДА 0
	|		КОГДА &ДанныеОтчета = 4 
	|			ТОГДА ДвиженияНоменклатураДоходыРасходыОбороты.ПостояннаяРазницаОборот
	|		ИНАЧЕ 
	|			0
	|	КОНЕЦ КАК Об_ПостояннаяРазницаПриход,
	|	ВЫБОР 
	|		КОГДА НастройкиХозопераций.Расход = ЗНАЧЕНИЕ(Перечисление.ТипыДанныхУчета.Номенклатура)
	|				И ДвиженияНоменклатураДоходыРасходыОбороты.ПостояннаяРазницаОборот > 0
	|			ТОГДА 1
	|		КОГДА НастройкиХозопераций.Расход = ЗНАЧЕНИЕ(Перечисление.ТипыДанныхУчета.Номенклатура)
	|				И ДвиженияНоменклатураДоходыРасходыОбороты.ПостояннаяРазницаОборот < 0
	|			ТОГДА -1
	|		ИНАЧЕ 0
	|	КОНЕЦ * ВЫБОР
	|		КОГДА &ДанныеОтчета = 1 ИЛИ &ДанныеОтчета = 2 ИЛИ &ДанныеОтчета = 4
	|			ТОГДА 0
	|		КОГДА &ДанныеОтчета = 4 
	|			ТОГДА ДвиженияНоменклатураДоходыРасходыОбороты.ПостояннаяРазницаОборот
	|		ИНАЧЕ 
	|			0
	|	КОНЕЦ КАК Об_ПостояннаяРазницаРасход,
	|	0 КАК Об_ПостояннаяРазницаКонечныйОстаток,
	|
	|	// Показатель ""Временная разница""
	|	0 КАК Об_ВременнаяРазницаНачальныйОстаток,
	|	ВЫБОР 
	|		КОГДА НастройкиХозопераций.Приход = ЗНАЧЕНИЕ(Перечисление.ТипыДанныхУчета.Номенклатура)
	|				И ДвиженияНоменклатураДоходыРасходыОбороты.ВременнаяРазницаОборот > 0
	|			ТОГДА 1
	|		КОГДА НастройкиХозопераций.Приход = ЗНАЧЕНИЕ(Перечисление.ТипыДанныхУчета.Номенклатура)
	|				И ДвиженияНоменклатураДоходыРасходыОбороты.ВременнаяРазницаОборот < 0
	|			ТОГДА -1
	|		ИНАЧЕ 0
	|	КОНЕЦ * ВЫБОР
	|		КОГДА &ДанныеОтчета = 1 ИЛИ &ДанныеОтчета = 2 ИЛИ &ДанныеОтчета = 4
	|			ТОГДА 0
	|		КОГДА &ДанныеОтчета = 4 
	|			ТОГДА ДвиженияНоменклатураДоходыРасходыОбороты.ВременнаяРазницаОборот
	|		ИНАЧЕ 
	|			0
	|	КОНЕЦ КАК Об_ВременнаяРазницаПриход,
	|	ВЫБОР 
	|		КОГДА НастройкиХозопераций.Расход = ЗНАЧЕНИЕ(Перечисление.ТипыДанныхУчета.Номенклатура)
	|				И ДвиженияНоменклатураДоходыРасходыОбороты.ВременнаяРазницаОборот > 0
	|			ТОГДА 1
	|		КОГДА НастройкиХозопераций.Расход = ЗНАЧЕНИЕ(Перечисление.ТипыДанныхУчета.Номенклатура)
	|				И ДвиженияНоменклатураДоходыРасходыОбороты.ВременнаяРазницаОборот < 0
	|			ТОГДА -1
	|		ИНАЧЕ 0
	|	КОНЕЦ * ВЫБОР
	|		КОГДА &ДанныеОтчета = 1 ИЛИ &ДанныеОтчета = 2 ИЛИ &ДанныеОтчета = 4
	|			ТОГДА 0
	|		КОГДА &ДанныеОтчета = 4 
	|			ТОГДА ДвиженияНоменклатураДоходыРасходыОбороты.ВременнаяРазницаОборот
	|		ИНАЧЕ 
	|			0
	|	КОНЕЦ КАК ВременнаяРазницаРасход,
	|	0 КАК Об_ВременнаяРазницаКонечныйОстаток
	|
	|ИЗ
	|	РегистрНакопления.ДвиженияНоменклатураДоходыРасходы.Обороты(
	|		{&НачалоПериода}, 
	|		{&КонецПериода}, 
	|		Авто, 
	|		НЕ АналитикаУчетаНоменклатуры.Номенклатура.ТипНоменклатуры = ЗНАЧЕНИЕ(Перечисление.ТипыНоменклатуры.Услуга)
	|		{(АналитикаУчетаНоменклатуры.Номенклатура).* КАК Номенклатура, 
	|		 (АналитикаУчетаНоменклатуры.Номенклатура.ЕдиницаИзмерения).* КАК ЕдиницаИзмерения,
	|		 (АналитикаУчетаНоменклатуры.Номенклатура.ЕдиницаДляОтчетов).* КАК ЕдиницаДляОтчетов,
	|		 (АналитикаУчетаНоменклатуры.Характеристика).* КАК Характеристика, 
	|		 (АналитикаУчетаНоменклатуры.Серия).* КАК Серия,
	|		 (АналитикаУчетаНоменклатуры.Склад).* КАК Склад, 
	|		 (АналитикаУчетаНоменклатуры.Назначение).* КАК Назначение, 
	|		 (АналитикаУчетаНоменклатуры.Назначение.НаправлениеДеятельности).* КАК НаправлениеДеятельности,
	|		 (Организация).* КАК Организация,
	|		 (ВидЗапасов).* КАК ВидЗапасов,
	|		 (ТипЗапасов).* КАК ТипЗапасов,
	|		 (СтатьяДоходовРасходов).* КАК СтатьяДоходовРасходов,
	|		 (АналитикаДоходов).* КАК АналитикаДоходов,
	|		 (АналитикаРасходов).* КАК АналитикаРасходов
	|		}
	|	) КАК ДвиженияНоменклатураДоходыРасходыОбороты
	|
	|		{ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.АналитикаУчетаНоменклатуры КАК АналитикаНоменклатуры
	|			ПО ДвиженияНоменклатураДоходыРасходыОбороты.АналитикаУчетаНоменклатуры = АналитикаНоменклатуры.КлючАналитики
	|		}
	|
	|		ЛЕВОЕ СОЕДИНЕНИЕ Справочник.НастройкиХозяйственныхОпераций КАК НастройкиХозопераций
	|		ПО НастройкиХозопераций.ХозяйственнаяОперация = ДвиженияНоменклатураДоходыРасходыОбороты.ХозяйственнаяОперация
	|{ГДЕ
	|	((АналитикаНоменклатуры.Номенклатура, АналитикаНоменклатуры.Характеристика) В
	|			(ВЫБРАТЬ
	|				ОтборПоСегментуНоменклатуры.Номенклатура,
	|				ОтборПоСегментуНоменклатуры.Характеристика
	|			ИЗ
	|				ОтборПоСегментуНоменклатуры
	|			ГДЕ
	|				ОтборПоСегментуНоменклатуры.ИспользуетсяОтборПоСегментуНоменклатуры = &ИспользуетсяОтборПоСегментуНоменклатуры)),
	|	(""ДвиженияНоменклатураДоходыРасходыОбороты"") КАК НаборДанных,
	|	НАЧАЛОПЕРИОДА(ДвиженияНоменклатураДоходыРасходыОбороты.ПериодДень,      ДЕНЬ)      КАК ПериодДень,
	|	НАЧАЛОПЕРИОДА(ДвиженияНоменклатураДоходыРасходыОбороты.ПериодНеделя,    НЕДЕЛЯ)    КАК ПериодНеделя,
	|	НАЧАЛОПЕРИОДА(ДвиженияНоменклатураДоходыРасходыОбороты.ПериодДекада,    ДЕКАДА)    КАК ПериодДекада,
	|	НАЧАЛОПЕРИОДА(ДвиженияНоменклатураДоходыРасходыОбороты.ПериодМесяц,     МЕСЯЦ)     КАК ПериодМесяц,
	|	НАЧАЛОПЕРИОДА(ДвиженияНоменклатураДоходыРасходыОбороты.ПериодКвартал,   КВАРТАЛ)   КАК ПериодКвартал,
	|	НАЧАЛОПЕРИОДА(ДвиженияНоменклатураДоходыРасходыОбороты.ПериодПолугодие, ПОЛУГОДИЕ) КАК ПериодПолугодие,
	|	НАЧАЛОПЕРИОДА(ДвиженияНоменклатураДоходыРасходыОбороты.ПериодГод,       ГОД)       КАК ПериодГод,
	|	ДвиженияНоменклатураДоходыРасходыОбороты.АналитикаУчетаНоменклатуры.*,
	|	(ВЫБОР
	|			КОГДА &ФормироватьВидыЗапасовПоГруппамФинансовогоУчета
	|				ТОГДА ДвиженияНоменклатураДоходыРасходыОбороты.ВидЗапасов.ГруппаФинансовогоУчета
	|			ИНАЧЕ АналитикаНоменклатуры.Номенклатура.ГруппаФинансовогоУчета
	|		КОНЕЦ).*                                                        КАК ГруппаФинансовогоУчета,
	|	NULL                                                                КАК Заказ,
	|	(ВЫБОР
	|			КОГДА ДвиженияНоменклатураДоходыРасходыОбороты.СтатьяДоходовРасходов ССЫЛКА ПланВидовХарактеристик.СтатьиДоходов
	|				ТОГДА ДвиженияНоменклатураДоходыРасходыОбороты.СтатьяДоходовРасходов
	|			ИНАЧЕ NULL
	|		КОНЕЦ).*                                                        КАК СтатьяДоходов,
	|	(ВЫБОР
	|			КОГДА ДвиженияНоменклатураДоходыРасходыОбороты.СтатьяДоходовРасходов ССЫЛКА ПланВидовХарактеристик.СтатьиРасходов
	|				ТОГДА ДвиженияНоменклатураДоходыРасходыОбороты.СтатьяДоходовРасходов
	|			ИНАЧЕ NULL
	|		КОНЕЦ).*                                                        КАК СтатьяРасходов,
	|	(ВЫБОР
	|		КОГДА НЕ ТИПЗНАЧЕНИЯ(ДвиженияНоменклатураДоходыРасходыОбороты.АналитикаДоходов) ЕСТЬ NULL
	|			ТОГДА ДвиженияНоменклатураДоходыРасходыОбороты.АналитикаДоходов
	|		КОГДА НЕ ТИПЗНАЧЕНИЯ(ДвиженияНоменклатураДоходыРасходыОбороты.АналитикаРасходов) ЕСТЬ NULL
	|			ТОГДА ДвиженияНоменклатураДоходыРасходыОбороты.АналитикаРасходов
	|	КОНЕЦ).*                                                            КАК АналитикаДоходовРасходов,
	|	НастройкиХозопераций.Ссылка.*                                       КАК ХозяйственнаяОперацияСправочник,
	|	(ВЫБОР
	|			КОГДА НастройкиХозопераций.Приход = ЗНАЧЕНИЕ(Перечисление.ТипыДанныхУчета.Номенклатура)
	|				ТОГДА ИСТИНА
	|			ИНАЧЕ ЛОЖЬ
	|		КОНЕЦ)                                                          КАК ХозяйственнаяОперацияПрихода,
	|	(ВЫБОР
	|			КОГДА НастройкиХозопераций.Расход = ЗНАЧЕНИЕ(Перечисление.ТипыДанныхУчета.Номенклатура)
	|				ТОГДА ИСТИНА
	|			ИНАЧЕ ЛОЖЬ
	|		КОНЕЦ)                                                          КАК ХозяйственнаяОперацияРасхода}";
	
	ТекстЗапроса = СтрЗаменить(
		ТекстЗапроса, 
		"&ТекстЗапросаВесУпаковки", 
		Справочники.УпаковкиЕдиницыИзмерения.ТекстЗапросаВесУпаковки("АналитикаНоменклатуры.Номенклатура.ЕдиницаИзмерения", "АналитикаНоменклатуры.Номенклатура"));
		
	ТекстЗапроса = СтрЗаменить(
		ТекстЗапроса, 
		"&ТекстЗапросаОбъемУпаковки", 
		Справочники.УпаковкиЕдиницыИзмерения.ТекстЗапросаОбъемУпаковки("АналитикаНоменклатуры.Номенклатура.ЕдиницаИзмерения", "АналитикаНоменклатуры.Номенклатура"));
	
	Возврат ТекстЗапроса;
КонецФункции

Функция ТекстЗапросаДополнениеВводОстатков()
	ТекстЗапроса = "
	|///////////////////////////////////////////////////////////////////////////////
	|ВЫБРАТЬ РАЗРЕШЕННЫЕ
	|	""ДополнениеВводОстатков"" КАК НаборДанных,
	|
	|	// Аналитика периодов
	|	НАЧАЛОПЕРИОДА(ДополнениеВводОстатков.ПериодДень,      ДЕНЬ)      КАК ПериодДень,
	|	НАЧАЛОПЕРИОДА(ДополнениеВводОстатков.ПериодНеделя,    НЕДЕЛЯ)    КАК ПериодНеделя,
	|	НАЧАЛОПЕРИОДА(ДополнениеВводОстатков.ПериодДекада,    ДЕКАДА)    КАК ПериодДекада,
	|	НАЧАЛОПЕРИОДА(ДополнениеВводОстатков.ПериодМесяц,     МЕСЯЦ)     КАК ПериодМесяц,
	|	НАЧАЛОПЕРИОДА(ДополнениеВводОстатков.ПериодКвартал,   КВАРТАЛ)   КАК ПериодКвартал,
	|	НАЧАЛОПЕРИОДА(ДополнениеВводОстатков.ПериодПолугодие, ПОЛУГОДИЕ) КАК ПериодПолугодие,
	|	НАЧАЛОПЕРИОДА(ДополнениеВводОстатков.ПериодГод,        ГОД)      КАК ПериодГод,
	|	
	|	// Общая аналитика
	|	ДополнениеВводОстатков.АналитикаУчетаНоменклатуры    КАК АналитикаУчетаНоменклатуры,
	|	АналитикаНоменклатуры.Номенклатура                   КАК Номенклатура,
	|	АналитикаНоменклатуры.Номенклатура.ЕдиницаИзмерения  КАК ЕдиницаХранения,
	|	АналитикаНоменклатуры.Номенклатура.ЕдиницаДляОтчетов КАК ЕдиницаДляОтчетов,
	|	АналитикаНоменклатуры.Номенклатура.КоэффициентЕдиницыДляОтчетов КАК КоэффициентЕдиницыДляОтчетов,
	|	АналитикаНоменклатуры.Характеристика                 КАК Характеристика,
	|	АналитикаНоменклатуры.Серия                          КАК Серия,
	|	АналитикаНоменклатуры.Склад                          КАК Склад,
	|	АналитикаНоменклатуры.Назначение                     КАК Назначение,
	|	АналитикаНоменклатуры.Назначение.НаправлениеДеятельности КАК НаправлениеДеятельности,
	|	
	|	ДополнениеВводОстатков.ВидЗапасов               КАК ВидЗапасов,
	|	ЕСТЬNULL(АналитикаПартий.Поставщик, NULL) КАК Партнер,
	|	ЕСТЬNULL(ВЫРАЗИТЬ(ДополнениеВводОстатков.АналитикаФинансовогоУчета КАК Справочник.Пользователи), NULL) КАК Менеджер,
	|	ЕСТЬNULL(ВЫРАЗИТЬ(ДополнениеВводОстатков.АналитикаФинансовогоУчета КАК Справочник.СтруктураПредприятия), NULL) КАК Подразделение,
	|	ЕСТЬNULL(ВЫРАЗИТЬ(ДополнениеВводОстатков.АналитикаФинансовогоУчета КАК Справочник.СделкиСКлиентами), NULL) КАК Сделка,
	|	
	|	ВЫБОР 
	|		КОГДА &ФормироватьВидыЗапасовПоГруппамФинансовогоУчета 
	|			ТОГДА ДополнениеВводОстатков.ВидЗапасов.ГруппаФинансовогоУчета
	|			ИНАЧЕ АналитикаНоменклатуры.Номенклатура.ГруппаФинансовогоУчета
	|	КОНЕЦ КАК ГруппаФинансовогоУчета,
	|
	|	ДополнениеВводОстатков.Организация КАК Организация,
	|	
	|	// Аналитика оборотов
	|	NULL КАК СтатьяДоходов,
	|	NULL КАК СтатьяРасходов,
	|	NULL КАК СтатьяДоходовРасходов,
	|	NULL КАК АналитикаДоходов,
	|	NULL КАК АналитикаРасходов,
	|	NULL КАК АналитикаДоходовРасходов,
	|	NULL КАК Договор,
	|	NULL КАК Заказ,
	|	NULL КАК Контрагент,
	|	NULL КАК Соглашение,
	|	NULL КАК ТипЗапасов,
	|	НастройкиХозопераций.Ссылка КАК ХозяйственнаяОперацияСправочник,
	|	ИСТИНА КАК ХозяйственнаяОперацияПрихода,
	|	ВЫБОР
	|		КОГДА ЗарегистрированныеВводыОстатков.Ссылка.ТипОперации = ЗНАЧЕНИЕ(Перечисление.ТипыОперацийВводаОстатков.ОстаткиМатериаловПереданныхВПроизводство)
	|		ТОГДА Истина
	|		ИНАЧЕ Ложь
	|	КОНЕЦ КАК ХозяйственнаяОперацияРасхода,
	|
	|	// Показатель ""Количество""
	|	0 КАК Об_КоличествоНачальныйОстаток,
	|	ВЫБОР 
	|		КОГДА &ЕдиницыКоличества = 0 
	|			ТОГДА 1
	|		КОГДА &ЕдиницыКоличества = 1 
	|			ТОГДА
	|				ВЫБОР
	|					КОГДА АналитикаНоменклатуры.Номенклатура.КоэффициентЕдиницыДляОтчетов <> 0 
	|						ТОГДА 1 / АналитикаНоменклатуры.Номенклатура.КоэффициентЕдиницыДляОтчетов
	|						ИНАЧЕ 0
	|				КОНЕЦ
	|	КОНЕЦ * ДополнениеВводОстатков.КоличествоПриход КАК Об_КоличествоПриход,
	|	ВЫБОР 
	|		КОГДА &ЕдиницыКоличества = 0 
	|			ТОГДА 1
	|		КОГДА &ЕдиницыКоличества = 1 
	|			ТОГДА
	|				ВЫБОР 
	|					КОГДА АналитикаНоменклатуры.Номенклатура.КоэффициентЕдиницыДляОтчетов <> 0 
	|						ТОГДА 1 / АналитикаНоменклатуры.Номенклатура.КоэффициентЕдиницыДляОтчетов
	|						ИНАЧЕ 0
	|				КОНЕЦ
	|	КОНЕЦ * ДополнениеВводОстатков.КоличествоРасход КАК Об_КоличествоРасход,
	|	0 КАК Об_КоличествоКонечныйОстаток,
	|	
	|	// Показатель ""Вес""
	|	0 КАК Об_ВесНачальныйОстаток,
	|	ДополнениеВводОстатков.КоличествоПриход * &ТекстЗапросаВесУпаковки   КАК Об_ВесПриход,
	|	ДополнениеВводОстатков.КоличествоРасход * &ТекстЗапросаВесУпаковки    КАК Об_ВесРасход,
	|	0 КАК Об_ВесКонечныйОстаток,
	|	
	|	// Показатель ""Объем""
	|	0 КАК Об_ОбъемНачальныйОстаток,
	|	ДополнениеВводОстатков.КоличествоПриход * &ТекстЗапросаОбъемУпаковки КАК Об_ОбъемПриход,
	|	ДополнениеВводОстатков.КоличествоРасход * &ТекстЗапросаОбъемУпаковки  КАК Об_ОбъемРасход,
	|	0 КАК Об_ОбъемКонечныйОстаток,
	|	
	|	// Показатель ""Стоимость""
	|	0 КАК Об_СтоимостьПоступленияНачальныйОстаток,
	|	ВЫБОР 
	|		КОГДА &ДанныеОтчета = 1 
	|			ТОГДА ДополнениеВводОстатков.СтоимостьПриход
	|				+ ДополнениеВводОстатков.СтоимостьЗабалансоваяПриход
	|		КОГДА &ДанныеОтчета = 2 
	|			ТОГДА ДополнениеВводОстатков.СтоимостьБезНДСПриход
	|				+ ДополнениеВводОстатков.СтоимостьЗабалансоваяПриход
	|		КОГДА &ДанныеОтчета = 3 
	|			ТОГДА ДополнениеВводОстатков.СтоимостьУпрПриход
	|				+ ДополнениеВводОстатков.СтоимостьЗабалансоваяПриход
	|		КОГДА &ДанныеОтчета = 4 
	|			ТОГДА ДополнениеВводОстатков.СтоимостьРеглПриход
	|				+ ДополнениеВводОстатков.СтоимостьЗабалансоваяПриход
	|		ИНАЧЕ
	|			ВЫБОР КОГДА &ПоПредприятию ТОГДА
	|				ДополнениеВводОстатков.СтоимостьБезНДСПриход
	|				+ ДополнениеВводОстатков.СтоимостьЗабалансоваяПриход
	|			ИНАЧЕ
	|				ДополнениеВводОстатков.СтоимостьУпрПриход
	|				+ ДополнениеВводОстатков.СтоимостьЗабалансоваяПриход
	|			КОНЕЦ	
	|	КОНЕЦ КАК Об_СтоимостьПоступленияПриход,
	|	ВЫБОР 
	|		КОГДА &ДанныеОтчета = 1 
	|			ТОГДА ДополнениеВводОстатков.СтоимостьРасход 
	|				+ ДополнениеВводОстатков.СтоимостьЗабалансоваяРасход
	|		КОГДА &ДанныеОтчета = 2 
	|			ТОГДА ДополнениеВводОстатков.СтоимостьБезНДСРасход 
	|				+ ДополнениеВводОстатков.СтоимостьЗабалансоваяРасход
	|		КОГДА &ДанныеОтчета = 3 
	|			ТОГДА ДополнениеВводОстатков.СтоимостьУпрРасход
	|				+ ДополнениеВводОстатков.СтоимостьЗабалансоваяРасход
	|		КОГДА &ДанныеОтчета = 4 
	|			ТОГДА ДополнениеВводОстатков.СтоимостьРеглРасход 
	|				+ ДополнениеВводОстатков.СтоимостьЗабалансоваяРасход
	|		ИНАЧЕ
	|			ВЫБОР КОГДА &ПоПредприятию ТОГДА
	|				ДополнениеВводОстатков.СтоимостьБезНДСРасход
	|				+ ДополнениеВводОстатков.СтоимостьЗабалансоваяРасход
	|			ИНАЧЕ
	|				ДополнениеВводОстатков.СтоимостьУпрРасход
	|				+ ДополнениеВводОстатков.СтоимостьЗабалансоваяРасход
	|			КОНЕЦ	
	|	КОНЕЦ КАК Об_СтоимостьПоступленияРасход,
	|	0 КАК Об_СтоимостьПоступленияКонечныйОстаток,
	|	
	|	// Показатель ""Доп. расходы""
	|	0 КАК Об_ДопРасходыНачальныйОстаток,
	|	ВЫБОР 
	|		КОГДА &ДанныеОтчета = 1 
	|			ТОГДА ДополнениеВводОстатков.ДопРасходыПриход
	|		КОГДА &ДанныеОтчета = 2 
	|			ТОГДА ДополнениеВводОстатков.ДопРасходыБезНДСПриход
	|		КОГДА &ДанныеОтчета = 3 
	|			ТОГДА ДополнениеВводОстатков.ДопРасходыУпрПриход
	|		КОГДА &ДанныеОтчета = 4 
	|			ТОГДА ДополнениеВводОстатков.ДопРасходыРеглПриход
	|		ИНАЧЕ 
	|			ВЫБОР КОГДА &ПоПредприятию ТОГДА
	|				ДополнениеВводОстатков.ДопРасходыБезНДСПриход
	|			ИНАЧЕ
	|				ДополнениеВводОстатков.ДопРасходыУпрПриход
	|			КОНЕЦ
	|	КОНЕЦ КАК Об_ДопРасходыПриход,
	|	ВЫБОР 
	|		КОГДА &ДанныеОтчета = 1 
	|			ТОГДА ДополнениеВводОстатков.ДопРасходыРасход
	|		КОГДА &ДанныеОтчета = 2 
	|			ТОГДА ДополнениеВводОстатков.ДопРасходыБезНДСРасход
	|		КОГДА &ДанныеОтчета = 3 
	|			ТОГДА ДополнениеВводОстатков.ДопРасходыУпрРасход
	|		КОГДА &ДанныеОтчета = 4 
	|			ТОГДА ДополнениеВводОстатков.ДопРасходыРеглРасход
	|		ИНАЧЕ 
	|			ВЫБОР КОГДА &ПоПредприятию ТОГДА
	|				ДополнениеВводОстатков.ДопРасходыБезНДСРасход
	|			ИНАЧЕ
	|				ДополнениеВводОстатков.ДопРасходыУпрРасход
	|			КОНЕЦ
	|	КОНЕЦ КАК Об_ДопРасходыРасход,
	|	0 КАК Об_ДопРасходыКонечныйОстаток,
	|	
	|	// Показатель ""Трудозатраты""
	|	0 КАК Об_ТрудозатратыНачальныйОстаток,
	|	ВЫБОР 
	|		КОГДА &ДанныеОтчета = 1 
	|			ТОГДА ДополнениеВводОстатков.ТрудозатратыПриход
	|		КОГДА &ДанныеОтчета = 2 
	|			ТОГДА ДополнениеВводОстатков.ТрудозатратыПриход
	|		КОГДА &ДанныеОтчета = 3 
	|			ТОГДА ДополнениеВводОстатков.ТрудозатратыУпрПриход
	|		КОГДА &ДанныеОтчета = 4 
	|			ТОГДА ДополнениеВводОстатков.ТрудозатратыРеглПриход
	|		ИНАЧЕ 
	|			ВЫБОР КОГДА &ПоПредприятию ТОГДА
	|				ДополнениеВводОстатков.ТрудозатратыПриход
	|			ИНАЧЕ
	|				ДополнениеВводОстатков.ТрудозатратыУпрПриход
	|			КОНЕЦ
	|	КОНЕЦ КАК Об_ТрудозатратыПриход,
	|	ВЫБОР 
	|		КОГДА &ДанныеОтчета = 1 
	|			ТОГДА ДополнениеВводОстатков.ТрудозатратыРасход
	|		КОГДА &ДанныеОтчета = 2 
	|			ТОГДА ДополнениеВводОстатков.ТрудозатратыРасход
	|		КОГДА &ДанныеОтчета = 3 
	|			ТОГДА ДополнениеВводОстатков.ТрудозатратыУпрРасход
	|		КОГДА &ДанныеОтчета = 4 
	|			ТОГДА ДополнениеВводОстатков.ТрудозатратыРеглРасход
	|		ИНАЧЕ 
	|			ВЫБОР КОГДА &ПоПредприятию ТОГДА
	|				ДополнениеВводОстатков.ТрудозатратыРасход
	|			ИНАЧЕ
	|				ДополнениеВводОстатков.ТрудозатратыУпрРасход
	|			КОНЕЦ
	|	КОНЕЦ КАК Об_ТрудозатратыРасход,
	|	0 КАК Об_ТрудозатратыКонечныйОстаток,
	|	
	|	// Показатель ""ПостатейныеПостоянные""
	|	0 КАК Об_ПостатейныеПостоянныеНачальныйОстаток,
	|	ВЫБОР 
	|		КОГДА &ДанныеОтчета = 1 
	|			ТОГДА ДополнениеВводОстатков.ПостатейныеПостоянныеСНДСПриход
	|		КОГДА &ДанныеОтчета = 2 
	|			ТОГДА ДополнениеВводОстатков.ПостатейныеПостоянныеБезНДСПриход
	|		КОГДА &ДанныеОтчета = 3 
	|			ТОГДА ДополнениеВводОстатков.ПостатейныеПостоянныеУпрПриход
	|		КОГДА &ДанныеОтчета = 4 
	|			ТОГДА ДополнениеВводОстатков.ПостатейныеПостоянныеРеглПриход
	|		ИНАЧЕ 
	|			ВЫБОР КОГДА &ПоПредприятию ТОГДА
	|				ДополнениеВводОстатков.ПостатейныеПостоянныеБезНДСПриход
	|			ИНАЧЕ
	|				ДополнениеВводОстатков.ПостатейныеПостоянныеУпрПриход
	|			КОНЕЦ
	|	КОНЕЦ КАК Об_ПостатейныеПостоянныеПриход,
	|	ВЫБОР 
	|		КОГДА &ДанныеОтчета = 1 
	|			ТОГДА ДополнениеВводОстатков.ПостатейныеПостоянныеСНДСРасход
	|		КОГДА &ДанныеОтчета = 2 
	|			ТОГДА ДополнениеВводОстатков.ПостатейныеПостоянныеБезНДСРасход
	|		КОГДА &ДанныеОтчета = 3 
	|			ТОГДА ДополнениеВводОстатков.ПостатейныеПостоянныеУпрРасход
	|		КОГДА &ДанныеОтчета = 4 
	|			ТОГДА ДополнениеВводОстатков.ПостатейныеПостоянныеРеглРасход
	|		ИНАЧЕ 
	|			ВЫБОР КОГДА &ПоПредприятию ТОГДА
	|				ДополнениеВводОстатков.ПостатейныеПостоянныеБезНДСРасход
	|			ИНАЧЕ
	|				ДополнениеВводОстатков.ПостатейныеПостоянныеУпрРасход
	|			КОНЕЦ
	|	КОНЕЦ КАК Об_ПостатейныеПостоянныеРасход,
	|	0 КАК Об_ПостатейныеПостоянныеКонечныйОстаток,
	|	
	|	// Показатель ""ПостатейныеПеременные""
	|	0 КАК Об_ПостатейныеПеременныеНачальныйОстаток,
	|	ВЫБОР 
	|		КОГДА &ДанныеОтчета = 1 
	|			ТОГДА ДополнениеВводОстатков.ПостатейныеПеременныеСНДСПриход
	|		КОГДА &ДанныеОтчета = 2 
	|			ТОГДА ДополнениеВводОстатков.ПостатейныеПеременныеБезНДСПриход
	|		КОГДА &ДанныеОтчета = 3 
	|			ТОГДА ДополнениеВводОстатков.ПостатейныеПеременныеУпрПриход
	|		КОГДА &ДанныеОтчета = 4 
	|			ТОГДА ДополнениеВводОстатков.ПостатейныеПеременныеРеглПриход
	|		ИНАЧЕ 
	|			ВЫБОР КОГДА &ПоПредприятию ТОГДА
	|				ДополнениеВводОстатков.ПостатейныеПеременныеБезНДСПриход
	|			ИНАЧЕ
	|				ДополнениеВводОстатков.ПостатейныеПеременныеУпрПриход
	|			КОНЕЦ
	|	КОНЕЦ КАК Об_ПостатейныеПеременныеПриход,
	|	ВЫБОР 
	|		КОГДА &ДанныеОтчета = 1 
	|			ТОГДА ДополнениеВводОстатков.ПостатейныеПеременныеСНДСРасход
	|		КОГДА &ДанныеОтчета = 2 
	|			ТОГДА ДополнениеВводОстатков.ПостатейныеПеременныеБезНДСРасход
	|		КОГДА &ДанныеОтчета = 3 
	|			ТОГДА ДополнениеВводОстатков.ПостатейныеПеременныеУпрРасход
	|		КОГДА &ДанныеОтчета = 4 
	|			ТОГДА ДополнениеВводОстатков.ПостатейныеПеременныеРеглРасход
	|		ИНАЧЕ 
	|			ВЫБОР КОГДА &ПоПредприятию ТОГДА
	|				ДополнениеВводОстатков.ПостатейныеПеременныеБезНДСРасход
	|			ИНАЧЕ
	|				ДополнениеВводОстатков.ПостатейныеПеременныеУпрРасход
	|			КОНЕЦ
	|	КОНЕЦ КАК Об_ПостатейныеПеременныеРасход,
	|	0 КАК Об_ПостатейныеПеременныеКонечныйОстаток,
	|
	|	// Показатель ""Себестоимость""
	|	0 КАК Об_СебестоимостьНачальныйОстаток,
	|	ВЫБОР 
	|		КОГДА &ДанныеОтчета = 1 
	|			ТОГДА ДополнениеВводОстатков.СтоимостьПриход
	|				+ ДополнениеВводОстатков.ДопРасходыПриход 
	|				+ ДополнениеВводОстатков.СтоимостьЗабалансоваяПриход
	|				+ ДополнениеВводОстатков.ТрудозатратыПриход
	|				+ ДополнениеВводОстатков.ПостатейныеПостоянныеСНДСПриход
	|				+ ДополнениеВводОстатков.ПостатейныеПеременныеСНДСПриход
	|		КОГДА &ДанныеОтчета = 2 
	|			ТОГДА ДополнениеВводОстатков.СтоимостьБезНДСПриход
	|				+ ДополнениеВводОстатков.ДопРасходыБезНДСПриход 
	|				+ ДополнениеВводОстатков.СтоимостьЗабалансоваяПриход
	|				+ ДополнениеВводОстатков.ТрудозатратыПриход
	|				+ ДополнениеВводОстатков.ПостатейныеПостоянныеБезНДСПриход
	|				+ ДополнениеВводОстатков.ПостатейныеПеременныеБезНДСПриход
	|		КОГДА &ДанныеОтчета = 3 
	|			ТОГДА ДополнениеВводОстатков.СтоимостьУпрПриход + ДополнениеВводОстатков.ДопРасходыУпрПриход
	|				+ ДополнениеВводОстатков.СтоимостьЗабалансоваяПриход
	|				+ ДополнениеВводОстатков.ТрудозатратыУпрПриход
	|				+ ДополнениеВводОстатков.ПостатейныеПостоянныеУпрПриход
	|				+ ДополнениеВводОстатков.ПостатейныеПеременныеУпрПриход
	|		КОГДА &ДанныеОтчета = 4 
	|			ТОГДА ДополнениеВводОстатков.СтоимостьРеглПриход
	|				+ ДополнениеВводОстатков.ДопРасходыРеглПриход
	|				+ ДополнениеВводОстатков.СтоимостьЗабалансоваяРеглПриход
	|				+ ДополнениеВводОстатков.ТрудозатратыРеглПриход
	|				+ ДополнениеВводОстатков.ПостатейныеПостоянныеРеглПриход
	|				+ ДополнениеВводОстатков.ПостатейныеПеременныеРеглПриход
	|		ИНАЧЕ
	|			ВЫБОР КОГДА &ПоПредприятию ТОГДА
	|				ДополнениеВводОстатков.СтоимостьБезНДСПриход
	|				+ ДополнениеВводОстатков.ДопРасходыБезНДСПриход
	|				+ ДополнениеВводОстатков.СтоимостьЗабалансоваяПриход
	|				+ ДополнениеВводОстатков.ТрудозатратыПриход
	|				+ ДополнениеВводОстатков.ПостатейныеПостоянныеБезНДСПриход
	|				+ ДополнениеВводОстатков.ПостатейныеПеременныеБезНДСПриход
	|			ИНАЧЕ
	|				ДополнениеВводОстатков.СтоимостьУпрПриход
	|				+ ДополнениеВводОстатков.ДопРасходыУпрПриход
	|				+ ДополнениеВводОстатков.СтоимостьЗабалансоваяПриход
	|				+ ДополнениеВводОстатков.ТрудозатратыУпрПриход
	|				+ ДополнениеВводОстатков.ПостатейныеПостоянныеУпрПриход
	|				+ ДополнениеВводОстатков.ПостатейныеПеременныеУпрПриход
	|			КОНЕЦ	
	|	КОНЕЦ КАК Об_СебестоимостьПриход,
	|	ВЫБОР 
	|		КОГДА &ДанныеОтчета = 1 
	|			ТОГДА ДополнениеВводОстатков.СтоимостьРасход
	|				+ ДополнениеВводОстатков.ДопРасходыРасход 
	|				+ ДополнениеВводОстатков.СтоимостьЗабалансоваяРасход
	|				+ ДополнениеВводОстатков.ТрудозатратыРасход
	|				+ ДополнениеВводОстатков.ПостатейныеПостоянныеСНДСРасход
	|				+ ДополнениеВводОстатков.ПостатейныеПеременныеСНДСРасход
	|		КОГДА &ДанныеОтчета = 2 
	|			ТОГДА ДополнениеВводОстатков.СтоимостьБезНДСРасход
	|				+ ДополнениеВводОстатков.ДопРасходыБезНДСРасход 
	|				+ ДополнениеВводОстатков.СтоимостьЗабалансоваяРасход
	|				+ ДополнениеВводОстатков.ТрудозатратыРасход
	|				+ ДополнениеВводОстатков.ПостатейныеПостоянныеБезНДСРасход
	|				+ ДополнениеВводОстатков.ПостатейныеПеременныеБезНДСРасход
	|		КОГДА &ДанныеОтчета = 3 
	|			ТОГДА ДополнениеВводОстатков.СтоимостьУпрПриход
	|				+ ДополнениеВводОстатков.ДопРасходыУпрПриход
	|				+ ДополнениеВводОстатков.СтоимостьЗабалансоваяПриход
	|				+ ДополнениеВводОстатков.ТрудозатратыУпрПриход
	|				+ ДополнениеВводОстатков.ПостатейныеПостоянныеУпрПриход
	|				+ ДополнениеВводОстатков.ПостатейныеПеременныеУпрПриход
	|		КОГДА &ДанныеОтчета = 4 
	|			ТОГДА ДополнениеВводОстатков.СтоимостьРеглРасход
	|				+ ДополнениеВводОстатков.ДопРасходыРеглРасход
	|				+ ДополнениеВводОстатков.СтоимостьЗабалансоваяРеглРасход
	|				+ ДополнениеВводОстатков.ТрудозатратыРеглРасход
	|				+ ДополнениеВводОстатков.ПостатейныеПостоянныеРеглРасход
	|				+ ДополнениеВводОстатков.ПостатейныеПеременныеРеглРасход
	|		ИНАЧЕ
	|			ВЫБОР КОГДА &ПоПредприятию ТОГДА
	|				ДополнениеВводОстатков.СтоимостьБезНДСРасход
	|				+ ДополнениеВводОстатков.ДопРасходыБезНДСРасход
	|				+ ДополнениеВводОстатков.СтоимостьЗабалансоваяРасход
	|				+ ДополнениеВводОстатков.ТрудозатратыРасход
	|				+ ДополнениеВводОстатков.ПостатейныеПостоянныеБезНДСРасход
	|				+ ДополнениеВводОстатков.ПостатейныеПеременныеБезНДСРасход
	|			ИНАЧЕ
	|				ДополнениеВводОстатков.СтоимостьУпрРасход
	|				+ ДополнениеВводОстатков.ДопРасходыУпрРасход
	|				+ ДополнениеВводОстатков.СтоимостьЗабалансоваяРасход
	|				+ ДополнениеВводОстатков.ТрудозатратыУпрРасход
	|				+ ДополнениеВводОстатков.ПостатейныеПостоянныеУпрРасход
	|				+ ДополнениеВводОстатков.ПостатейныеПеременныеУпрРасход
	|			КОНЕЦ	
	|	КОНЕЦ КАК Об_СебестоимостьРасход,
	|	0 КАК Об_СебестоимостьКонечныйОстаток,
	|
	|	// Показатель ""Налоговый учет""
	|	0 КАК Об_НалоговыйУчетНачальныйОстаток,
	|	ВЫБОР 
	|		КОГДА &ДанныеОтчета = 1 ИЛИ &ДанныеОтчета = 2 ИЛИ &ДанныеОтчета = 3
	|			ТОГДА 0
	|		КОГДА &ДанныеОтчета = 4 
	|			ТОГДА ДополнениеВводОстатков.СтоимостьРеглПриход
	|				+ ДополнениеВводОстатков.ДопРасходыРеглПриход
	|				+ ДополнениеВводОстатков.СтоимостьЗабалансоваяРеглПриход
	|				+ ДополнениеВводОстатков.ТрудозатратыРеглПриход
	|				+ ДополнениеВводОстатков.ПостатейныеПостоянныеРеглПриход
	|				+ ДополнениеВводОстатков.ПостатейныеПеременныеРеглПриход
	|				- ДополнениеВводОстатков.ПостояннаяРазницаПриход
	|				- ДополнениеВводОстатков.ВременнаяРазницаПриход
	|		ИНАЧЕ
	|			0
	|	КОНЕЦ КАК Об_НалоговыйУчетПриход,
	|	ВЫБОР 
	|		КОГДА &ДанныеОтчета = 1 ИЛИ &ДанныеОтчета = 2 ИЛИ &ДанныеОтчета = 3
	|			ТОГДА 0
	|		КОГДА &ДанныеОтчета = 4 
	|			ТОГДА ДополнениеВводОстатков.СтоимостьРеглРасход
	|				+ ДополнениеВводОстатков.ДопРасходыРеглРасход
	|				+ ДополнениеВводОстатков.СтоимостьЗабалансоваяРеглРасход
	|				+ ДополнениеВводОстатков.ТрудозатратыРеглРасход
	|				+ ДополнениеВводОстатков.ПостатейныеПостоянныеРеглРасход
	|				+ ДополнениеВводОстатков.ПостатейныеПеременныеРеглРасход
	|				- ДополнениеВводОстатков.ПостояннаяРазницаРасход
	|				- ДополнениеВводОстатков.ВременнаяРазницаРасход
	|		ИНАЧЕ
	|			0
	|	КОНЕЦ КАК Об_НалоговыйУчетРасход,
	|	0 КАК Об_НалоговыйУчетКонечныйОстаток,
	|
	|	// Показатель ""Постоянная разница""
	|	0 КАК Об_ПостояннаяРазницаНачальныйОстаток,
	|	ВЫБОР 
	|		КОГДА НастройкиХозопераций.Приход = ЗНАЧЕНИЕ(Перечисление.ТипыДанныхУчета.Номенклатура)
	|				И ДополнениеВводОстатков.ПостояннаяРазницаОборот > 0
	|			ТОГДА 1
	|		КОГДА НастройкиХозопераций.Приход = ЗНАЧЕНИЕ(Перечисление.ТипыДанныхУчета.Номенклатура)
	|				И ДополнениеВводОстатков.ПостояннаяРазницаОборот < 0
	|			ТОГДА -1
	|		ИНАЧЕ 0
	|	КОНЕЦ * ВЫБОР
	|		КОГДА &ДанныеОтчета = 1 ИЛИ &ДанныеОтчета = 2 ИЛИ &ДанныеОтчета = 4
	|			ТОГДА 0
	|		КОГДА &ДанныеОтчета = 4 
	|			ТОГДА ДополнениеВводОстатков.ПостояннаяРазницаОборот
	|		ИНАЧЕ 
	|			0
	|	КОНЕЦ КАК Об_ПостояннаяРазницаПриход,
	|	ВЫБОР 
	|		КОГДА НастройкиХозопераций.Расход = ЗНАЧЕНИЕ(Перечисление.ТипыДанныхУчета.Номенклатура)
	|				И ДополнениеВводОстатков.ПостояннаяРазницаОборот > 0
	|			ТОГДА 1
	|		КОГДА НастройкиХозопераций.Расход = ЗНАЧЕНИЕ(Перечисление.ТипыДанныхУчета.Номенклатура)
	|				И ДополнениеВводОстатков.ПостояннаяРазницаОборот < 0
	|			ТОГДА -1
	|		ИНАЧЕ 0
	|	КОНЕЦ * ВЫБОР
	|		КОГДА &ДанныеОтчета = 1 ИЛИ &ДанныеОтчета = 2 ИЛИ &ДанныеОтчета = 4
	|			ТОГДА 0
	|		КОГДА &ДанныеОтчета = 4 
	|			ТОГДА ДополнениеВводОстатков.ПостояннаяРазницаОборот
	|		ИНАЧЕ 
	|			0
	|	КОНЕЦ КАК Об_ПостояннаяРазницаРасход,
	|	0 КАК Об_ПостояннаяРазницаКонечныйОстаток,
	|
	|	// Показатель ""Временная разница""
	|	0 КАК Об_ВременнаяРазницаНачальныйОстаток,
	|	ВЫБОР 
	|		КОГДА НастройкиХозопераций.Приход = ЗНАЧЕНИЕ(Перечисление.ТипыДанныхУчета.Номенклатура)
	|				И ДополнениеВводОстатков.ВременнаяРазницаОборот > 0
	|			ТОГДА 1
	|		КОГДА НастройкиХозопераций.Приход = ЗНАЧЕНИЕ(Перечисление.ТипыДанныхУчета.Номенклатура)
	|				И ДополнениеВводОстатков.ВременнаяРазницаОборот < 0
	|			ТОГДА -1
	|		ИНАЧЕ 0
	|	КОНЕЦ * ВЫБОР
	|		КОГДА &ДанныеОтчета = 1 ИЛИ &ДанныеОтчета = 2 ИЛИ &ДанныеОтчета = 4
	|			ТОГДА 0
	|		КОГДА &ДанныеОтчета = 4 
	|			ТОГДА ДополнениеВводОстатков.ВременнаяРазницаОборот
	|		ИНАЧЕ 
	|			0
	|	КОНЕЦ КАК Об_ВременнаяРазницаПриход,
	|	ВЫБОР 
	|		КОГДА НастройкиХозопераций.Расход = ЗНАЧЕНИЕ(Перечисление.ТипыДанныхУчета.Номенклатура)
	|				И ДополнениеВводОстатков.ВременнаяРазницаОборот > 0
	|			ТОГДА 1
	|		КОГДА НастройкиХозопераций.Расход = ЗНАЧЕНИЕ(Перечисление.ТипыДанныхУчета.Номенклатура)
	|				И ДополнениеВводОстатков.ВременнаяРазницаОборот < 0
	|			ТОГДА -1
	|		ИНАЧЕ 0
	|	КОНЕЦ * ВЫБОР
	|		КОГДА &ДанныеОтчета = 1 ИЛИ &ДанныеОтчета = 2 ИЛИ &ДанныеОтчета = 4
	|			ТОГДА 0
	|		КОГДА &ДанныеОтчета = 4 
	|			ТОГДА ДополнениеВводОстатков.ВременнаяРазницаОборот
	|		ИНАЧЕ 
	|			0
	|	КОНЕЦ КАК ВременнаяРазницаРасход,
	|	0 КАК Об_ВременнаяРазницаКонечныйОстаток
	|	
	|ИЗ
	|	ЗарегистрированныеВводыОстатков КАК ЗарегистрированныеВводыОстатков
	|		ЛЕВОЕ СОЕДИНЕНИЕ 
	|	РегистрНакопления.СебестоимостьТоваров.Обороты(
	|		{&НачалоПериода}, 
	|		{&КонецПериода}, 
	|		Авто, 
	|		{(АналитикаУчетаНоменклатуры.Номенклатура).* КАК Номенклатура, 
	|		 (АналитикаУчетаНоменклатуры.Номенклатура.ЕдиницаИзмерения).* КАК ЕдиницаИзмерения,
	|		 (АналитикаУчетаНоменклатуры.Номенклатура.ЕдиницаДляОтчетов).* КАК ЕдиницаДляОтчетов,
	|		 (АналитикаУчетаНоменклатуры.Характеристика).* КАК Характеристика, 
	|		 (АналитикаУчетаНоменклатуры.Серия).* КАК Серия,
	|		 (АналитикаУчетаНоменклатуры.Склад).* КАК Склад, 
	|		 (АналитикаУчетаНоменклатуры.Назначение).* КАК Назначение, 
	|		 (АналитикаУчетаНоменклатуры.Назначение.НаправлениеДеятельности).* КАК НаправлениеДеятельности,
	|		 (Организация).* КАК Организация,
	|		 (ВидЗапасов).* КАК ВидЗапасов,
	|		 (ЕСТЬNULL(АналитикаУчетаПартий.Поставщик, NULL)).*	КАК Партнер,
	|		 (ЕСТЬNULL(ВЫРАЗИТЬ(АналитикаФинансовогоУчета КАК Справочник.Пользователи), NULL)).* КАК Менеджер,
	|		 (ЕСТЬNULL(ВЫРАЗИТЬ(АналитикаФинансовогоУчета КАК Справочник.СтруктураПредприятия), NULL)).* КАК Подразделение,
	|		 (ЕСТЬNULL(ВЫРАЗИТЬ(АналитикаФинансовогоУчета КАК Справочник.СделкиСКлиентами), NULL)).* КАК Сделка
	|	}
	|	) КАК ДополнениеВводОстатков
	|	ПО ЗарегистрированныеВводыОстатков.Ссылка = ДополнениеВводОстатков.Регистратор
	|	
	|	{ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.АналитикаУчетаНоменклатуры КАК АналитикаНоменклатуры
	|		ПО ДополнениеВводОстатков.АналитикаУчетаНоменклатуры = АналитикаНоменклатуры.КлючАналитики
	|	}
	|	{ЛЕВОЕ СОЕДИНЕНИЕ Справочник.КлючиАналитикиУчетаПартий КАК АналитикаПартий
	|		ПО АналитикаПартий.Ссылка = ДополнениеВводОстатков.АналитикаУчетаПартий
	|	}
	|
	|	ЛЕВОЕ СОЕДИНЕНИЕ Справочник.НастройкиХозяйственныхОпераций КАК НастройкиХозопераций
	|		ПО ВЫБОР
	|				КОГДА ЗарегистрированныеВводыОстатков.Ссылка.ТипОперации = ЗНАЧЕНИЕ(Перечисление.ТипыОперацийВводаОстатков.ОстаткиМатериаловПереданныхВПроизводство)
	|					ТОГДА ЗНАЧЕНИЕ(Перечисление.ХозяйственныеОперации.ПередачаВПроизводство)
	|				ИНАЧЕ ЗНАЧЕНИЕ(Перечисление.ХозяйственныеОперации.ОприходованиеТоваров)
	|			КОНЕЦ = НастройкиХозопераций.ХозяйственнаяОперация
	|ГДЕ
	|	НЕ ДополнениеВводОстатков.АналитикаУчетаНоменклатуры.Номенклатура.ТипНоменклатуры = ЗНАЧЕНИЕ(Перечисление.ТипыНоменклатуры.Услуга)
	|{ГДЕ
	|	((АналитикаНоменклатуры.Номенклатура, АналитикаНоменклатуры.Характеристика) В
	|			(ВЫБРАТЬ
	|				ОтборПоСегментуНоменклатуры.Номенклатура,
	|				ОтборПоСегментуНоменклатуры.Характеристика
	|			ИЗ
	|				ОтборПоСегментуНоменклатуры
	|			ГДЕ
	|				ОтборПоСегментуНоменклатуры.ИспользуетсяОтборПоСегментуНоменклатуры = &ИспользуетсяОтборПоСегментуНоменклатуры)),
	|	(""ДополнениеВводОстатков"") КАК НаборДанных,
	|	НАЧАЛОПЕРИОДА(ДополнениеВводОстатков.ПериодДень,      ДЕНЬ)      КАК ПериодДень,
	|	НАЧАЛОПЕРИОДА(ДополнениеВводОстатков.ПериодНеделя,    НЕДЕЛЯ)    КАК ПериодНеделя,
	|	НАЧАЛОПЕРИОДА(ДополнениеВводОстатков.ПериодДекада,    ДЕКАДА)    КАК ПериодДекада,
	|	НАЧАЛОПЕРИОДА(ДополнениеВводОстатков.ПериодМесяц,     МЕСЯЦ)     КАК ПериодМесяц,
	|	НАЧАЛОПЕРИОДА(ДополнениеВводОстатков.ПериодКвартал,   КВАРТАЛ)   КАК ПериодКвартал,
	|	НАЧАЛОПЕРИОДА(ДополнениеВводОстатков.ПериодПолугодие, ПОЛУГОДИЕ) КАК ПериодПолугодие,
	|	НАЧАЛОПЕРИОДА(ДополнениеВводОстатков.ПериодГод,        ГОД)      КАК ПериодГод,
	|	ДополнениеВводОстатков.АналитикаУчетаНоменклатуры.*,
	|	(ВЫБОР
	|			КОГДА &ФормироватьВидыЗапасовПоГруппамФинансовогоУчета
	|				ТОГДА ДополнениеВводОстатков.ВидЗапасов.ГруппаФинансовогоУчета
	|			ИНАЧЕ АналитикаНоменклатуры.Номенклатура.ГруппаФинансовогоУчета
	|		КОНЕЦ).* КАК ГруппаФинансовогоУчета,
	|	NULL КАК Заказ,
	|	НастройкиХозопераций.Ссылка.* КАК ХозяйственнаяОперацияСправочник,
	|	(ВЫБОР
	|			КОГДА ЗарегистрированныеВводыОстатков.Ссылка.ТипОперации = ЗНАЧЕНИЕ(Перечисление.ТипыОперацийВводаОстатков.ОстаткиМатериаловПереданныхВПроизводство)
	|				ТОГДА ИСТИНА
	|			ИНАЧЕ ИСТИНА
	|		КОНЕЦ) КАК ХозяйственнаяОперацияПрихода,
	|	(ВЫБОР
	|			КОГДА ЗарегистрированныеВводыОстатков.Ссылка.ТипОперации = ЗНАЧЕНИЕ(Перечисление.ТипыОперацийВводаОстатков.ОстаткиМатериаловПереданныхВПроизводство)
	|				ТОГДА ИСТИНА
	|			ИНАЧЕ ЛОЖЬ
	|		КОНЕЦ) КАК ХозяйственнаяОперацияРасхода}";
	
	ТекстЗапроса = СтрЗаменить(
		ТекстЗапроса, 
		"&ТекстЗапросаВесУпаковки", 
		Справочники.УпаковкиЕдиницыИзмерения.ТекстЗапросаВесУпаковки("АналитикаНоменклатуры.Номенклатура.ЕдиницаИзмерения", "АналитикаНоменклатуры.Номенклатура"));
		
	ТекстЗапроса = СтрЗаменить(
		ТекстЗапроса, 
		"&ТекстЗапросаОбъемУпаковки", 
		Справочники.УпаковкиЕдиницыИзмерения.ТекстЗапросаОбъемУпаковки("АналитикаНоменклатуры.Номенклатура.ЕдиницаИзмерения", "АналитикаНоменклатуры.Номенклатура"));
	
	Возврат ТекстЗапроса;
КонецФункции

Функция ТекстЗапросаКлассифицированныеОбороты()
	ТекстЗапроса = "
	|////////////////////////////////////////////////////////////////////////////////
	|ВЫБРАТЬ
	|	КлассифицированныеОбороты.НаборДанных КАК НаборДанных,
	|
	|	// Аналитика периодов
	|	КлассифицированныеОбороты.ПериодДень      КАК ПериодДень,
	|	КлассифицированныеОбороты.ПериодНеделя    КАК ПериодНеделя,
	|	КлассифицированныеОбороты.ПериодДекада    КАК ПериодДекада,
	|	КлассифицированныеОбороты.ПериодМесяц     КАК ПериодМесяц,
	|	КлассифицированныеОбороты.ПериодКвартал   КАК ПериодКвартал,
	|	КлассифицированныеОбороты.ПериодПолугодие КАК ПериодПолугодие,
	|	КлассифицированныеОбороты.ПериодГод       КАК ПериодГод,
	|	
	|	// Общая аналитика
	|	КлассифицированныеОбороты.АналитикаУчетаНоменклатуры КАК АналитикаУчетаНоменклатуры,
	|	КлассифицированныеОбороты.Номенклатура               КАК Номенклатура,
	|	КлассифицированныеОбороты.ЕдиницаХранения           КАК ЕдиницаХранения,
	|	КлассифицированныеОбороты.ЕдиницаДляОтчетов          КАК ЕдиницаДляОтчетов,
	|	КлассифицированныеОбороты.КоэффициентЕдиницыДляОтчетов КАК КоэффициентЕдиницыДляОтчетов,
	|	КлассифицированныеОбороты.Характеристика             КАК Характеристика,
	|	КлассифицированныеОбороты.Серия                      КАК Серия,
	|	КлассифицированныеОбороты.Склад                      КАК Склад,
	|	КлассифицированныеОбороты.Назначение                 КАК Назначение,
	|	КлассифицированныеОбороты.Назначение.НаправлениеДеятельности КАК НаправлениеДеятельности,
	|	
	|	КлассифицированныеОбороты.ВидЗапасов    КАК ВидЗапасов,
	|	КлассифицированныеОбороты.ГруппаФинансовогоУчета КАК ГруппаФинансовогоУчета,
	|	
	|	КлассифицированныеОбороты.Организация КАК Организация,
	|	
	|	// Аналитика оборотов
	|	КлассифицированныеОбороты.СтатьяДоходов КАК СтатьяДоходов,
	|	КлассифицированныеОбороты.СтатьяРасходов КАК СтатьяРасходов,
	|	КлассифицированныеОбороты.СтатьяДоходовРасходов КАК СтатьяДоходовРасходов,
	|	КлассифицированныеОбороты.АналитикаДоходов КАК АналитикаДоходов,
	|	КлассифицированныеОбороты.АналитикаРасходов КАК АналитикаРасходов,
	|	КлассифицированныеОбороты.АналитикаДоходовРасходов КАК АналитикаДоходовРасходов,
	|	КлассифицированныеОбороты.Договор КАК Договор,
	|	КлассифицированныеОбороты.Заказ КАК Заказ,
	|	КлассифицированныеОбороты.Контрагент КАК Контрагент,
	|	КлассифицированныеОбороты.Соглашение КАК Соглашение,
	|	КлассифицированныеОбороты.ТипЗапасов КАК ТипЗапасов,
	|	КлассифицированныеОбороты.Партнер КАК Партнер,
	|	КлассифицированныеОбороты.Менеджер КАК Менеджер,
	|	КлассифицированныеОбороты.Подразделение КАК Подразделение,
	|	КлассифицированныеОбороты.Сделка КАК Сделка,
	|	КлассифицированныеОбороты.ХозяйственнаяОперацияСправочник КАК ХозяйственнаяОперацияСправочник,
	|	КлассифицированныеОбороты.ХозяйственнаяОперацияПрихода КАК ХозяйственнаяОперацияПрихода,
	|	КлассифицированныеОбороты.ХозяйственнаяОперацияРасхода КАК ХозяйственнаяОперацияРасхода,
	|	
	|	// Показатель ""Количество""
	|	КлассифицированныеОбороты.Об_КоличествоНачальныйОстаток КАК Об_КоличествоНачальныйОстаток,
	|	КлассифицированныеОбороты.Об_КоличествоПриход КАК Об_КоличествоПриход,
	|	КлассифицированныеОбороты.Об_КоличествоРасход КАК Об_КоличествоРасход,
	|	КлассифицированныеОбороты.Об_КоличествоКонечныйОстаток КАК Об_КоличествоКонечныйОстаток,
	|	
	|	// Показатели ""Вес""
	|	КлассифицированныеОбороты.Об_ВесНачальныйОстаток КАК Об_ВесНачальныйОстаток,
	|	КлассифицированныеОбороты.Об_ВесПриход КАК Об_ВесПриход,
	|	КлассифицированныеОбороты.Об_ВесРасход КАК Об_ВесРасход,
	|	КлассифицированныеОбороты.Об_ВесКонечныйОстаток КАК Об_ВесКонечныйОстаток,
	|	
	|	// Показатель ""Объем""
	|	КлассифицированныеОбороты.Об_ОбъемНачальныйОстаток КАК Об_ОбъемНачальныйОстаток,
	|	КлассифицированныеОбороты.Об_ОбъемПриход КАК Об_ОбъемПриход,
	|	КлассифицированныеОбороты.Об_ОбъемРасход КАК Об_ОбъемРасход,
	|	КлассифицированныеОбороты.Об_ОбъемКонечныйОстаток КАК Об_ОбъемКонечныйОстаток,
	|	
	|	// Показатель ""Стоимость""
	|	КлассифицированныеОбороты.Об_СтоимостьПоступленияНачальныйОстаток КАК Об_СтоимостьПоступленияНачальныйОстаток,
	|	КлассифицированныеОбороты.Об_СтоимостьПоступленияПриход КАК Об_СтоимостьПоступленияПриход,
	|	КлассифицированныеОбороты.Об_СтоимостьПоступленияРасход КАК Об_СтоимостьПоступленияРасход,
	|	КлассифицированныеОбороты.Об_СтоимостьПоступленияКонечныйОстаток КАК Об_СтоимостьПоступленияКонечныйОстаток,
	|	
	|	// Показатель ""Доп. расходы""
	|	КлассифицированныеОбороты.Об_ДопРасходыНачальныйОстаток КАК Об_ДопРасходыНачальныйОстаток,
	|	КлассифицированныеОбороты.Об_ДопРасходыПриход КАК Об_ДопРасходыПриход,
	|	КлассифицированныеОбороты.Об_ДопРасходыРасход КАК Об_ДопРасходыРасход,
	|	КлассифицированныеОбороты.Об_ДопРасходыКонечныйОстаток КАК Об_ДопРасходыКонечныйОстаток,
	|
	|	// Показатель ""Трудозатраты""
	|	КлассифицированныеОбороты.Об_ТрудозатратыНачальныйОстаток КАК Об_ТрудозатратыНачальныйОстаток,
	|	КлассифицированныеОбороты.Об_ТрудозатратыПриход КАК Об_ТрудозатратыПриход,
	|	КлассифицированныеОбороты.Об_ТрудозатратыРасход КАК Об_ТрудозатратыРасход,
	|	КлассифицированныеОбороты.Об_ТрудозатратыКонечныйОстаток КАК Об_ТрудозатратыКонечныйОстаток,
	|
	|	// Показатель ""ПостатейныеПостоянные""
	|	КлассифицированныеОбороты.Об_ПостатейныеПостоянныеНачальныйОстаток КАК Об_ПостатейныеПостоянныеНачальныйОстаток,
	|	КлассифицированныеОбороты.Об_ПостатейныеПостоянныеПриход КАК Об_ПостатейныеПостоянныеПриход,
	|	КлассифицированныеОбороты.Об_ПостатейныеПостоянныеРасход КАК Об_ПостатейныеПостоянныеРасход,
	|	КлассифицированныеОбороты.Об_ПостатейныеПостоянныеКонечныйОстаток КАК Об_ПостатейныеПостоянныеКонечныйОстаток,
	|
	|	// Показатель ""ПостатейныеПеременные""
	|	КлассифицированныеОбороты.Об_ПостатейныеПеременныеНачальныйОстаток КАК Об_ПостатейныеПеременныеНачальныйОстаток,
	|	КлассифицированныеОбороты.Об_ПостатейныеПеременныеПриход КАК Об_ПостатейныеПеременныеПриход,
	|	КлассифицированныеОбороты.Об_ПостатейныеПеременныеРасход КАК Об_ПостатейныеПеременныеРасход,
	|	КлассифицированныеОбороты.Об_ПостатейныеПеременныеКонечныйОстаток КАК Об_ПостатейныеПеременныеКонечныйОстаток,
	|	
	|	// Показатель ""Себестоимость""
	|	КлассифицированныеОбороты.Об_СебестоимостьНачальныйОстаток КАК Об_СебестоимостьНачальныйОстаток,
	|	КлассифицированныеОбороты.Об_СебестоимостьПриход КАК Об_СебестоимостьПриход,
	|	КлассифицированныеОбороты.Об_СебестоимостьРасход КАК Об_СебестоимостьРасход,
	|	КлассифицированныеОбороты.Об_СебестоимостьКонечныйОстаток КАК Об_СебестоимостьКонечныйОстаток,
	|	
	|	// Показатель ""Налоговый учет""
	|	КлассифицированныеОбороты.Об_НалоговыйУчетНачальныйОстаток КАК Об_НалоговыйУчетНачальныйОстаток,
	|	КлассифицированныеОбороты.Об_НалоговыйУчетПриход КАК Об_НалоговыйУчетПриход,
	|	КлассифицированныеОбороты.Об_НалоговыйУчетРасход КАК Об_НалоговыйУчетРасход,
	|	КлассифицированныеОбороты.Об_НалоговыйУчетКонечныйОстаток КАК Об_НалоговыйУчетКонечныйОстаток,
	|
	|	// Показатель ""Постоянная разница""
	|	КлассифицированныеОбороты.Об_ПостояннаяРазницаНачальныйОстаток КАК Об_ПостояннаяРазницаНачальныйОстаток,
	|	КлассифицированныеОбороты.Об_ПостояннаяРазницаПриход КАК Об_ПостояннаяРазницаПриход,
	|	КлассифицированныеОбороты.Об_ПостояннаяРазницаРасход КАК Об_ПостояннаяРазницаРасход,
	|	КлассифицированныеОбороты.Об_ПостояннаяРазницаКонечныйОстаток КАК Об_ПостояннаяРазницаКонечныйОстаток,
	|
	|	// Показатель ""Временная разница""
	|	КлассифицированныеОбороты.Об_ВременнаяРазницаНачальныйОстаток КАК Об_ВременнаяРазницаНачальныйОстаток,
	|	КлассифицированныеОбороты.Об_ВременнаяРазницаПриход КАК Об_ВременнаяРазницаПриход,
	|	КлассифицированныеОбороты.Об_ВременнаяРазницаРасход КАК Об_ВременнаяРазницаРасход,
	|	КлассифицированныеОбороты.Об_ВременнаяРазницаКонечныйОстаток КАК Об_ВременнаяРазницаКонечныйОстаток
	|	
	|{ВЫБРАТЬ
	|	НаборДанных,
	|	ПериодДень,
	|	ПериодНеделя,
	|	ПериодДекада,
	|	ПериодМесяц,
	|	ПериодКвартал,
	|	ПериодПолугодие,
	|	ПериодГод,
	|	АналитикаУчетаНоменклатуры.*,
	|	Номенклатура.*,
	|	ЕдиницаХранения.*,
	|	ЕдиницаДляОтчетов.*,
	|	КоэффициентЕдиницыДляОтчетов,
	|	Характеристика.*,
	|	Серия.*,
	|	Склад.*,
	|	Назначение.*,
	|	НаправлениеДеятельности.*,
	|	ВидЗапасов.*,
	|	Партнер.*,
	|	Менеджер.*,
	|	Подразделение.*,
	|	Сделка.*,
	|	ГруппаФинансовогоУчета.*,
	|	Организация.*,
	|	СтатьяДоходов.*,
	|	СтатьяРасходов.*,
	|	СтатьяДоходовРасходов.*,
	|	АналитикаДоходов.*,
	|	АналитикаРасходов.*,
	|	АналитикаДоходовРасходов.*,
	|	Договор,
	|	Заказ,
	|	Контрагент,
	|	Соглашение,
	|	ТипЗапасов,
	|	ХозяйственнаяОперацияСправочник.*,
	|	ХозяйственнаяОперацияПрихода,
	|	ХозяйственнаяОперацияРасхода,
	|	Об_КоличествоНачальныйОстаток,
	|	Об_КоличествоПриход,
	|	Об_КоличествоРасход,
	|	Об_КоличествоКонечныйОстаток,
	|	Об_ВесНачальныйОстаток,
	|	Об_ВесПриход,
	|	Об_ВесРасход,
	|	Об_ВесКонечныйОстаток,
	|	Об_ОбъемНачальныйОстаток,
	|	Об_ОбъемПриход,
	|	Об_ОбъемРасход,
	|	Об_ОбъемКонечныйОстаток,
	|	Об_СтоимостьПоступленияНачальныйОстаток,
	|	Об_СтоимостьПоступленияПриход,
	|	Об_СтоимостьПоступленияРасход,
	|	Об_СтоимостьПоступленияКонечныйОстаток,
	|	Об_ДопРасходыНачальныйОстаток,
	|	Об_ДопРасходыПриход,
	|	Об_ДопРасходыРасход,
	|	Об_ДопРасходыКонечныйОстаток,
	|	Об_ТрудозатратыНачальныйОстаток,
	|	Об_ТрудозатратыПриход,
	|	Об_ТрудозатратыРасход,
	|	Об_ТрудозатратыКонечныйОстаток,
	|	Об_ПостатейныеПостоянныеНачальныйОстаток,
	|	Об_ПостатейныеПостоянныеПриход,
	|	Об_ПостатейныеПостоянныеРасход,
	|	Об_ПостатейныеПостоянныеКонечныйОстаток,
	|	Об_ПостатейныеПеременныеНачальныйОстаток,
	|	Об_ПостатейныеПеременныеПриход,
	|	Об_ПостатейныеПеременныеРасход,
	|	Об_ПостатейныеПеременныеКонечныйОстаток,
	|	Об_СебестоимостьНачальныйОстаток,
	|	Об_СебестоимостьПриход,
	|	Об_СебестоимостьРасход,
	|	Об_СебестоимостьКонечныйОстаток,
	|	Об_НалоговыйУчетНачальныйОстаток,
	|	Об_НалоговыйУчетПриход,
	|	Об_НалоговыйУчетРасход,
	|	Об_НалоговыйУчетКонечныйОстаток,
	|	Об_ПостояннаяРазницаНачальныйОстаток,
	|	Об_ПостояннаяРазницаПриход,
	|	Об_ПостояннаяРазницаРасход,
	|	Об_ПостояннаяРазницаКонечныйОстаток,
	|	Об_ВременнаяРазницаНачальныйОстаток,
	|	Об_ВременнаяРазницаПриход,
	|	Об_ВременнаяРазницаРасход,
	|	Об_ВременнаяРазницаКонечныйОстаток
	|	}
	|ИЗ
	|	ОборотнаяАналитика КАК КлассифицированныеОбороты";
	
	Возврат ТекстЗапроса;
КонецФункции

#КонецОбласти 

#Область НеклассифицированныеОбороты

Функция ТекстЗапросаНеклассифицированныеОбороты()
	ТекстЗапроса = "
	|////////////////////////////////////////////////////////////////////////////////
	|ВЫБРАТЬ
	|	""НеклассифицированныеОбороты"" КАК НаборДанных,
	|
	|	// Аналитика периодов
	|	НеклассифицированныеОбороты.ПериодДень      КАК ПериодДень,
	|	НеклассифицированныеОбороты.ПериодНеделя    КАК ПериодНеделя,
	|	НеклассифицированныеОбороты.ПериодДекада    КАК ПериодДекада,
	|	НеклассифицированныеОбороты.ПериодМесяц     КАК ПериодМесяц,
	|	НеклассифицированныеОбороты.ПериодКвартал   КАК ПериодКвартал,
	|	НеклассифицированныеОбороты.ПериодПолугодие КАК ПериодПолугодие,
	|	НеклассифицированныеОбороты.ПериодГод       КАК ПериодГод,
	|	
	|	// Общая аналитика
	|	НеклассифицированныеОбороты.АналитикаУчетаНоменклатуры КАК АналитикаУчетаНоменклатуры,
	|	НеклассифицированныеОбороты.Номенклатура               КАК Номенклатура,
	|	НеклассифицированныеОбороты.ЕдиницаХранения            КАК ЕдиницаХранения,
	|	НеклассифицированныеОбороты.ЕдиницаДляОтчетов          КАК ЕдиницаДляОтчетов,
	|	НеклассифицированныеОбороты.КоэффициентЕдиницыДляОтчетов КАК КоэффициентЕдиницыДляОтчетов,
	|	НеклассифицированныеОбороты.Характеристика             КАК Характеристика,
	|	НеклассифицированныеОбороты.Серия                      КАК Серия,
	|	НеклассифицированныеОбороты.Склад                      КАК Склад,
	|	НеклассифицированныеОбороты.Назначение                 КАК Назначение,
	|	НеклассифицированныеОбороты.Назначение.НаправлениеДеятельности КАК НаправлениеДеятельности,
	|	
	|	НеклассифицированныеОбороты.ВидЗапасов    КАК ВидЗапасов,
	|	НеклассифицированныеОбороты.ГруппаФинансовогоУчета КАК ГруппаФинансовогоУчета,
	|	
	|	НеклассифицированныеОбороты.Организация КАК Организация,
	|	
	|	// Аналитика оборотов
	|	NULL КАК СтатьяДоходов,
	|	NULL КАК СтатьяРасходов,
	|	NULL КАК СтатьяДоходовРасходов,
	|	NULL КАК АналитикаДоходов,
	|	NULL КАК АналитикаРасходов,
	|	NULL КАК АналитикаДоходовРасходов,
	|	NULL КАК Договор,
	|	NULL КАК Заказ,
	|	NULL КАК Контрагент,
	|	NULL КАК Соглашение,
	|	NULL КАК ТипЗапасов,
	|	NULL КАК Партнер,
	|	NULL КАК Менеджер,
	|	NULL КАК Подразделение,
	|	NULL КАК Сделка,
	|	NULL КАК ХозяйственнаяОперацияСправочник,
	|	ИСТИНА КАК ХозяйственнаяОперацияПрихода,
	|	ИСТИНА КАК ХозяйственнаяОперацияРасхода,
	|	
	|	// Показатель ""Количество""
	|	0 КАК Об_КоличествоНачальныйОстаток,
	|	0 КАК Об_КоличествоПриход,
	|	0 КАК Об_КоличествоРасход,
	|	0 КАК Об_КоличествоКонечныйОстаток,
	|	
	|	// Показатели ""Вес""
	|	0 КАК Об_ВесНачальныйОстаток,
	|	0 КАК Об_ВесПриход,
	|	0 КАК Об_ВесРасход,
	|	0 КАК Об_ВесКонечныйОстаток,
	|	
	|	// Показатель ""Объем""
	|	0 КАК Об_ОбъемНачальныйОстаток,
	|	0 КАК Об_ОбъемПриход,
	|	0 КАК Об_ОбъемРасход,
	|	0 КАК Об_ОбъемКонечныйОстаток,
	|	
	|	// Показатель ""Стоимость""
	|	0 КАК Об_СтоимостьПоступленияНачальныйОстаток,
	|	0 КАК Об_СтоимостьПоступленияПриход,
	|	0 КАК Об_СтоимостьПоступленияРасход,
	|	0 КАК Об_СтоимостьПоступленияКонечныйОстаток,
	|	
	|	// Показатель ""Доп. расходы""
	|	0 КАК Об_ДопРасходыНачальныйОстаток,
	|	0 КАК Об_ДопРасходыПриход,
	|	0 КАК Об_ДопРасходыРасход,
	|	0 КАК Об_ДопРасходыКонечныйОстаток,
	|	
	|	// Показатель ""Трудозатраты""
	|	0 КАК Об_ТрудозатратыНачальныйОстаток,
	|	0 КАК Об_ТрудозатратыПриход,
	|	0 КАК Об_ТрудозатратыРасход,
	|	0 КАК Об_ТрудозатратыКонечныйОстаток,
	|	
	|	// Показатель ""ПостатейныеПостоянные""
	|	0 КАК Об_ПостатейныеПостоянныеНачальныйОстаток,
	|	0 КАК Об_ПостатейныеПостоянныеПриход,
	|	0 КАК Об_ПостатейныеПостоянныеРасход,
	|	0 КАК Об_ПостатейныеПостоянныеКонечныйОстаток,
	|	
	|	// Показатель ""ПостатейныеПеременные""
	|	0 КАК Об_ПостатейныеПеременныеНачальныйОстаток,
	|	0 КАК Об_ПостатейныеПеременныеПриход,
	|	0 КАК Об_ПостатейныеПеременныеРасход,
	|	0 КАК Об_ПостатейныеПеременныеКонечныйОстаток,
	|	
	|	// Показатель ""Себестоимость""
	|	0 КАК Об_СебестоимостьНачальныйОстаток,
	|	0 КАК Об_СебестоимостьПриход,
	|	0 КАК Об_СебестоимостьРасход,
	|	0 КАК Об_СебестоимостьКонечныйОстаток,
	|	
	|	// Показатель ""Налоговый учет""
	|	0 КАК Об_НалоговыйУчетНачальныйОстаток,
	|	0 КАК Об_НалоговыйУчетПриход,
	|	0 КАК Об_НалоговыйУчетРасход,
	|	0 КАК Об_НалоговыйУчетКонечныйОстаток,
	|
	|	// Показатель ""Постоянная разница""
	|	0 КАК Об_ПостояннаяРазницаНачальныйОстаток,
	|	0 КАК Об_ПостояннаяРазницаПриход,
	|	0 КАК Об_ПостояннаяРазницаРасход,
	|	0 КАК Об_ПостояннаяРазницаКонечныйОстаток,
	|
	|	// Показатель ""Временная разница""
	|	0 КАК Об_ВременнаяРазницаНачальныйОстаток,
	|	0 КАК Об_ВременнаяРазницаПриход,
	|	0 КАК Об_ВременнаяРазницаРасход,
	|	0 КАК Об_ВременнаяРазницаКонечныйОстаток
	|	
	|ИЗ
	|	ОборотнаяАналитика КАК НеклассифицированныеОбороты
	|{ГДЕ
	|	(NULL) КАК СтатьяДоходов,
	|	(NULL) КАК СтатьяРасходов,
	|	(NULL) КАК СтатьяДоходовРасходов,
	|	(NULL) КАК АналитикаДоходов,
	|	(NULL) КАК АналитикаРасходов,
	|	(NULL) КАК АналитикаДоходовРасходов,
	|	(NULL) КАК Договор,
	|	(NULL) КАК Заказ,
	|	(NULL) КАК Контрагент,
	|	(NULL) КАК Соглашение,
	|	(NULL) КАК ТипЗапасов,
	|	(NULL) КАК Партнер,
	|	(NULL) КАК Менеджер,
	|	(NULL) КАК Подразделение,
	|	(NULL) КАК Сделка,
	|	(NULL) КАК ХозяйственнаяОперацияСправочник}";
	Возврат ТекстЗапроса;
КонецФункции

#КонецОбласти 

#Область АналитикаПоДокументу
	
Функция ТекстЗапросаСебестоимостьТоваровОборотыПоЗаписям()
	ТекстЗапроса = "
	|///////////////////////////////////////////////////////////////////////////////
	|ВЫБРАТЬ РАЗРЕШЕННЫЕ
	|
	|	// Аналитика периодов
	|	Записи.ПериодДень,
	|	Записи.ПериодНеделя,
	|	Записи.ПериодДекада,
	|	Записи.ПериодМесяц,
	|	Записи.ПериодКвартал,
	|	Записи.ПериодПолугодие,
	|	Записи.ПериодГод,
	|
	|	// Общая аналитика
	|	Записи.АналитикаУчетаНоменклатуры,
	|	Записи.Номенклатура,
	|	Записи.ЕдиницаХранения,
	|	Записи.ЕдиницаДляОтчетов,
	|	Записи.Характеристика,
	|	Записи.Серия,
	|	Записи.Склад,
	|	Записи.Назначение,
	|	Записи.Назначение.НаправлениеДеятельности,
	|	Записи.ВидЗапасов,
	|	Записи.Партнер,
	|	Записи.Менеджер,
	|	Записи.Подразделение,
	|	Записи.Сделка,
	|	Записи.ГруппаФинансовогоУчета,
	|	Записи.Организация,
	|
	|	// Аналитика оборотов
	|	Записи.СтатьяДоходов.Ссылка КАК СтатьяДоходов,
	|	Записи.СтатьяРасходов.Ссылка КАК СтатьяРасходов,
	|	Записи.СтатьяДоходовРасходов.Ссылка КАК СтатьяДоходовРасходов,
	|	ВЫБОР
	|		КОГДА Записи.АналитикаДоходов = НЕОПРЕДЕЛЕНО
	|			ТОГДА NULL
	|		ИНАЧЕ Записи.АналитикаДоходов
	|	КОНЕЦ КАК АналитикаДоходов,
	|	ВЫБОР
	|		КОГДА Записи.АналитикаРасходов = НЕОПРЕДЕЛЕНО
	|			ТОГДА NULL
	|		ИНАЧЕ Записи.АналитикаРасходов
	|	КОНЕЦ КАК АналитикаРасходов,
	|	ВЫБОР
	|		КОГДА Записи.АналитикаДоходовРасходов = НЕОПРЕДЕЛЕНО
	|			ТОГДА NULL
	|		ИНАЧЕ Записи.АналитикаДоходовРасходов
	|	КОНЕЦ КАК АналитикаДоходовРасходов,
	|	ВЫБОР
	|		КОГДА Записи.Заказ = НЕОПРЕДЕЛЕНО
	|			ТОГДА NULL
	|		ИНАЧЕ Записи.Заказ
	|	КОНЕЦ КАК Заказ,
	|	Записи.Контрагент КАК Контрагент,
	|	Записи.Договор КАК Договор,
	|	ВЫБОР
	|		КОГДА Записи.Соглашение = НЕОПРЕДЕЛЕНО
	|			ТОГДА NULL
	|		ИНАЧЕ Записи.Соглашение
	|	КОНЕЦ КАК Соглашение,
	|	Записи.ТипЗапасов КАК ТипЗапасов,
	|	Записи.ХозяйственнаяОперацияСправочник КАК ХозяйственнаяОперацияСправочник,
	|	Записи.ХозяйственнаяОперацияПрихода,
	|	Записи.ХозяйственнаяОперацияРасхода,
	|
	|	// Аналитика-документ
	|	Записи.Документ,
	|
	|	// Показатель ""Количество""
	|	Записи.Док_КоличествоНачальныйОстаток,
	|	Записи.Док_КоличествоПриход,
	|	Записи.Док_КоличествоРасход,
	|	Записи.Док_КоличествоКонечныйОстаток,
	|
	|	// Показатель ""Вес""
	|	Записи.Док_ВесНачальныйОстаток,
	|	Записи.Док_ВесПриход,
	|	Записи.Док_ВесРасход,
	|	Записи.Док_ВесКонечныйОстаток,
	|
	|	// Показатель ""Объем""
	|	Записи.Док_ОбъемНачальныйОстаток,
	|	Записи.Док_ОбъемПриход,
	|	Записи.Док_ОбъемРасход,
	|	Записи.Док_ОбъемКонечныйОстаток,
	|
	|	// Показатель ""СтоимостьПоступдения""
	|	Записи.Док_СтоимостьПоступленияНачальныйОстаток,
	|	Записи.Док_СтоимостьПоступленияПриход,
	|	Записи.Док_СтоимостьПоступленияРасход,
	|	Записи.Док_СтоимостьПоступленияКонечныйОстаток,
	|
	|	// Показатель ""ДопРасходы""
	|	Записи.Док_ДопРасходыНачальныйОстаток,
	|	Записи.Док_ДопРасходыПриход,
	|	Записи.Док_ДопРасходыРасход,
	|	Записи.Док_ДопРасходыКонечныйОстаток,
	|
	|	// Показатель ""Трудозатраты""
	|	Записи.Док_ТрудозатратыНачальныйОстаток,
	|	Записи.Док_ТрудозатратыПриход,
	|	Записи.Док_ТрудозатратыРасход,
	|	Записи.Док_ТрудозатратыКонечныйОстаток,
	|
	|	// Показатель ""ПостатейныеПостоянные""
	|	Записи.Док_ПостатейныеПостоянныеНачальныйОстаток,
	|	Записи.Док_ПостатейныеПостоянныеПриход,
	|	Записи.Док_ПостатейныеПостоянныеРасход,
	|	Записи.Док_ПостатейныеПостоянныеКонечныйОстаток,
	|
	|	// Показатель ""ПостатейныеПеременные""
	|	Записи.Док_ПостатейныеПеременныеНачальныйОстаток,
	|	Записи.Док_ПостатейныеПеременныеПриход,
	|	Записи.Док_ПостатейныеПеременныеРасход,
	|	Записи.Док_ПостатейныеПеременныеКонечныйОстаток,
	|
	|	// Показатель ""Себестоимость""
	|	Записи.Док_СебестоимостьНачальныйОстаток,
	|	Записи.Док_СебестоимостьПриход,
	|	Записи.Док_СебестоимостьРасход,
	|	Записи.Док_СебестоимостьКонечныйОстаток,
	|
	|	// Показатель ""Налоговый учет""
	|	Записи.Док_НалоговыйУчетНачальныйОстаток,
	|	Записи.Док_НалоговыйУчетПриход,
	|	Записи.Док_НалоговыйУчетРасход,
	|	Записи.Док_НалоговыйУчетКонечныйОстаток,
	|
	|	// Показатель ""Постоянная разница""
	|	Записи.Док_ПостояннаяРазницаНачальныйОстаток,
	|	Записи.Док_ПостояннаяРазницаПриход,
	|	Записи.Док_ПостояннаяРазницаРасход,
	|	Записи.Док_ПостояннаяРазницаКонечныйОстаток,
	|
	|	// Показатель ""Временная разница""
	|	Записи.Док_ВременнаяРазницаНачальныйОстаток,
	|	Записи.Док_ВременнаяРазницаПриход,
	|	Записи.Док_ВременнаяРазницаРасход,
	|	Записи.Док_ВременнаяРазницаКонечныйОстаток
	|ИЗ
	|	(ВЫБРАТЬ
	|
	|	// Аналитика периодов
	|	НАЧАЛОПЕРИОДА(СебестоимостьТоваровЗаписи.Период, ДЕНЬ)      КАК ПериодДень,
	|	НАЧАЛОПЕРИОДА(СебестоимостьТоваровЗаписи.Период, НЕДЕЛЯ)    КАК ПериодНеделя,
	|	НАЧАЛОПЕРИОДА(СебестоимостьТоваровЗаписи.Период, ДЕКАДА)    КАК ПериодДекада,
	|	НАЧАЛОПЕРИОДА(СебестоимостьТоваровЗаписи.Период, МЕСЯЦ)     КАК ПериодМесяц,
	|	НАЧАЛОПЕРИОДА(СебестоимостьТоваровЗаписи.Период, КВАРТАЛ)   КАК ПериодКвартал,
	|	НАЧАЛОПЕРИОДА(СебестоимостьТоваровЗаписи.Период, ПОЛУГОДИЕ) КАК ПериодПолугодие,
	|	НАЧАЛОПЕРИОДА(СебестоимостьТоваровЗаписи.Период, ГОД)       КАК ПериодГод,
	|	
	|	// Общая аналитика
	|	СебестоимостьТоваровЗаписи.АналитикаУчетаНоменклатуры КАК АналитикаУчетаНоменклатуры,
	|	АналитикаНоменклатуры.Номенклатура                     КАК Номенклатура,
	|	АналитикаНоменклатуры.Номенклатура.ЕдиницаИзмерения    КАК ЕдиницаХранения,
	|	АналитикаНоменклатуры.Номенклатура.ЕдиницаДляОтчетов   КАК ЕдиницаДляОтчетов,
	|	АналитикаНоменклатуры.Номенклатура.КоэффициентЕдиницыДляОтчетов   КАК КоэффициентЕдиницыДляОтчетов,
	|	АналитикаНоменклатуры.Характеристика                   КАК Характеристика,
	|	АналитикаНоменклатуры.Серия                            КАК Серия,
	|	АналитикаНоменклатуры.Склад                            КАК Склад,
	|	АналитикаНоменклатуры.Назначение                       КАК Назначение,
	|	АналитикаНоменклатуры.Назначение.НаправлениеДеятельности КАК НаправлениеДеятельности,
	|	
	|	СебестоимостьТоваровЗаписи.ВидЗапасов               КАК ВидЗапасов,
	|	ЕСТЬNULL(ВЫРАЗИТЬ(СебестоимостьТоваровЗаписи.АналитикаФинансовогоУчета КАК Справочник.Пользователи), НЕОПРЕДЕЛЕНО) КАК Менеджер,
	|	ЕСТЬNULL(ВЫРАЗИТЬ(СебестоимостьТоваровЗаписи.АналитикаФинансовогоУчета КАК Справочник.СтруктураПредприятия), НЕОПРЕДЕЛЕНО) КАК Подразделение,
	|	ЕСТЬNULL(ВЫРАЗИТЬ(СебестоимостьТоваровЗаписи.АналитикаФинансовогоУчета КАК Справочник.СделкиСКлиентами), НЕОПРЕДЕЛЕНО) КАК Сделка,
	|	
	|	ВЫБОР 
	|		КОГДА &ФормироватьВидыЗапасовПоГруппамФинансовогоУчета 
	|			ТОГДА СебестоимостьТоваровЗаписи.ВидЗапасов.ГруппаФинансовогоУчета
	|			ИНАЧЕ АналитикаНоменклатуры.Номенклатура.ГруппаФинансовогоУчета
	|	КОНЕЦ КАК ГруппаФинансовогоУчета,
	|
	|	СебестоимостьТоваровЗаписи.Организация КАК Организация,
	|	
	|	// Аналитика оборотов
	|	СебестоимостьТоваровЗаписи.СтатьяДоходов КАК СтатьяДоходов,
	|	СебестоимостьТоваровЗаписи.СтатьяРасходовСписания КАК СтатьяРасходов,
	|	ВЫБОР
	|		КОГДА НЕ СебестоимостьТоваровЗаписи.СтатьяДоходов.Ссылка ЕСТЬ NULL
	|			ТОГДА СебестоимостьТоваровЗаписи.СтатьяДоходов
	|		КОГДА НЕ СебестоимостьТоваровЗаписи.СтатьяРасходовСписания.Ссылка ЕСТЬ NULL
	|			ТОГДА СебестоимостьТоваровЗаписи.СтатьяРасходовСписания
	|	КОНЕЦ                          КАК СтатьяДоходовРасходов,
	|	СебестоимостьТоваровЗаписи.АналитикаДоходов КАК АналитикаДоходов,
	|	СебестоимостьТоваровЗаписи.АналитикаРасходов КАК АналитикаРасходов,
	|	ВЫБОР
	|		КОГДА НЕ ТИПЗНАЧЕНИЯ(СебестоимостьТоваровЗаписи.АналитикаДоходов) ЕСТЬ NULL
	|			ТОГДА СебестоимостьТоваровЗаписи.АналитикаДоходов
	|		КОГДА НЕ ТИПЗНАЧЕНИЯ(СебестоимостьТоваровЗаписи.АналитикаРасходов) ЕСТЬ NULL
	|			ТОГДА СебестоимостьТоваровЗаписи.АналитикаРасходов
	|	КОНЕЦ                          КАК АналитикаДоходовРасходов,
	|	СебестоимостьТоваровЗаписи.ЗаказКлиента КАК Заказ,
	|
	|	&ТекстЗапросаПолученияОборотнойАналитикиПартнер КАК Партнер,
	|	&ТекстЗапросаПолученияОборотнойАналитикиКонтрагент КАК Контрагент,
	|	&ТекстЗапросаПолученияОборотнойАналитикиДоговор КАК Договор,
	|	&ТекстЗапросаПолученияОборотнойАналитикиСоглашение КАК Соглашение,
	|
	|	NULL КАК ТипЗапасов,
	|	НастройкиХозопераций.Ссылка КАК ХозяйственнаяОперацияСправочник,
	|	ВЫБОР
	|		КОГДА СебестоимостьТоваровЗаписи.ВидДвижения = ЗНАЧЕНИЕ(ВидДвиженияНакопления.Приход) 
	|		ТОГДА ИСТИНА
	|		ИНАЧЕ ЛОЖЬ 
	|	КОНЕЦ КАК ХозяйственнаяОперацияПрихода,
	|	ВЫБОР
	|		КОГДА СебестоимостьТоваровЗаписи.ВидДвижения = ЗНАЧЕНИЕ(ВидДвиженияНакопления.Расход) 
	|		ТОГДА ИСТИНА
	|		ИНАЧЕ ЛОЖЬ 
	|	КОНЕЦ КАК ХозяйственнаяОперацияРасхода,
	|
	|	// Аналитика-документ
	|	ВЫБОР 
	|		КОГДА (СебестоимостьТоваровЗаписи.Регистратор Ссылка Документ.РасчетСебестоимостиТоваров ИЛИ СебестоимостьТоваровЗаписи.РасчетСебестоимости)
	|			И НЕ СебестоимостьТоваровЗаписи.ХозяйственнаяОперация.Ссылка ЕСТЬ NULL
	|			ТОГДА СебестоимостьТоваровЗаписи.ДокументДвижения
	|			ИНАЧЕ СебестоимостьТоваровЗаписи.Регистратор
	|	КОНЕЦ КАК Документ,
	|
	|	// Показатель ""Количество""
	|	0 КАК Док_КоличествоНачальныйОстаток,
	|	ВЫБОР
	|		КОГДА СебестоимостьТоваровЗаписи.ВидДвижения = ЗНАЧЕНИЕ(ВидДвиженияНакопления.Приход) 
	|		ТОГДА 1
	|		ИНАЧЕ 0 
	|	КОНЕЦ  * ВЫБОР КОГДА &ЕдиницыКоличества = 0 ТОГДА 1 ИНАЧЕ 1/АналитикаНоменклатуры.Номенклатура.КоэффициентЕдиницыДляОтчетов КОНЕЦ *
	|	СебестоимостьТоваровЗаписи.Количество КАК Док_КоличествоПриход,
	|	ВЫБОР
	|		КОГДА СебестоимостьТоваровЗаписи.ВидДвижения = ЗНАЧЕНИЕ(ВидДвиженияНакопления.Расход) 
	|		ТОГДА 1
	|		ИНАЧЕ 0 
	|	КОНЕЦ  * ВЫБОР КОГДА &ЕдиницыКоличества = 0 ТОГДА 1 ИНАЧЕ 1/АналитикаНоменклатуры.Номенклатура.КоэффициентЕдиницыДляОтчетов КОНЕЦ *
	|	СебестоимостьТоваровЗаписи.Количество КАК Док_КоличествоРасход,
	|	0 КАК Док_КоличествоКонечныйОстаток,
	|	
	|	// Показатель ""Вес""
	|	0   КАК Док_ВесНачальныйОстаток,
	|	ВЫБОР
	|		КОГДА СебестоимостьТоваровЗаписи.ВидДвижения = ЗНАЧЕНИЕ(ВидДвиженияНакопления.Приход) 
	|		ТОГДА 1
	|		ИНАЧЕ 0 
	|	КОНЕЦ *
	|	СебестоимостьТоваровЗаписи.Количество * &ТекстЗапросаВесУпаковки    КАК Док_ВесПриход,
	|	ВЫБОР
	|		КОГДА СебестоимостьТоваровЗаписи.ВидДвижения = ЗНАЧЕНИЕ(ВидДвиженияНакопления.Расход) 
	|		ТОГДА 1
	|		ИНАЧЕ 0 
	|	КОНЕЦ *
	|	СебестоимостьТоваровЗаписи.Количество * &ТекстЗапросаВесУпаковки    КАК Док_ВесРасход,
	|	0    КАК Док_ВесКонечныйОстаток,
	|	
	|	// Показатель ""Объем""
	|	0 КАК Док_ОбъемНачальныйОстаток,
	|	ВЫБОР
	|		КОГДА СебестоимостьТоваровЗаписи.ВидДвижения = ЗНАЧЕНИЕ(ВидДвиженияНакопления.Приход) 
	|		ТОГДА 1
	|		ИНАЧЕ 0 
	|	КОНЕЦ *
	|	СебестоимостьТоваровЗаписи.Количество * &ТекстЗапросаОбъемУпаковки  КАК Док_ОбъемПриход,
	|	ВЫБОР
	|		КОГДА СебестоимостьТоваровЗаписи.ВидДвижения = ЗНАЧЕНИЕ(ВидДвиженияНакопления.Расход) 
	|		ТОГДА 1
	|		ИНАЧЕ 0 
	|	КОНЕЦ *
	|	СебестоимостьТоваровЗаписи.Количество * &ТекстЗапросаОбъемУпаковки  КАК Док_ОбъемРасход,
	|	0  КАК Док_ОбъемКонечныйОстаток,
	|	
	|	// Показатель ""Стоимость""
	|	0 КАК Док_СтоимостьПоступленияНачальныйОстаток,
	|	ВЫБОР
	|		КОГДА СебестоимостьТоваровЗаписи.ВидДвижения = ЗНАЧЕНИЕ(ВидДвиженияНакопления.Приход) 
	|		ТОГДА 1
	|		ИНАЧЕ 0 
	|	КОНЕЦ *
	|	ВЫБОР 
	|		КОГДА &ДанныеОтчета = 1 
	|			ТОГДА СебестоимостьТоваровЗаписи.Стоимость
	|				+ СебестоимостьТоваровЗаписи.СтоимостьЗабалансовая
	|		КОГДА &ДанныеОтчета = 2 
	|			ТОГДА СебестоимостьТоваровЗаписи.СтоимостьБезНДС
	|				+ СебестоимостьТоваровЗаписи.СтоимостьЗабалансовая
	|		КОГДА &ДанныеОтчета = 3 
	|			ТОГДА СебестоимостьТоваровЗаписи.СтоимостьУпр
	|				+ СебестоимостьТоваровЗаписи.СтоимостьЗабалансовая
	|		КОГДА &ДанныеОтчета = 4 
	|			ТОГДА СебестоимостьТоваровЗаписи.СтоимостьРегл
	|				+ СебестоимостьТоваровЗаписи.СтоимостьЗабалансоваяРегл
	|		ИНАЧЕ
	|			ВЫБОР КОГДА &ПоПредприятию ТОГДА
	|				СебестоимостьТоваровЗаписи.Стоимость
	|				+ СебестоимостьТоваровЗаписи.СтоимостьЗабалансовая
	|			ИНАЧЕ
	|				СебестоимостьТоваровЗаписи.СтоимостьУпр
	|				+ СебестоимостьТоваровЗаписи.СтоимостьЗабалансовая
	|			КОНЕЦ	
	|	КОНЕЦ КАК Док_СтоимостьПоступленияПриход,
	|	ВЫБОР
	|		КОГДА СебестоимостьТоваровЗаписи.ВидДвижения = ЗНАЧЕНИЕ(ВидДвиженияНакопления.Расход) 
	|		ТОГДА 1
	|		ИНАЧЕ 0 
	|	КОНЕЦ *
	|	ВЫБОР 
	|		КОГДА &ДанныеОтчета = 1 
	|			ТОГДА СебестоимостьТоваровЗаписи.Стоимость
	|				+ СебестоимостьТоваровЗаписи.СтоимостьЗабалансовая
	|		КОГДА &ДанныеОтчета = 2 
	|			ТОГДА СебестоимостьТоваровЗаписи.СтоимостьБезНДС
	|				+ СебестоимостьТоваровЗаписи.СтоимостьЗабалансовая
	|		КОГДА &ДанныеОтчета = 3 
	|			ТОГДА СебестоимостьТоваровЗаписи.СтоимостьУпр
	|				+ СебестоимостьТоваровЗаписи.СтоимостьЗабалансовая
	|		КОГДА &ДанныеОтчета = 4 
	|			ТОГДА СебестоимостьТоваровЗаписи.СтоимостьРегл
	|				+ СебестоимостьТоваровЗаписи.СтоимостьЗабалансоваяРегл
	|		ИНАЧЕ
	|			ВЫБОР КОГДА &ПоПредприятию ТОГДА
	|				СебестоимостьТоваровЗаписи.Стоимость
	|				+ СебестоимостьТоваровЗаписи.СтоимостьЗабалансовая
	|			ИНАЧЕ
	|				СебестоимостьТоваровЗаписи.СтоимостьУпр
	|				+ СебестоимостьТоваровЗаписи.СтоимостьЗабалансовая
	|			КОНЕЦ	
	|	КОНЕЦ КАК Док_СтоимостьПоступленияРасход,
	|	0	КАК Док_СтоимостьПоступленияКонечныйОстаток,
	|	
	|	// Показатель ""Доп. расходы""
	|	0 КАК Док_ДопРасходыНачальныйОстаток,
	|	ВЫБОР
	|		КОГДА СебестоимостьТоваровЗаписи.ВидДвижения = ЗНАЧЕНИЕ(ВидДвиженияНакопления.Приход) 
	|		ТОГДА 1
	|		ИНАЧЕ 0 
	|	КОНЕЦ *
	|	ВЫБОР 
	|		КОГДА &ДанныеОтчета = 1 
	|			ТОГДА СебестоимостьТоваровЗаписи.ДопРасходы
	|		КОГДА &ДанныеОтчета = 2 
	|			ТОГДА СебестоимостьТоваровЗаписи.ДопРасходыБезНДС
	|		КОГДА &ДанныеОтчета = 3 
	|			ТОГДА СебестоимостьТоваровЗаписи.ДопРасходыУпр
	|		КОГДА &ДанныеОтчета = 4 
	|			ТОГДА СебестоимостьТоваровЗаписи.ДопРасходыРегл
	|		ИНАЧЕ 
	|			ВЫБОР КОГДА &ПоПредприятию ТОГДА
	|				СебестоимостьТоваровЗаписи.ДопРасходыБезНДС
	|			ИНАЧЕ
	|				СебестоимостьТоваровЗаписи.ДопРасходыУпр
	|			КОНЕЦ
	|	КОНЕЦ КАК Док_ДопРасходыПриход,
	|	ВЫБОР
	|		КОГДА СебестоимостьТоваровЗаписи.ВидДвижения = ЗНАЧЕНИЕ(ВидДвиженияНакопления.Расход) 
	|		ТОГДА 1
	|		ИНАЧЕ 0 
	|	КОНЕЦ *
	|	ВЫБОР 
	|		КОГДА &ДанныеОтчета = 1 
	|			ТОГДА СебестоимостьТоваровЗаписи.ДопРасходы
	|		КОГДА &ДанныеОтчета = 2 
	|			ТОГДА СебестоимостьТоваровЗаписи.ДопРасходыБезНДС
	|		КОГДА &ДанныеОтчета = 3 
	|			ТОГДА СебестоимостьТоваровЗаписи.ДопРасходыУпр
	|		КОГДА &ДанныеОтчета = 4 
	|			ТОГДА СебестоимостьТоваровЗаписи.ДопРасходыРегл
	|		ИНАЧЕ 
	|			ВЫБОР КОГДА &ПоПредприятию ТОГДА
	|				СебестоимостьТоваровЗаписи.ДопРасходыБезНДС
	|			ИНАЧЕ
	|				СебестоимостьТоваровЗаписи.ДопРасходыУпр
	|			КОНЕЦ
	|	КОНЕЦ КАК Док_ДопРасходыРасход,
	|	0 КАК Док_ДопРасходыКонечныйОстаток,
	|	
	|	// Показатель ""Трудозатраты""
	|	0 КАК Док_ТрудозатратыНачальныйОстаток,
	|	ВЫБОР
	|		КОГДА СебестоимостьТоваровЗаписи.ВидДвижения = ЗНАЧЕНИЕ(ВидДвиженияНакопления.Приход) 
	|		ТОГДА 1
	|		ИНАЧЕ 0 
	|	КОНЕЦ *
	|	ВЫБОР 
	|		КОГДА &ДанныеОтчета = 1 
	|			ТОГДА СебестоимостьТоваровЗаписи.Трудозатраты
	|		КОГДА &ДанныеОтчета = 2 
	|			ТОГДА СебестоимостьТоваровЗаписи.Трудозатраты
	|		КОГДА &ДанныеОтчета = 3 
	|			ТОГДА СебестоимостьТоваровЗаписи.ТрудозатратыУпр
	|		КОГДА &ДанныеОтчета = 4 
	|			ТОГДА СебестоимостьТоваровЗаписи.ТрудозатратыРегл
	|		ИНАЧЕ 
	|			ВЫБОР КОГДА &ПоПредприятию ТОГДА
	|				СебестоимостьТоваровЗаписи.Трудозатраты
	|			ИНАЧЕ
	|				СебестоимостьТоваровЗаписи.ТрудозатратыУпр
	|			КОНЕЦ
	|	КОНЕЦ КАК Док_ТрудозатратыПриход,
	|	ВЫБОР
	|		КОГДА СебестоимостьТоваровЗаписи.ВидДвижения = ЗНАЧЕНИЕ(ВидДвиженияНакопления.Расход) 
	|		ТОГДА 1
	|		ИНАЧЕ 0 
	|	КОНЕЦ *
	|	ВЫБОР 
	|		КОГДА &ДанныеОтчета = 1 
	|			ТОГДА СебестоимостьТоваровЗаписи.Трудозатраты
	|		КОГДА &ДанныеОтчета = 2 
	|			ТОГДА СебестоимостьТоваровЗаписи.Трудозатраты
	|		КОГДА &ДанныеОтчета = 3 
	|			ТОГДА СебестоимостьТоваровЗаписи.ТрудозатратыУпр
	|		КОГДА &ДанныеОтчета = 4 
	|			ТОГДА СебестоимостьТоваровЗаписи.ТрудозатратыРегл
	|		ИНАЧЕ 
	|			ВЫБОР КОГДА &ПоПредприятию ТОГДА
	|				СебестоимостьТоваровЗаписи.Трудозатраты
	|			ИНАЧЕ
	|				СебестоимостьТоваровЗаписи.ТрудозатратыУпр
	|			КОНЕЦ
	|	КОНЕЦ КАК Док_ТрудозатратыРасход,
	|	0 КАК Док_ТрудозатратыКонечныйОстаток,
	|	
	|	// Показатель ""ПостатейныеПостоянные""
	|	0 КАК Док_ПостатейныеПостоянныеНачальныйОстаток,
	|	ВЫБОР
	|		КОГДА СебестоимостьТоваровЗаписи.ВидДвижения = ЗНАЧЕНИЕ(ВидДвиженияНакопления.Приход) 
	|		ТОГДА 1
	|		ИНАЧЕ 0 
	|	КОНЕЦ *
	|	ВЫБОР 
	|		КОГДА &ДанныеОтчета = 1 
	|			ТОГДА СебестоимостьТоваровЗаписи.ПостатейныеПостоянныеСНДС
	|		КОГДА &ДанныеОтчета = 2 
	|			ТОГДА СебестоимостьТоваровЗаписи.ПостатейныеПостоянныеБезНДС
	|		КОГДА &ДанныеОтчета = 3 
	|			ТОГДА СебестоимостьТоваровЗаписи.ПостатейныеПостоянныеУпр
	|		КОГДА &ДанныеОтчета = 4 
	|			ТОГДА СебестоимостьТоваровЗаписи.ПостатейныеПостоянныеРегл
	|		ИНАЧЕ 
	|			ВЫБОР КОГДА &ПоПредприятию ТОГДА
	|				СебестоимостьТоваровЗаписи.ПостатейныеПостоянныеБезНДС
	|			ИНАЧЕ
	|				СебестоимостьТоваровЗаписи.ПостатейныеПостоянныеУпр
	|			КОНЕЦ
	|	КОНЕЦ КАК Док_ПостатейныеПостоянныеПриход,
	|	ВЫБОР
	|		КОГДА СебестоимостьТоваровЗаписи.ВидДвижения = ЗНАЧЕНИЕ(ВидДвиженияНакопления.Расход) 
	|		ТОГДА 1
	|		ИНАЧЕ 0 
	|	КОНЕЦ *
	|	ВЫБОР 
	|		КОГДА &ДанныеОтчета = 1 
	|			ТОГДА СебестоимостьТоваровЗаписи.ПостатейныеПостоянныеСНДС
	|		КОГДА &ДанныеОтчета = 2 
	|			ТОГДА СебестоимостьТоваровЗаписи.ПостатейныеПостоянныеБезНДС
	|		КОГДА &ДанныеОтчета = 3 
	|			ТОГДА СебестоимостьТоваровЗаписи.ПостатейныеПостоянныеУпр
	|		КОГДА &ДанныеОтчета = 4 
	|			ТОГДА СебестоимостьТоваровЗаписи.ПостатейныеПостоянныеРегл
	|		ИНАЧЕ 
	|			ВЫБОР КОГДА &ПоПредприятию ТОГДА
	|				СебестоимостьТоваровЗаписи.ПостатейныеПостоянныеБезНДС
	|			ИНАЧЕ
	|				СебестоимостьТоваровЗаписи.ПостатейныеПостоянныеУпр
	|			КОНЕЦ
	|	КОНЕЦ КАК Док_ПостатейныеПостоянныеРасход,
	|	0 КАК Док_ПостатейныеПостоянныеКонечныйОстаток,
	|	
	|	// Показатель ""ПостатейныеПеременные""
	|	0 КАК Док_ПостатейныеПеременныеНачальныйОстаток,
	|	ВЫБОР
	|		КОГДА СебестоимостьТоваровЗаписи.ВидДвижения = ЗНАЧЕНИЕ(ВидДвиженияНакопления.Приход) 
	|		ТОГДА 1
	|		ИНАЧЕ 0 
	|	КОНЕЦ *
	|	ВЫБОР 
	|		КОГДА &ДанныеОтчета = 1 
	|			ТОГДА СебестоимостьТоваровЗаписи.ПостатейныеПеременныеСНДС
	|		КОГДА &ДанныеОтчета = 2 
	|			ТОГДА СебестоимостьТоваровЗаписи.ПостатейныеПеременныеБезНДС
	|		КОГДА &ДанныеОтчета = 3 
	|			ТОГДА СебестоимостьТоваровЗаписи.ПостатейныеПеременныеУпр
	|		КОГДА &ДанныеОтчета = 4 
	|			ТОГДА СебестоимостьТоваровЗаписи.ПостатейныеПеременныеРегл
	|		ИНАЧЕ 
	|			ВЫБОР КОГДА &ПоПредприятию ТОГДА
	|				СебестоимостьТоваровЗаписи.ПостатейныеПеременныеБезНДС
	|			ИНАЧЕ
	|				СебестоимостьТоваровЗаписи.ПостатейныеПеременныеУпр
	|			КОНЕЦ
	|	КОНЕЦ КАК Док_ПостатейныеПеременныеПриход,
	|	ВЫБОР
	|		КОГДА СебестоимостьТоваровЗаписи.ВидДвижения = ЗНАЧЕНИЕ(ВидДвиженияНакопления.Расход) 
	|		ТОГДА 1
	|		ИНАЧЕ 0 
	|	КОНЕЦ *
	|	ВЫБОР 
	|		КОГДА &ДанныеОтчета = 1 
	|			ТОГДА СебестоимостьТоваровЗаписи.ПостатейныеПеременныеСНДС
	|		КОГДА &ДанныеОтчета = 2 
	|			ТОГДА СебестоимостьТоваровЗаписи.ПостатейныеПеременныеБезНДС
	|		КОГДА &ДанныеОтчета = 3 
	|			ТОГДА СебестоимостьТоваровЗаписи.ПостатейныеПеременныеУпр
	|		КОГДА &ДанныеОтчета = 4 
	|			ТОГДА СебестоимостьТоваровЗаписи.ПостатейныеПеременныеРегл
	|		ИНАЧЕ 
	|			ВЫБОР КОГДА &ПоПредприятию ТОГДА
	|				СебестоимостьТоваровЗаписи.ПостатейныеПеременныеБезНДС
	|			ИНАЧЕ
	|				СебестоимостьТоваровЗаписи.ПостатейныеПеременныеУпр
	|			КОНЕЦ
	|	КОНЕЦ КАК Док_ПостатейныеПеременныеРасход,
	|	0 КАК Док_ПостатейныеПеременныеКонечныйОстаток,
	|
	|	// Показатель ""Себестоимость""
	|	0 КАК Док_СебестоимостьНачальныйОстаток,
	|	ВЫБОР
	|		КОГДА СебестоимостьТоваровЗаписи.ВидДвижения = ЗНАЧЕНИЕ(ВидДвиженияНакопления.Приход) 
	|		ТОГДА 1
	|		ИНАЧЕ 0 
	|	КОНЕЦ *
	|	ВЫБОР 
	|		КОГДА &ДанныеОтчета = 1 
	|			ТОГДА СебестоимостьТоваровЗаписи.Стоимость
	|				+ СебестоимостьТоваровЗаписи.ДопРасходы 
	|				+ СебестоимостьТоваровЗаписи.СтоимостьЗабалансовая
	|				+ СебестоимостьТоваровЗаписи.Трудозатраты
	|				+ СебестоимостьТоваровЗаписи.ПостатейныеПостоянныеСНДС
	|				+ СебестоимостьТоваровЗаписи.ПостатейныеПеременныеСНДС
	|		КОГДА &ДанныеОтчета = 2 
	|			ТОГДА СебестоимостьТоваровЗаписи.СтоимостьБезНДС
	|				+ СебестоимостьТоваровЗаписи.ДопРасходыБезНДС 
	|				+ СебестоимостьТоваровЗаписи.СтоимостьЗабалансовая
	|				+ СебестоимостьТоваровЗаписи.Трудозатраты
	|				+ СебестоимостьТоваровЗаписи.ПостатейныеПостоянныеБезНДС
	|				+ СебестоимостьТоваровЗаписи.ПостатейныеПеременныеБезНДС
	|		КОГДА &ДанныеОтчета = 3
	|			ТОГДА СебестоимостьТоваровЗаписи.СтоимостьУпр
	|			+ СебестоимостьТоваровЗаписи.СтоимостьЗабалансовая
	|			+ СебестоимостьТоваровЗаписи.ТрудозатратыУпр
	|			+ СебестоимостьТоваровЗаписи.ПостатейныеПостоянныеУпр
	|			+ СебестоимостьТоваровЗаписи.ПостатейныеПеременныеУпр
	|		КОГДА &ДанныеОтчета = 4 
	|			ТОГДА СебестоимостьТоваровЗаписи.СтоимостьРегл
	|				+ СебестоимостьТоваровЗаписи.ДопРасходыРегл
	|				+ СебестоимостьТоваровЗаписи.СтоимостьЗабалансоваяРегл
	|				+ СебестоимостьТоваровЗаписи.ТрудозатратыРегл
	|				+ СебестоимостьТоваровЗаписи.ПостатейныеПостоянныеРегл
	|				+ СебестоимостьТоваровЗаписи.ПостатейныеПеременныеРегл
	|		ИНАЧЕ
	|			ВЫБОР КОГДА &ПоПредприятию ТОГДА
	|				СебестоимостьТоваровЗаписи.СтоимостьБезНДС
	|				+ СебестоимостьТоваровЗаписи.СтоимостьЗабалансовая
	|				+ СебестоимостьТоваровЗаписи.Трудозатраты
	|				+ СебестоимостьТоваровЗаписи.ПостатейныеПостоянныеБезНДС
	|				+ СебестоимостьТоваровЗаписи.ПостатейныеПеременныеБезНДС
	|			ИНАЧЕ
	|				СебестоимостьТоваровЗаписи.СтоимостьУпр
	|				+ СебестоимостьТоваровЗаписи.СтоимостьЗабалансовая
	|				+ СебестоимостьТоваровЗаписи.ТрудозатратыУпр
	|				+ СебестоимостьТоваровЗаписи.ПостатейныеПостоянныеУпр
	|				+ СебестоимостьТоваровЗаписи.ПостатейныеПеременныеУпр
	|			КОНЕЦ	
	|	КОНЕЦ КАК Док_СебестоимостьПриход,
	|	ВЫБОР
	|		КОГДА СебестоимостьТоваровЗаписи.ВидДвижения = ЗНАЧЕНИЕ(ВидДвиженияНакопления.Расход) 
	|		ТОГДА 1
	|		ИНАЧЕ 0 
	|	КОНЕЦ *
	|	ВЫБОР 
	|		КОГДА &ДанныеОтчета = 1 
	|			ТОГДА СебестоимостьТоваровЗаписи.Стоимость
	|				+ СебестоимостьТоваровЗаписи.ДопРасходы 
	|				+ СебестоимостьТоваровЗаписи.СтоимостьЗабалансовая
	|				+ СебестоимостьТоваровЗаписи.Трудозатраты
	|				+ СебестоимостьТоваровЗаписи.ПостатейныеПостоянныеСНДС
	|				+ СебестоимостьТоваровЗаписи.ПостатейныеПеременныеСНДС
	|		КОГДА &ДанныеОтчета = 2 
	|			ТОГДА СебестоимостьТоваровЗаписи.СтоимостьБезНДС
	|				+ СебестоимостьТоваровЗаписи.ДопРасходыБезНДС 
	|				+ СебестоимостьТоваровЗаписи.СтоимостьЗабалансовая
	|				+ СебестоимостьТоваровЗаписи.Трудозатраты
	|				+ СебестоимостьТоваровЗаписи.ПостатейныеПостоянныеБезНДС
	|				+ СебестоимостьТоваровЗаписи.ПостатейныеПеременныеБезНДС
	|		КОГДА &ДанныеОтчета = 3
	|			ТОГДА СебестоимостьТоваровЗаписи.СтоимостьУпр
	|				+ СебестоимостьТоваровЗаписи.ДопРасходыУпр
	|				+ СебестоимостьТоваровЗаписи.СтоимостьЗабалансовая
	|				+ СебестоимостьТоваровЗаписи.ТрудозатратыУпр
	|				+ СебестоимостьТоваровЗаписи.ПостатейныеПостоянныеУпр
	|				+ СебестоимостьТоваровЗаписи.ПостатейныеПеременныеУпр
	|		КОГДА &ДанныеОтчета = 4 
	|			ТОГДА СебестоимостьТоваровЗаписи.СтоимостьРегл
	|				+ СебестоимостьТоваровЗаписи.ДопРасходыРегл
	|				+ СебестоимостьТоваровЗаписи.СтоимостьЗабалансоваяРегл
	|				+ СебестоимостьТоваровЗаписи.ТрудозатратыРегл
	|				+ СебестоимостьТоваровЗаписи.ПостатейныеПостоянныеРегл
	|				+ СебестоимостьТоваровЗаписи.ПостатейныеПеременныеРегл
	|		ИНАЧЕ
	|			ВЫБОР КОГДА &ПоПредприятию ТОГДА
	|				СебестоимостьТоваровЗаписи.СтоимостьБезНДС
	|				+ СебестоимостьТоваровЗаписи.СтоимостьЗабалансовая
	|				+ СебестоимостьТоваровЗаписи.Трудозатраты
	|				+ СебестоимостьТоваровЗаписи.ПостатейныеПостоянныеБезНДС
	|				+ СебестоимостьТоваровЗаписи.ПостатейныеПеременныеБезНДС
	|			ИНАЧЕ
	|				СебестоимостьТоваровЗаписи.СтоимостьУпр
	|				+ СебестоимостьТоваровЗаписи.ДопРасходыУпр
	|				+ СебестоимостьТоваровЗаписи.СтоимостьЗабалансовая
	|				+ СебестоимостьТоваровЗаписи.ТрудозатратыУпр
	|				+ СебестоимостьТоваровЗаписи.ПостатейныеПостоянныеУпр
	|				+ СебестоимостьТоваровЗаписи.ПостатейныеПеременныеУпр
	|			КОНЕЦ	
	|	КОНЕЦ КАК Док_СебестоимостьРасход,
	|	0 КАК Док_СебестоимостьКонечныйОстаток,
	|
	|	// Показатель ""Налоговый учет""
	|	0 КАК Док_НалоговыйУчетНачальныйОстаток,
	|	ВЫБОР
	|		КОГДА СебестоимостьТоваровЗаписи.ВидДвижения = ЗНАЧЕНИЕ(ВидДвиженияНакопления.Приход) 
	|		ТОГДА 1
	|		ИНАЧЕ 0 
	|	КОНЕЦ *
	|	ВЫБОР 
	|		КОГДА &ДанныеОтчета = 1 ИЛИ &ДанныеОтчета = 2 ИЛИ &ДанныеОтчета = 3
	|			ТОГДА 0
	|		КОГДА &ДанныеОтчета = 4 
	|			ТОГДА СебестоимостьТоваровЗаписи.СтоимостьРегл
	|				+ СебестоимостьТоваровЗаписи.ДопРасходыРегл
	|				+ СебестоимостьТоваровЗаписи.СтоимостьЗабалансоваяРегл
	|				+ СебестоимостьТоваровЗаписи.ТрудозатратыРегл
	|				+ СебестоимостьТоваровЗаписи.ПостатейныеПостоянныеРегл
	|				+ СебестоимостьТоваровЗаписи.ПостатейныеПеременныеРегл
	|				- СебестоимостьТоваровЗаписи.ПостояннаяРазница
	|				- СебестоимостьТоваровЗаписи.ВременнаяРазница
	|		ИНАЧЕ
	|			0
	|	КОНЕЦ КАК Док_НалоговыйУчетПриход,
	|	ВЫБОР
	|		КОГДА СебестоимостьТоваровЗаписи.ВидДвижения = ЗНАЧЕНИЕ(ВидДвиженияНакопления.Расход) 
	|		ТОГДА 1
	|		ИНАЧЕ 0 
	|	КОНЕЦ *
	|	ВЫБОР 
	|		КОГДА &ДанныеОтчета = 1 ИЛИ &ДанныеОтчета = 2 ИЛИ &ДанныеОтчета = 3
	|			ТОГДА 0
	|		КОГДА &ДанныеОтчета = 4 
	|			ТОГДА СебестоимостьТоваровЗаписи.СтоимостьРегл
	|				+ СебестоимостьТоваровЗаписи.ДопРасходыРегл
	|				+ СебестоимостьТоваровЗаписи.СтоимостьЗабалансоваяРегл
	|				+ СебестоимостьТоваровЗаписи.ТрудозатратыРегл
	|				+ СебестоимостьТоваровЗаписи.ПостатейныеПостоянныеРегл
	|				+ СебестоимостьТоваровЗаписи.ПостатейныеПеременныеРегл
	|				- СебестоимостьТоваровЗаписи.ПостояннаяРазница
	|				- СебестоимостьТоваровЗаписи.ВременнаяРазница
	|		ИНАЧЕ
	|			0
	|	КОНЕЦ КАК Док_НалоговыйУчетРасход,
	|	0 КАК Док_НалоговыйУчетКонечныйОстаток,
	|
	|	// Показатель ""Постоянная разница""
	|	0 КАК Док_ПостояннаяРазницаНачальныйОстаток,
	|	ВЫБОР
	|		КОГДА СебестоимостьТоваровЗаписи.ВидДвижения = ЗНАЧЕНИЕ(ВидДвиженияНакопления.Приход) 
	|		ТОГДА 1
	|		ИНАЧЕ 0 
	|	КОНЕЦ *
	|	ВЫБОР 
	|		КОГДА &ДанныеОтчета = 1 ИЛИ &ДанныеОтчета = 2 ИЛИ &ДанныеОтчета = 3
	|			ТОГДА 0
	|		КОГДА &ДанныеОтчета = 4 
	|			ТОГДА СебестоимостьТоваровЗаписи.ПостояннаяРазница
	|		ИНАЧЕ 
	|			0
	|	КОНЕЦ КАК Док_ПостояннаяРазницаПриход,
	|	ВЫБОР
	|		КОГДА СебестоимостьТоваровЗаписи.ВидДвижения = ЗНАЧЕНИЕ(ВидДвиженияНакопления.Расход) 
	|		ТОГДА 1
	|		ИНАЧЕ 0 
	|	КОНЕЦ *
	|	ВЫБОР 
	|		КОГДА &ДанныеОтчета = 1 ИЛИ &ДанныеОтчета = 2 ИЛИ &ДанныеОтчета = 3
	|			ТОГДА 0
	|		КОГДА &ДанныеОтчета = 4 
	|			ТОГДА СебестоимостьТоваровЗаписи.ПостояннаяРазница
	|		ИНАЧЕ 
	|			0
	|	КОНЕЦ КАК Док_ПостояннаяРазницаРасход,
	|	0 КАК Док_ПостояннаяРазницаКонечныйОстаток,
	|
	|	// Показатель ""Временная разница""
	|	0 КАК Док_ВременнаяРазницаНачальныйОстаток,
	|	ВЫБОР
	|		КОГДА СебестоимостьТоваровЗаписи.ВидДвижения = ЗНАЧЕНИЕ(ВидДвиженияНакопления.Приход) 
	|		ТОГДА 1
	|		ИНАЧЕ 0 
	|	КОНЕЦ *
	|	ВЫБОР 
	|		КОГДА &ДанныеОтчета = 1 ИЛИ &ДанныеОтчета = 2 ИЛИ &ДанныеОтчета = 3
	|			ТОГДА 0
	|		КОГДА &ДанныеОтчета = 4 
	|			ТОГДА СебестоимостьТоваровЗаписи.ВременнаяРазница
	|		ИНАЧЕ 
	|			0
	|	КОНЕЦ КАК Док_ВременнаяРазницаПриход,
	|	ВЫБОР
	|		КОГДА СебестоимостьТоваровЗаписи.ВидДвижения = ЗНАЧЕНИЕ(ВидДвиженияНакопления.Расход) 
	|		ТОГДА 1
	|		ИНАЧЕ 0 
	|	КОНЕЦ *
	|	ВЫБОР 
	|		КОГДА &ДанныеОтчета = 1 ИЛИ &ДанныеОтчета = 2 ИЛИ &ДанныеОтчета = 3
	|			ТОГДА 0
	|		КОГДА &ДанныеОтчета = 4 
	|			ТОГДА СебестоимостьТоваровЗаписи.ВременнаяРазница
	|		ИНАЧЕ 
	|			0
	|	КОНЕЦ КАК Док_ВременнаяРазницаРасход,
	|	0 КАК Док_ВременнаяРазницаКонечныйОстаток
	|	
	|{ВЫБРАТЬ
	|	ПериодДень,
	|	ПериодНеделя,
	|	ПериодДекада,
	|	ПериодМесяц,
	|	ПериодКвартал,
	|	ПериодПолугодие,
	|	ПериодГод,
	|	АналитикаУчетаНоменклатуры.*,
	|	Номенклатура.*,
	|	ЕдиницаХранения.*,
	|	ЕдиницаДляОтчетов.*,
	|	Характеристика.*,
	|	Серия.*,
	|	Склад.*,
	|	Назначение.*,
	|	НаправлениеДеятельности.*,
	|	ВидЗапасов.*,
	|	Партнер,
	|	Менеджер.*,
	|	Подразделение.*,
	|	Сделка.*,
	|	ГруппаФинансовогоУчета.*,
	|	Организация.*,
	|	СтатьяДоходов.*,
	|	СтатьяРасходов.*,
	|	СтатьяДоходовРасходов.*,
	|	АналитикаДоходов.*,
	|	АналитикаРасходов.*,
	|	АналитикаДоходовРасходов.*,
	|	Договор,
	|	Заказ,
	|	Контрагент,
	|	Соглашение,
	|	ТипЗапасов,
	|	ХозяйственнаяОперацияСправочник.*,
	|	ХозяйственнаяОперацияПрихода,
	|	ХозяйственнаяОперацияРасхода,
	|	Документ.*,
	|	Док_КоличествоНачальныйОстаток,
	|	Док_КоличествоПриход,
	|	Док_КоличествоРасход,
	|	Док_КоличествоКонечныйОстаток,
	|	Док_ВесНачальныйОстаток,
	|	Док_ВесПриход,
	|	Док_ВесРасход,
	|	Док_ВесКонечныйОстаток,
	|	Док_ОбъемНачальныйОстаток,
	|	Док_ОбъемПриход,
	|	Док_ОбъемРасход,
	|	Док_ОбъемКонечныйОстаток,
	|	Док_СтоимостьПоступленияНачальныйОстаток,
	|	Док_СтоимостьПоступленияПриход,
	|	Док_СтоимостьПоступленияРасход,
	|	Док_СтоимостьПоступленияКонечныйОстаток,
	|	Док_ДопРасходыНачальныйОстаток,
	|	Док_ДопРасходыПриход,
	|	Док_ДопРасходыРасход,
	|	Док_ДопРасходыКонечныйОстаток,
	|	Док_ТрудозатратыНачальныйОстаток,
	|	Док_ТрудозатратыПриход,
	|	Док_ТрудозатратыРасход,
	|	Док_ТрудозатратыКонечныйОстаток,
	|	Док_ПостатейныеПостоянныеНачальныйОстаток,
	|	Док_ПостатейныеПостоянныеПриход,
	|	Док_ПостатейныеПостоянныеРасход,
	|	Док_ПостатейныеПостоянныеКонечныйОстаток,
	|	Док_ПостатейныеПеременныеНачальныйОстаток,
	|	Док_ПостатейныеПеременныеПриход,
	|	Док_ПостатейныеПеременныеРасход,
	|	Док_ПостатейныеПеременныеКонечныйОстаток,
	|	Док_СебестоимостьНачальныйОстаток,
	|	Док_СебестоимостьПриход,
	|	Док_СебестоимостьРасход,
	|	Док_СебестоимостьКонечныйОстаток,
	|	Док_НалоговыйУчетНачальныйОстаток,
	|	Док_НалоговыйУчетПриход,
	|	Док_НалоговыйУчетРасход,
	|	Док_НалоговыйУчетКонечныйОстаток,
	|	Док_ПостояннаяРазницаНачальныйОстаток,
	|	Док_ПостояннаяРазницаПриход,
	|	Док_ПостояннаяРазницаРасход,
	|	Док_ПостояннаяРазницаКонечныйОстаток,
	|	Док_ВременнаяРазницаНачальныйОстаток,
	|	Док_ВременнаяРазницаПриход,
	|	Док_ВременнаяРазницаРасход,
	|	Док_ВременнаяРазницаКонечныйОстаток
	|	}
	|ИЗ
	|	РегистрНакопления.СебестоимостьТоваров КАК СебестоимостьТоваровЗаписи
	|
	|	{ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.АналитикаУчетаНоменклатуры КАК АналитикаНоменклатуры
	|		ПО СебестоимостьТоваровЗаписи.АналитикаУчетаНоменклатуры = АналитикаНоменклатуры.КлючАналитики
	|	}
	|
	|	{ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.АналитикаУчетаПоПартнерам КАК АналитикаПартнеров
	|		ПО СебестоимостьТоваровЗаписи.АналитикаУчетаПоПартнерам = АналитикаПартнеров.КлючАналитики
	|	}
	|
	|	{ЛЕВОЕ СОЕДИНЕНИЕ Справочник.КлючиАналитикиУчетаПартий КАК АналитикаПартий
	|		ПО АналитикаПартий.Ссылка = СебестоимостьТоваровЗаписи.АналитикаУчетаПартий
	|	}
	|
	|	ЛЕВОЕ СОЕДИНЕНИЕ Справочник.НастройкиХозяйственныхОпераций КАК НастройкиХозопераций
	|		ПО НастройкиХозопераций.ХозяйственнаяОперация = СебестоимостьТоваровЗаписи.ХозяйственнаяОперация
	|
	|{ГДЕ
	|	СебестоимостьТоваровЗаписи.Период >= &НачалоПериода
	|		И СебестоимостьТоваровЗаписи.Период <= &КонецПериода,
	|	((АналитикаНоменклатуры.Номенклатура, АналитикаНоменклатуры.Характеристика) В
	|			(ВЫБРАТЬ
	|				ОтборПоСегментуНоменклатуры.Номенклатура,
	|				ОтборПоСегментуНоменклатуры.Характеристика
	|			ИЗ
	|				ОтборПоСегментуНоменклатуры
	|			ГДЕ
	|				ОтборПоСегментуНоменклатуры.ИспользуетсяОтборПоСегментуНоменклатуры = &ИспользуетсяОтборПоСегментуНоменклатуры)),
	|	(НастройкиХозопераций.Ссылка) КАК ХозяйственнаяОперацияСправочник,
	|	ВЫБОР 
	|		КОГДА (СебестоимостьТоваровЗаписи.Регистратор Ссылка Документ.РасчетСебестоимостиТоваров ИЛИ СебестоимостьТоваровЗаписи.РасчетСебестоимости)
	|			И НЕ СебестоимостьТоваровЗаписи.ХозяйственнаяОперация.Ссылка ЕСТЬ NULL
	|			ТОГДА СебестоимостьТоваровЗаписи.ДокументДвижения
	|			ИНАЧЕ СебестоимостьТоваровЗаписи.Регистратор
	|	КОНЕЦ КАК Документ,
	|	НАЧАЛОПЕРИОДА(СебестоимостьТоваровЗаписи.Период, ДЕНЬ)      КАК ПериодДень,
	|	НАЧАЛОПЕРИОДА(СебестоимостьТоваровЗаписи.Период, НЕДЕЛЯ)    КАК ПериодНеделя,
	|	НАЧАЛОПЕРИОДА(СебестоимостьТоваровЗаписи.Период, ДЕКАДА)    КАК ПериодДекада,
	|	НАЧАЛОПЕРИОДА(СебестоимостьТоваровЗаписи.Период, МЕСЯЦ)     КАК ПериодМесяц,
	|	НАЧАЛОПЕРИОДА(СебестоимостьТоваровЗаписи.Период, КВАРТАЛ)   КАК ПериодКвартал,
	|	НАЧАЛОПЕРИОДА(СебестоимостьТоваровЗаписи.Период, ПОЛУГОДИЕ) КАК ПериодПолугодие,
	|	НАЧАЛОПЕРИОДА(СебестоимостьТоваровЗаписи.Период, ГОД)       КАК ПериодГод,
	|	СебестоимостьТоваровЗаписи.АналитикаУчетаНоменклатуры.*,
	|	АналитикаНоменклатуры.Номенклатура.*,
	|	АналитикаНоменклатуры.Номенклатура.ЕдиницаИзмерения.* КАК ЕдиницаИзмерения,
	|	АналитикаНоменклатуры.Номенклатура.ЕдиницаДляОтчетов.* КАК ЕдиницаДляОтчетов,
	|	АналитикаНоменклатуры.Характеристика.*,
	|	АналитикаНоменклатуры.Серия.*,
	|	АналитикаНоменклатуры.Склад.*,
	|	АналитикаНоменклатуры.Назначение.*,
	|	АналитикаНоменклатуры.Назначение.НаправлениеДеятельности.* КАК НаправлениеДеятельности,
	|	СебестоимостьТоваровЗаписи.ВидЗапасов.*,
	|	(ЕСТЬNULL(ВЫРАЗИТЬ(СебестоимостьТоваровЗаписи.АналитикаФинансовогоУчета КАК Справочник.Пользователи), НЕОПРЕДЕЛЕНО)).* КАК Менеджер,
	|	(ЕСТЬNULL(ВЫРАЗИТЬ(СебестоимостьТоваровЗаписи.АналитикаФинансовогоУчета КАК Справочник.СтруктураПредприятия), НЕОПРЕДЕЛЕНО)).* КАК Подразделение,
	|	(ЕСТЬNULL(ВЫРАЗИТЬ(СебестоимостьТоваровЗаписи.АналитикаФинансовогоУчета КАК Справочник.СделкиСКлиентами), НЕОПРЕДЕЛЕНО)).* КАК Сделка,
	|	(ВЫБОР
	|			КОГДА &ФормироватьВидыЗапасовПоГруппамФинансовогоУчета
	|				ТОГДА СебестоимостьТоваровЗаписи.ВидЗапасов.ГруппаФинансовогоУчета
	|			ИНАЧЕ АналитикаНоменклатуры.Номенклатура.ГруппаФинансовогоУчета
	|		КОНЕЦ).* КАК ГруппаФинансовогоУчета,
	|	СебестоимостьТоваровЗаписи.Организация.*,
	|	СебестоимостьТоваровЗаписи.СтатьяДоходов.* КАК СтатьяДоходов,
	|	СебестоимостьТоваровЗаписи.СтатьяРасходовСписания.* КАК СтатьяРасходов,
	|	(ВЫБОР
	|		КОГДА НЕ СебестоимостьТоваровЗаписи.СтатьяДоходов.Ссылка ЕСТЬ NULL
	|			ТОГДА СебестоимостьТоваровЗаписи.СтатьяДоходов
	|		КОГДА НЕ СебестоимостьТоваровЗаписи.СтатьяРасходовСписания.Ссылка ЕСТЬ NULL
	|			ТОГДА СебестоимостьТоваровЗаписи.СтатьяРасходовСписания
	|	КОНЕЦ).*                          КАК СтатьяДоходовРасходов,
	|	СебестоимостьТоваровЗаписи.АналитикаДоходов.* КАК АналитикаДоходов,
	|	СебестоимостьТоваровЗаписи.АналитикаРасходов.* КАК АналитикаРасходов,
	|	(ВЫБОР
	|		КОГДА НЕ ТИПЗНАЧЕНИЯ(СебестоимостьТоваровЗаписи.АналитикаДоходов) ЕСТЬ NULL
	|			ТОГДА СебестоимостьТоваровЗаписи.АналитикаДоходов
	|		КОГДА НЕ ТИПЗНАЧЕНИЯ(СебестоимостьТоваровЗаписи.АналитикаРасходов) ЕСТЬ NULL
	|			ТОГДА СебестоимостьТоваровЗаписи.АналитикаРасходов
	|	КОНЕЦ).*                          КАК АналитикаДоходовРасходов,
	|	(СебестоимостьТоваровЗаписи.ЗаказКлиента).* КАК Заказ,
	|	(&ТекстЗапросаПолученияОборотнойАналитикиПартнер).* КАК Партнер,
	|	(&ТекстЗапросаПолученияОборотнойАналитикиДоговор).* КАК Договор,
	|	(&ТекстЗапросаПолученияОборотнойАналитикиКонтрагент).* КАК Контрагент,
	|	(&ТекстЗапросаПолученияОборотнойАналитикиСоглашение).* КАК Соглашение}) КАК Записи";
	
	ТекстЗапроса = СтрЗаменить(
		ТекстЗапроса, 
		"&ТекстЗапросаВесУпаковки", 
		Справочники.УпаковкиЕдиницыИзмерения.ТекстЗапросаВесУпаковки("АналитикаНоменклатуры.Номенклатура.ЕдиницаИзмерения", "АналитикаНоменклатуры.Номенклатура"));
		
	ТекстЗапроса = СтрЗаменить(
		ТекстЗапроса, 
		"&ТекстЗапросаОбъемУпаковки", 
		Справочники.УпаковкиЕдиницыИзмерения.ТекстЗапросаОбъемУпаковки("АналитикаНоменклатуры.Номенклатура.ЕдиницаИзмерения", "АналитикаНоменклатуры.Номенклатура"));	
	
	Возврат ТекстЗапроса;
КонецФункции

#КонецОбласти 

Функция ИсполняемыйЗапросОсновнаяАналитика()
	ТекстЗапроса = ТекстЗапросаОтборыПоСегментам(); 
	
	КоличествоПодключенныхЗапросов = 0;
	
	ПодключитьЗапрос(ТекстЗапроса, ТекстЗапросаСебестоимостьТоваровОстаткиИОбороты(), КоличествоПодключенныхЗапросов);
	
	Возврат ТекстЗапроса;
КонецФункции

Функция ИсполняемыйЗапросОборотнаяАналитика()
	ТекстЗапроса = ТекстЗапросаОтборыПоСегментам() 
		+ ТекстЗапросаЗарегистрированныеВводыОстатков();
	
	КоличествоПодключенныхЗапросов = 0;
	
	ПодключитьЗапрос(ТекстЗапроса, ТекстЗапросаЗакупкиОбороты(), КоличествоПодключенныхЗапросов);
	ПодключитьЗапрос(ТекстЗапроса, ТекстЗапросаВыручкаИСебестоимостьПродажОбороты(), КоличествоПодключенныхЗапросов);
	ПодключитьЗапрос(ТекстЗапроса, ТекстЗапросаДвиженияНоменклатураНоменклатураОборотыПриход(), КоличествоПодключенныхЗапросов);
	ПодключитьЗапрос(ТекстЗапроса, ТекстЗапросаДвиженияНоменклатураНоменклатураОборотыРасход(), КоличествоПодключенныхЗапросов);
	ПодключитьЗапрос(ТекстЗапроса, ТекстЗапросаДвиженияНоменклатураДоходыРасходыОбороты(), КоличествоПодключенныхЗапросов);
	ПодключитьЗапрос(ТекстЗапроса, ТекстЗапросаДополнениеВводОстатков(), КоличествоПодключенныхЗапросов);
	
	ТекстЗапроса = ТекстЗапроса + Символы.ПС + ";" + Символы.ПС;
	
	КоличествоПодключенныхЗапросов = 0;
	
	ПодключитьЗапрос(ТекстЗапроса, ТекстЗапросаКлассифицированныеОбороты(), КоличествоПодключенныхЗапросов);
	ПодключитьЗапрос(ТекстЗапроса, ТекстЗапросаНеклассифицированныеОбороты(), КоличествоПодключенныхЗапросов);
	
	Возврат ТекстЗапроса;
КонецФункции

Функция ИсполняемыйЗапросДокументы()
	ТекстЗапроса = ТекстЗапросаОтборыПоСегментам() 
		+ ТекстЗапросаЗарегистрированныеВводыОстатков();
	
	КоличествоПодключенныхЗапросов = 0;
	
	ТекстЗапросаЗаписей = ТекстЗапросаСебестоимостьТоваровОборотыПоЗаписям();
	ПоляЗамены = Новый Массив;
	ПоляЗамены.Добавить("Партнер");
	ПоляЗамены.Добавить("Контрагент");
	ПоляЗамены.Добавить("Договор");
	ПоляЗамены.Добавить("Соглашение");
	
	Для Каждого ПолеЗамены Из ПоляЗамены Цикл 
		ТекстЗапросаЗаписей = СтрЗаменить(
			ТекстЗапросаЗаписей, 
			"&ТекстЗапросаПолученияОборотнойАналитики" + ПолеЗамены, 
			ТекстЗапросаПолученияОборотнойАналитики("СебестоимостьТоваровЗаписи", ПолеЗамены));
	КонецЦикла;
		
	ПодключитьЗапрос(ТекстЗапроса, ТекстЗапросаЗаписей, КоличествоПодключенныхЗапросов);
	
	Возврат ТекстЗапроса;
КонецФункции

Функция ТекстЗапросаПолученияОборотнойАналитики(ИмяРегистра, ПолеЗамены)
	МетаданныеРегистра = Метаданные.РегистрыНакопления.СебестоимостьТоваров;
	ТипыДокументаДвижения = МетаданныеРегистра.Реквизиты.ДокументДвижения.Тип.Типы();
	ТипыРегистраторов = МетаданныеРегистра.СтандартныеРеквизиты.Регистратор.Тип.Типы();
	
	ЧастиЗапроса = Новый Массив;
	ЧастиЗапроса.Добавить("ВЫБОР");
	ЧастиЗапроса.Добавить("КОГДА (" + ИмяРегистра + ".Регистратор ССЫЛКА Документ.РасчетСебестоимостиТоваров 
		|ИЛИ " + ИмяРегистра + ".РасчетСебестоимости) 
		|И НЕ " + ИмяРегистра + ".ХозяйственнаяОперация.Ссылка ЕСТЬ NULL");
	ЧастиЗапроса.Добавить("ТОГДА");
	
	ДобавитьЧастиЗапроса(ЧастиЗапроса, ИмяРегистра, "ДокументДвижения", ПолеЗамены, ТипыДокументаДвижения);
	
	ЧастиЗапроса.Добавить("ИНАЧЕ");
	
	ДобавитьЧастиЗапроса(ЧастиЗапроса, ИмяРегистра, "Регистратор", ПолеЗамены, ТипыРегистраторов);
	
	ЧастиЗапроса.Добавить("КОНЕЦ");
	
	Возврат СтрСоединить(ЧастиЗапроса, Символы.ПС);
КонецФункции

Процедура ДобавитьЧастиЗапроса(ЧастиЗапроса, ИмяРегистра, ИмяПоляИсточника, ПолеЗамены, ТипыПолей)
	ЧастиЗапроса.Добавить("ВЫБОР");
	Для Каждого ТипПоля Из ТипыПолей Цикл 
		МетаданныеДокумента = Метаданные.НайтиПоТипу(ТипПоля);
		Если ПравоДоступа("Чтение", МетаданныеДокумента) 
			И Не МетаданныеДокумента.Реквизиты.Найти(ПолеЗамены) = Неопределено Тогда
			
			ИмяДокумента = МетаданныеДокумента.Имя;
			ЧастиЗапроса.Добавить("КОГДА " + ИмяРегистра + "." + ИмяПоляИсточника + " ССЫЛКА Документ." + ИмяДокумента);
			ЧастиЗапроса.Добавить("ТОГДА ВЫРАЗИТЬ(" + ИмяРегистра + "." + ИмяПоляИсточника + " КАК Документ." + ИмяДокумента + ")." + ПолеЗамены);
			
		КонецЕсли;
	КонецЦикла;
	ЧастиЗапроса.Добавить("ИНАЧЕ NULL КОНЕЦ");
КонецПроцедуры

Процедура ПодключитьЗапрос(ДинамическийТекстЗапроса, ПодключаемыйЗапрос, КоличествоПодключенныхЗапросов)
	Если Не ПустаяСтрока(ПодключаемыйЗапрос) Тогда
		Если КоличествоПодключенныхЗапросов = 0 Тогда
			ДинамическийТекстЗапроса = ДинамическийТекстЗапроса + ПодключаемыйЗапрос;
		Иначе
			ПодключаемыйЗапрос = СтрЗаменить(ПодключаемыйЗапрос, "РАЗРЕШЕННЫЕ", "");
			
			ДинамическийТекстЗапроса = ДинамическийТекстЗапроса + Символы.ПС + Символы.ПС 
			+ "ОБЪЕДИНИТЬ ВСЕ" + Символы.ПС + Символы.ПС;
			
			ДинамическийТекстЗапроса = ДинамическийТекстЗапроса + ПодключаемыйЗапрос;
		КонецЕсли;
		
		КоличествоПодключенныхЗапросов = КоличествоПодключенныхЗапросов + 1;
	КонецЕсли;
КонецПроцедуры

#КонецОбласти 

#КонецЕсли
