
&НаКлиенте
Процедура МегаЛогист_Максоптра_АвтоматическоеПланированиеПриИзменении(Элемент)
	
	ИзменитьВидимость();
	
КонецПроцедуры

&НаКлиенте
Процедура ИзменитьВидимость()

	Элементы.ГруппаОтображения.Доступность = НаборКонстант.МегаЛогист_Максоптра_АвтоматическоеПланирование;

КонецПроцедуры


&НаКлиенте
Процедура ПриОткрытии(Отказ)
	
	ИзменитьВидимость();
	
КонецПроцедуры


&НаКлиенте
Процедура ПередЗаписью(Отказ, ПараметрыЗаписи)
	
	//Проверка заполнения
	Если НаборКонстант.МегаЛогист_Максоптра_АвтоматическоеПланирование Тогда
	
		Если Не ЗначениеЗаполнено(НаборКонстант.МегаЛогист_Максоптра_URLСервиса) Тогда
	
			СообщениеПользователю = Новый СообщениеПользователю;
			СообщениеПользователю.Поле = "МегаЛогист_Максоптра_URLАккаунта";
			СообщениеПользователю.Текст = "Не заполнен: URL сервиса";
			//СообщениеПользователю.УстановитьДанные(НаборКонстант);
			СообщениеПользователю.Сообщить();
			Отказ = Истина;
	
		КонецЕсли;
		
		Если Не ЗначениеЗаполнено(НаборКонстант.МегаЛогист_Максоптра_ПортСервиса) Тогда
	
			СообщениеПользователю = Новый СообщениеПользователю;
			СообщениеПользователю.Поле = "Элементы.МегаЛогист_Максоптра_ПортСервиса";
			СообщениеПользователю.Текст = "Не заполнен: Порт сервиса";
			//СообщениеПользователю.УстановитьДанные(НаборКонстант.МегаЛогист_Максоптра_ПортСервиса);
			СообщениеПользователю.ПутьКДанным = "НаборКонстант.МегаЛогист_Максоптра_ПортСервиса";
			СообщениеПользователю.Сообщить();
			Отказ = Истина;
	
		КонецЕсли;
		
	//	Если Не ЗначениеЗаполнено(НаборКонстант.МегаЛогист_Максоптра_URLСервиса) Тогда
	//
	//		СообщениеПользователю = Новый СообщениеПользователю;
	//		СообщениеПользователю.Поле = "МегаЛогист_Максоптра_URLАккаунта";
	//		СообщениеПользователю.Текст = "Не заполнен: URL аккаунта";
	//		СообщениеПользователю.Сообщить();
	//		Отказ = Истина;
	//
	//	КонецЕсли;
		
		Если Не ЗначениеЗаполнено(НаборКонстант.МегаЛогист_Максоптра_ИмяПользователя) Тогда
	
			СообщениеПользователю = Новый СообщениеПользователю;
			СообщениеПользователю.Поле = "МегаЛогист_Максоптра_ИмяПользователя";
			СообщениеПользователю.Текст = "Не заполнено: Имя пользователя";
			СообщениеПользователю.Сообщить();
			Отказ = Истина;
	
		КонецЕсли;
		
		Если Не ЗначениеЗаполнено(НаборКонстант.МегаЛогист_Максоптра_Пароль) Тогда
	
			СообщениеПользователю = Новый СообщениеПользователю;
			СообщениеПользователю.Поле = "МегаЛогист_Максоптра_Пароль";
			СообщениеПользователю.Текст = "Не заполнен: Пароль пользователя";
			СообщениеПользователю.Сообщить();
			Отказ = Истина;
	
		КонецЕсли;

	КонецЕсли;
	
КонецПроцедуры


&НаСервере
Процедура ПриСозданииНаСервере(Отказ, СтандартнаяОбработка)
	Если Не ЗначениеЗаполнено(НаборКонстант.МегаЛогист_Максоптра_ПортСервиса) Тогда
	
		НаборКонстант.МегаЛогист_Максоптра_ПортСервиса = 80;
	
	КонецЕсли;
КонецПроцедуры


&НаСервере
Процедура ПроверитьПодключениеНаСервере()
	Если МегаЛогист_РаботаСМакоптра.Авторазация() <> Неопределено Тогда
		Сообщить("Соединение с сервисом Maxoptra успешно установлено!");
	КонецЕсли;
КонецПроцедуры


&НаКлиенте
Процедура ПроверитьПодключение(Команда)
	Записать();
	ПроверитьПодключениеНаСервере();
КонецПроцедуры

