&НаКлиенте
Процедура ПутьКФайлуНачалоВыбора(Элемент, ДанныеВыбора, СтандартнаяОбработка)
	
	СтандартнаяОбработка = Ложь;
	НачатьПомещениеФайлов(Новый ОписаниеОповещения("ВыбранПутьКФайлу", ЭтаФорма, Элемент.Имя),,ПолучитьДиалог(), Истина, УникальныйИдентификатор);
	
КонецПроцедуры
&НаКлиенте
Функция ПолучитьДиалог()
	
	ДВ = Новый ДиалогВыбораФайла(РежимДиалогаВыбораФайла.Открытие);
	ДВ.Фильтр = "Эксель (*.xls)|*.xls*";
	
	Возврат ДВ;
	
КонецФункции
&НаКлиенте
Процедура ВыбранПутьКФайлу(ПомещенныеФайлы, ИмяРеквизита) Экспорт
	
	Если ПомещенныеФайлы = Неопределено Тогда 
		Текст = "ru = ""Файл не выбран!""; en = ""File not selected!""";
		ПоказатьПредупреждение(,НСтр(Текст));
        Возврат; 
	КонецЕсли;

	АдресФайла = ПомещенныеФайлы[0].Хранение;    //Адрес
	ПутьКФайлу = ПомещенныеФайлы[0].Имя;	
		
КонецПроцедуры

&НаКлиенте
Процедура ВыполнитьЗагрузку(Команда)
	
	Если ПустаяСтрока(ПутьКФайлу) Тогда
		Текст = "ru = ""Файл не выбран!""; en = ""File not selected!""";
		ПоказатьПредупреждение(,НСтр(Текст));
        Возврат;
	КонецЕсли;
	
	Закрыть(Новый Структура("ПутьКФайлу, ЗаменятьНайденные, КолонкаНачало, СтрокаНачало", ПутьКФайлу, ЗаменятьНайденные, КолонкаНачало, СтрокаНачало));
	
КонецПроцедуры


&НаКлиенте
Процедура ПриОткрытии(Отказ)
	
	КолонкаНачало = 1;
	СтрокаНачало = 2;

КонецПроцедуры
