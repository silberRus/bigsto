
&НаСервере
Процедура ЗагрузитьНаСервере()
	
	Строка = 2;
	Пока Истина Цикл
		
		Если Не ЗначениеЗаполнено(ТабличныйДокумент.Область("R" + Формат(Строка, "ЧГ=0") +"C1").Текст) Тогда
			Прервать;
		КонецЕсли;
		ОбработкаЛогиста = Обработки.МегаЛогист_РабочееМестоЛогиста.Создать();
		Адрес = ОбработкаЛогиста.ПривестиАдресДляПоиска(ТабличныйДокумент.Область("R" + Формат(Строка, "ЧГ=0") +"C1").Текст);
		МенеджерЗаписи = РегистрыСведений.МегаЛогист_СохраненныеАдреса.СоздатьМенеджерЗаписи();
		МенеджерЗаписи.ПредставлениеАдреса = Адрес;
		МенеджерЗаписи.Прочитать();
		МенеджерЗаписи.ПредставлениеАдреса 	= Адрес;
		МенеджерЗаписи.Широта				= ТабличныйДокумент.Область("R" + Формат(Строка, "ЧГ=0") +"C2").Текст;
		МенеджерЗаписи.Долгота				= ТабличныйДокумент.Область("R" + Формат(Строка, "ЧГ=0") +"C3").Текст;
		МенеджерЗаписи.Записать();
	    Строка = Строка + 1;
	КонецЦикла;
	
КонецПроцедуры

&НаКлиенте
Процедура Загрузить(Команда)
	ЗагрузитьНаСервере();
КонецПроцедуры

&НаСервере
Процедура ПриСозданииНаСервере(Отказ, СтандартнаяОбработка)
	
	Макет = РегистрыСведений.МегаЛогист_СохраненныеАдреса.ПолучитьМакет("МакетЗагрузки");
	Макет.ОтображатьСетку = Истина;
	ТабличныйДокумент.Вывести(Макет);
	ТабличныйДокумент.ОтображатьСетку 	= Истина;
	ТабличныйДокумент.Защита 			= Ложь;
	
КонецПроцедуры
