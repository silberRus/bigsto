#Если Сервер Или ТолстыйКлиентОбычноеПриложение Или ВнешнееСоединение Тогда

#Область ПрограммныйИнтерфейс

// Возвращает разделитель новой записи по значению аналитик.
//
// Параметры:
//	Организация - СправочникСсылка.Организации - Организация, по которой выполняется расчет расхода на производство
//	Подразделение - СправочникСсылка.СтруктураПредприятия - Подразделение, по которому выполняется расчет расхода на производство
//	ЭтапПроизводства - ДокументСсылка.ЭтапПроизводства2_2 - Этап, требующий расчета
//	Период - Дата - Месяц, начиная с которого требуется выполнить расчет
//
// Возвращаемое значение:
//	Число - Значение нового разделителя
//
Функция РазделительНовойЗаписи(Организация, Подразделение) Экспорт
	
	Запрос = Новый Запрос;
	Запрос.Текст = 
	"ВЫБРАТЬ
	|	Очередь.Организация,
	|	Очередь.Подразделение,
	|	МАКСИМУМ(Очередь.Разделитель) КАК Разделитель
	|ИЗ
	|	РегистрСведений.ОчередьРасходаТоваровОрганизацийНаПроизводство КАК Очередь
	|ГДЕ
	|	Очередь.Организация = &Организация
	|	И Очередь.Подразделение = &Подразделение
	|
	|СГРУППИРОВАТЬ ПО
	|	Очередь.Организация,
	|	Очередь.Подразделение";
	
	Запрос.УстановитьПараметр("Организация", Организация);
	Запрос.УстановитьПараметр("Подразделение", Подразделение);
	
	Результат = Запрос.Выполнить();
	
	Разделитель = 1;
	
	Выборка = Запрос.Выполнить().Выбрать();
	Если Выборка.Следующий() Тогда
		Разделитель = Выборка.Разделитель + 1;
	КонецЕсли;
	
	Возврат Разделитель;
	
КонецФункции

#КонецОбласти

#КонецЕсли