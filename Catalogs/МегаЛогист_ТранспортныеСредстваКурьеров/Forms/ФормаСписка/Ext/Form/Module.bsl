
&НаКлиенте
Процедура ВыгрузитьВMaxoptra(Команда)
	
	ВыгрузитьВMaxoptraСервер();
	ОбновитьОтображениеДанных();
	
КонецПроцедуры

&НаСервере
Процедура ВыгрузитьВMaxoptraСервер()
	
	ИДСессии = МегаЛогист_РаботаСМакоптра.Авторазация();
	Если ИДСессии = Неопределено Тогда
		Возврат;
	КонецЕсли;
	
	Отказ = Ложь;	
	МегаЛогист_РаботаСМакоптра.importVehicles(ИДСессии, МегаЛогист_РаботаСМакоптра.ВыгрузитьДанныеПоТранспорту(), Отказ);
	МегаЛогист_РаботаСМакоптра.importPerformers(ИДСессии, МегаЛогист_РаботаСМакоптра.ВыгрузитьДанныеПоВодителям(), Отказ);
	МегаЛогист_РаботаСМакоптра.assignPerformersToVehicles(ИДСессии, МегаЛогист_РаботаСМакоптра.ВыгрузитьДанныеПоНазначениям(), Отказ);
	Если Не Отказ Тогда
	
		Сообщение = Новый СообщениеПользователю;
		Сообщение.Текст = "Выгрузка данных успешно завершена";
		Сообщение.Сообщить();
	
	КонецЕсли;
	
	
КонецПроцедуры

