
#Область ОбработчикиСобытийФормы

&НаСервере
Процедура ПриСозданииНаСервере(Отказ, СтандартнаяОбработка)

	УстановитьУсловноеОформление();
	
	Если Параметры.Свойство("АвтоТест") Тогда // Возврат при получении формы для анализа.
		Возврат;
	КонецЕсли;
	
		
		ВызватьИсключение НСтр("ru='Не реализован выбор назначения из этой формы.'"); 
		
	
	Если НЕ Параметры.Свойство("Получатель") ИЛИ НЕ ЗначениеЗаполнено(Параметры.Получатель) Тогда
		
		ВариантыВыбора = ЗначениеПотребностьВсехПолучателей();
		
	Иначе
		
		ВариантыВыбора = ЗначениеПотребностьПолучателя();
		
	КонецЕсли;
	
	НастроитьДинамическийСписок();
	
	УстановитьЗаголовокФормы();
	
	МодификацияКонфигурацииПереопределяемый.ПриСозданииНаСервере(ЭтаФорма, СтандартнаяОбработка, Отказ);
	
КонецПроцедуры

#КонецОбласти

#Область ОбработчикиСобытийЭлементовФормы

&НаКлиенте
Процедура ПереключательВариантыВыбораПриИзменении(Элемент)
	
	НастроитьСписокПоВариантуВыбораНазначения();
	
КонецПроцедуры

&НаСервере
Процедура НастроитьСписокПоВариантуВыбораНазначения()
	
	ПоПрочимНазначениям = ВариантыВыбора = ЗначениеПрочиеНазначения();
	ПоВсемПолучателям   = ВариантыВыбора = ЗначениеПрочиеНазначения()
		ИЛИ ВариантыВыбора = ЗначениеПотребностьВсехПолучателей();
	
	ОбщегоНазначенияКлиентСервер.УстановитьПараметрДинамическогоСписка(Список, "ПоПрочимНазначениям", ПоПрочимНазначениям);
	ОбщегоНазначенияКлиентСервер.УстановитьПараметрДинамическогоСписка(Список, "ПоВсемПолучателям", ПоВсемПолучателям);

	Элементы.ПроизводитсяВПроцессе.Видимость = НЕ ПоПрочимНазначениям;
	Элементы.Потребность.Видимость = НЕ ПоПрочимНазначениям;
	
КонецПроцедуры

&НаКлиенте
Процедура ЗаголовокРасшифровкаОбработкаНавигационнойСсылки(Элемент, НавигационнаяСсылкаФорматированнойСтроки, СтандартнаяОбработка)
	
	СтандартнаяОбработка = Ложь;
	
	ПоказатьЗначение(,Параметры.Распоряжение);
	
КонецПроцедуры

#КонецОбласти

#Область ОбработчикиСобытийЭлементовСписка

&НаКлиенте
Процедура СписокВыборЗначения(Элемент, Значение, СтандартнаяОбработка)
	
	Возврат; // в данной конфигурации действия не предусмотрены

КонецПроцедуры

#КонецОбласти

#Область СлужебныеПроцедурыИФункции

&НаСервере
Процедура УстановитьУсловноеОформление()
	
	Возврат; // в данной конфигурации действия не предусмотрены
	
КонецПроцедуры

&НаСервере
Процедура НастроитьДинамическийСписок()
	
	Возврат; // в данной конфигурации действия не предусмотрены
	
КонецПроцедуры

&НаСервере
Процедура УстановитьЗаголовокФормы()
	
	ТекстНоменклатура = СтрШаблон(НСтр("ru = 'Номенклатура: %1'"), Параметры.Номенклатура);
	
	Если ЗначениеЗаполнено(Параметры.Характеристика) Тогда
		
		ТекстНоменклатура = ТекстНоменклатура + ", " + СтрШаблон(НСтр("ru = 'Характеристика: %1'"), Параметры.Характеристика);
		
	КонецЕсли;
	
	Заголовок = СтрШаблон(НСтр("ru = 'Выбор назначения (%1)'"), ТекстНоменклатура);
	
	ЗаголовокРасшифровка = Новый ФорматированнаяСтрока(
		НСтр("ru = 'Отобраны назначения по заказу:'"),
		" ",
		Новый ФорматированнаяСтрока(Строка(Параметры.Распоряжение),,,, "#ОткрытьРаспоряжение"));

КонецПроцедуры

#Область Константы

&НаКлиентеНаСервереБезКонтекста
Функция ЗначениеПотребностьПолучателя()

	Возврат 0;
	
КонецФункции

&НаКлиентеНаСервереБезКонтекста
Функция ЗначениеПотребностьВсехПолучателей()

	Возврат 1;
	
КонецФункции

&НаКлиентеНаСервереБезКонтекста
Функция ЗначениеПрочиеНазначения()

	Возврат 2;
	
КонецФункции

#КонецОбласти

#КонецОбласти
