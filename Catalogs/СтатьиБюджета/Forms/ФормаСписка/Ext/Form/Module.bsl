
&НаСервере
Процедура ОбновитьФильтрПоМоделям()
	
	ОтмМодели = КонвертацияТипов.ПолучитьОтмеченныеЗначенияСписка(Модели);
	
	Список.Параметры.УстановитьЗначениеПараметра("ФильтрПоМоделям", Булево(ОтмМодели.Количество()));
	Список.Параметры.УстановитьЗначениеПараметра("Модели", 			ОтмМодели);
	
КонецПроцедуры

&НаКлиенте
Процедура МоделиПриИзменении(Элемент)
	
	ОбновитьФильтрПоМоделям();
	
КонецПроцедуры

&НаСервере
Процедура ПриСозданииНаСервере(Отказ, СтандартнаяОбработка)
	
	Список.Параметры.УстановитьЗначениеПараметра("ПустойТекст", Справочники.ТекстыЗапросов.ПустаяСсылка());
	
	ОбновитьФильтрПоМоделям();
	
	Запрос = Новый Запрос("ВЫБРАТЬ РАЗРЕШЕННЫЕ Ссылка ИЗ Справочник.МоделиБюджетов ГДЕ НЕ ПометкаУдаления УПОРЯДОЧИТЬ ПО Наименование");
	Запрос.Выполнить().Выгрузить();
	Модели.ЗагрузитьЗначения(Запрос.Выполнить().Выгрузить().ВыгрузитьКолонку("Ссылка"));
	
КонецПроцедуры

&НаКлиенте
Процедура МоделиВыбор(Элемент, ВыбраннаяСтрока, Поле, СтандартнаяОбработка)
	
	СтандартнаяОбработка = Ложь;
	ПоказатьЗначение(,Модели.НайтиПоИдентификатору(ВыбраннаяСтрока).Значение);
	
КонецПроцедуры

&НаСервере
Процедура ПрочитатьРеквизитыСтатьи(СтатьяСсылка)
	
	Настройки = Бюджетирование.ПолучитьНастройкиЗапросаПолностью(СтатьяСсылка, Справочники.СценарииПланирования.Факт);
	
	Если Настройки = Неопределено Тогда
		ТекстЗапроса 			= "";
		ТекстРасшифровки		= "";
		ТекстЗапросаСсылка 		= Справочники.ТекстыЗапросов.ПустаяСсылка();
		ТекстРасшифровкиСсылка 	= Справочники.ТекстыЗапросов.ПустаяСсылка();
	Иначе
		ЗаполнитьЗначенияСвойств(ЭтаФорма, Настройки);
	КонецЕсли;
	
КонецПроцедуры
&НаКлиенте
Процедура СписокПриАктивизацииСтроки(Элемент)
	
	ПрочитатьРеквизитыСтатьи(Элементы.Список.ТекущаяСтрока);
	
КонецПроцедуры

&НаСервере
Процедура СохранитьРеквизитЗапросСтатьи(ИмяРеквизита, Значение, Статья)
	
	Если Статья <> Неопределено Тогда
		
		Запись = РегистрыСведений.ЗапросыДДС.СоздатьМенеджерЗаписи();
		Запись.Статья = Статья;
		Запись.Сценарий = Справочники.СценарииПланирования.Факт;
		
		Запись.Прочитать();
		Запись[ИмяРеквизита] = Значение;
		
		Запись.Записать();
		
	КонецЕсли;
	
КонецПроцедуры
&НаКлиенте
Процедура ТекстЗапросаСсылкаПриИзменении(Элемент)
	
	СохранитьРеквизитЗапросСтатьи("ТекстЗапросаСсылка", ТекстЗапросаСсылка, Элементы.Список.ТекущаяСтрока);
	
КонецПроцедуры
&НаКлиенте
Процедура ТекстЗапросаПриИзменении(Элемент)
	
	СохранитьРеквизитЗапросСтатьи("ТекстЗапроса", ТекстЗапроса, Элементы.Список.ТекущаяСтрока);
	
КонецПроцедуры
&НаКлиенте
Процедура ТекстЗапросаСсылкаРасшифровкаПриИзменении(Элемент)
	
	СохранитьРеквизитЗапросСтатьи("ТекстЗапросаРасшифровкиСсылка", ТекстРасшифровкиСсылка, Элементы.Список.ТекущаяСтрока);
	
КонецПроцедуры
&НаКлиенте
Процедура ТекстЗапросаРасшифровкиПриИзменении(Элемент)
	
	СохранитьРеквизитЗапросСтатьи("ТекстЗапросаРасшифровки", ТекстРасшифровки, Элементы.Список.ТекущаяСтрока);
	
КонецПроцедуры
